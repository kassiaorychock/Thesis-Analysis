---
title: "ThesisAnalysis"
author: "Kassia Orychock"
date: '2019-01-31'
output:
  html_document:
    keep_md: yes
  pdf_document: default
---



This Rmd file will be used as the file for my Thesis Analysis on causal mediation.

# Libraries

```r
library(tidyverse)
library(car)
library(foreign)
library(Hmisc)
library(knitr)
library(dplyr)
library(survival)
library(finalfit)
library(tableone)
library(lme4)
library(e1071)
library(mediation)
```

# Reading of Raw Survey Data

```r
ibiccs_readin <- read.csv("Database_recoded_2012-2014_weights_Walkscore_RTA.csv")
ibiccs_readin$TransitScore <- as.numeric(ibiccs_readin$TransitScore)
ibiccs_readin$BikeScore <- as.numeric(ibiccs_readin$BikeScore)
```

# Recode BMI

```r
## BMI
ibiccs_clean <- ibiccs_readin %>%
	mutate(bmi_category = case_when(
		bmi < 18.5 ~ "underweight",
		bmi >=30 & bmi <999 ~ "obese",
		bmi >=25 & bmi <30 ~ "overweight",
		bmi >=18.5 & bmi <25 ~ "normal weight",
		bmi == 9999 ~ "NA",
		TRUE ~ "other"
	))

table(ibiccs_clean$bmi, ibiccs_clean$bmi_category)
```

```
##        
##         normal weight obese other overweight underweight
##   17.5              0     0     0          0           2
##   17.51             0     0     0          0           2
##   17.54             0     0     0          0           4
##   17.56             0     0     0          0           3
##   17.57             0     0     0          0           5
##   17.58             0     0     0          0           6
##   17.59             0     0     0          0           1
##   17.63             0     0     0          0           4
##   17.64             0     0     0          0           2
##   17.65             0     0     0          0           1
##   17.68             0     0     0          0           3
##   17.7              0     0     0          0           2
##   17.71             0     0     0          0          12
##   17.72             0     0     0          0           8
##   17.74             0     0     0          0           4
##   17.75             0     0     0          0          22
##   17.76             0     0     0          0           4
##   17.77             0     0     0          0           1
##   17.79             0     0     0          0           2
##   17.81             0     0     0          0           2
##   17.85             0     0     0          0           7
##   17.87             0     0     0          0           2
##   17.89             0     0     0          0           2
##   17.91             0     0     0          0           1
##   17.92             0     0     0          0           4
##   17.94             0     0     0          0          18
##   17.95             0     0     0          0           6
##   17.96             0     0     0          0           3
##   17.97             0     0     0          0           3
##   17.98             0     0     0          0           1
##   18                0     0     0          0           3
##   18.01             0     0     0          0          15
##   18.02             0     0     0          0          25
##   18.07             0     0     0          0           5
##   18.08             0     0     0          0           9
##   18.11             0     0     0          0           3
##   18.13             0     0     0          0           8
##   18.14             0     0     0          0           5
##   18.16             0     0     0          0           3
##   18.17             0     0     0          0           2
##   18.18             0     0     0          0           4
##   18.19             0     0     0          0           5
##   18.21             0     0     0          0           1
##   18.22             0     0     0          0           1
##   18.24             0     0     0          0           1
##   18.25             0     0     0          0          21
##   18.26             0     0     0          0           2
##   18.27             0     0     0          0           2
##   18.29             0     0     0          0          31
##   18.3              0     0     0          0          33
##   18.31             0     0     0          0           7
##   18.33             0     0     0          0           3
##   18.34             0     0     0          0           7
##   18.35             0     0     0          0           2
##   18.36             0     0     0          0           3
##   18.37             0     0     0          0          11
##   18.38             0     0     0          0           1
##   18.4              0     0     0          0           2
##   18.42             0     0     0          0           3
##   18.44             0     0     0          0           1
##   18.45             0     0     0          0           1
##   18.46             0     0     0          0          23
##   18.47             0     0     0          0          10
##   18.48             0     0     0          0           3
##   18.51             2     0     0          0           0
##   18.52             5     0     0          0           0
##   18.54             9     0     0          0           0
##   18.55            22     0     0          0           0
##   18.56            30     0     0          0           0
##   18.58             1     0     0          0           0
##   18.59             1     0     0          0           0
##   18.6             27     0     0          0           0
##   18.61             1     0     0          0           0
##   18.62             4     0     0          0           0
##   18.64             8     0     0          0           0
##   18.65            15     0     0          0           0
##   18.66            12     0     0          0           0
##   18.68             2     0     0          0           0
##   18.69             1     0     0          0           0
##   18.7              2     0     0          0           0
##   18.71             4     0     0          0           0
##   18.72             2     0     0          0           0
##   18.73             4     0     0          0           0
##   18.74             4     0     0          0           0
##   18.75            13     0     0          0           0
##   18.78            14     0     0          0           0
##   18.79            24     0     0          0           0
##   18.8              7     0     0          0           0
##   18.81             1     0     0          0           0
##   18.82             1     0     0          0           0
##   18.83            10     0     0          0           0
##   18.84             5     0     0          0           0
##   18.85             1     0     0          0           0
##   18.87             4     0     0          0           0
##   18.88            55     0     0          0           0
##   18.89            15     0     0          0           0
##   18.9              2     0     0          0           0
##   18.91             1     0     0          0           0
##   18.92             2     0     0          0           0
##   18.93             1     0     0          0           0
##   18.94             7     0     0          0           0
##   18.95            11     0     0          0           0
##   18.96             1     0     0          0           0
##   18.97             5     0     0          0           0
##   18.98             1     0     0          0           0
##   18.99            24     0     0          0           0
##   19.01            36     0     0          0           0
##   19.02             3     0     0          0           0
##   19.03             1     0     0          0           0
##   19.05            17     0     0          0           0
##   19.06             1     0     0          0           0
##   19.08             5     0     0          0           0
##   19.09             1     0     0          0           0
##   19.1              1     0     0          0           0
##   19.11             9     0     0          0           0
##   19.13            10     0     0          0           0
##   19.14            51     0     0          0           0
##   19.16             8     0     0          0           0
##   19.18             1     0     0          0           0
##   19.19             4     0     0          0           0
##   19.2             40     0     0          0           0
##   19.21             1     0     0          0           0
##   19.22            15     0     0          0           0
##   19.23             4     0     0          0           0
##   19.25             2     0     0          0           0
##   19.26            10     0     0          0           0
##   19.27             7     0     0          0           0
##   19.28             1     0     0          0           0
##   19.3              6     0     0          0           0
##   19.31            11     0     0          0           0
##   19.33             3     0     0          0           0
##   19.37            74     0     0          0           0
##   19.38             6     0     0          0           0
##   19.39             5     0     0          0           0
##   19.4              5     0     0          0           0
##   19.41             1     0     0          0           0
##   19.42             5     0     0          0           0
##   19.44             3     0     0          0           0
##   19.46            12     0     0          0           0
##   19.47            13     0     0          0           0
##   19.48             3     0     0          0           0
##   19.49            53     0     0          0           0
##   19.5              1     0     0          0           0
##   19.53            59     0     0          0           0
##   19.55             1     0     0          0           0
##   19.57            22     0     0          0           0
##   19.58            67     0     0          0           0
##   19.59             2     0     0          0           0
##   19.6              2     0     0          0           0
##   19.61             3     0     0          0           0
##   19.63             1     0     0          0           0
##   19.64            18     0     0          0           0
##   19.65             6     0     0          0           0
##   19.66             5     0     0          0           0
##   19.67            12     0     0          0           0
##   19.68             2     0     0          0           0
##   19.69             8     0     0          0           0
##   19.71             1     0     0          0           0
##   19.73             6     0     0          0           0
##   19.74            49     0     0          0           0
##   19.75            18     0     0          0           0
##   19.77            59     0     0          0           0
##   19.78             1     0     0          0           0
##   19.79            17     0     0          0           0
##   19.8             13     0     0          0           0
##   19.81             4     0     0          0           0
##   19.82             1     0     0          0           0
##   19.83             2     0     0          0           0
##   19.84            37     0     0          0           0
##   19.85             9     0     0          0           0
##   19.86             1     0     0          0           0
##   19.88             1     0     0          0           0
##   19.89             6     0     0          0           0
##   19.9              7     0     0          0           0
##   19.91             6     0     0          0           0
##   19.92             8     0     0          0           0
##   19.93             1     0     0          0           0
##   19.94            34     0     0          0           0
##   19.95             2     0     0          0           0
##   19.96             2     0     0          0           0
##   19.97            62     0     0          0           0
##   19.99             8     0     0          0           0
##   20                7     0     0          0           0
##   20.01            11     0     0          0           0
##   20.02             6     0     0          0           0
##   20.03             6     0     0          0           0
##   20.05            15     0     0          0           0
##   20.06             5     0     0          0           0
##   20.07            13     0     0          0           0
##   20.08            17     0     0          0           0
##   20.09            37     0     0          0           0
##   20.11             2     0     0          0           0
##   20.12            72     0     0          0           0
##   20.14             3     0     0          0           0
##   20.16             5     0     0          0           0
##   20.17             1     0     0          0           0
##   20.18            84     0     0          0           0
##   20.19            10     0     0          0           0
##   20.2             20     0     0          0           0
##   20.22            32     0     0          0           0
##   20.23             3     0     0          0           0
##   20.24             2     0     0          0           0
##   20.25            18     0     0          0           0
##   20.27             1     0     0          0           0
##   20.28             2     0     0          0           0
##   20.29             3     0     0          0           0
##   20.3             19     0     0          0           0
##   20.31             5     0     0          0           0
##   20.32             1     0     0          0           0
##   20.33             1     0     0          0           0
##   20.34            38     0     0          0           0
##   20.35             1     0     0          0           0
##   20.36            93     0     0          0           0
##   20.37            82     0     0          0           0
##   20.38             9     0     0          0           0
##   20.39             1     0     0          0           0
##   20.4              4     0     0          0           0
##   20.41            13     0     0          0           0
##   20.42             1     0     0          0           0
##   20.43             5     0     0          0           0
##   20.45             4     0     0          0           0
##   20.47            13     0     0          0           0
##   20.48            19     0     0          0           0
##   20.5              9     0     0          0           0
##   20.51            21     0     0          0           0
##   20.52             5     0     0          0           0
##   20.53            49     0     0          0           0
##   20.54            13     0     0          0           0
##   20.55            15     0     0          0           0
##   20.56             2     0     0          0           0
##   20.57             3     0     0          0           0
##   20.58             2     0     0          0           0
##   20.6            119     0     0          0           0
##   20.61             3     0     0          0           0
##   20.62             5     0     0          0           0
##   20.63             6     0     0          0           0
##   20.64             3     0     0          0           0
##   20.66            20     0     0          0           0
##   20.67            59     0     0          0           0
##   20.68             7     0     0          0           0
##   20.69             4     0     0          0           0
##   20.7              8     0     0          0           0
##   20.71             1     0     0          0           0
##   20.72             7     0     0          0           0
##   20.73            12     0     0          0           0
##   20.74             2     0     0          0           0
##   20.75             5     0     0          0           0
##   20.76             8     0     0          0           0
##   20.77             3     0     0          0           0
##   20.78            44     0     0          0           0
##   20.8             96     0     0          0           0
##   20.81            34     0     0          0           0
##   20.82             8     0     0          0           0
##   20.83            24     0     0          0           0
##   20.85            18     0     0          0           0
##   20.87             1     0     0          0           0
##   20.89             1     0     0          0           0
##   20.9             24     0     0          0           0
##   20.91             4     0     0          0           0
##   20.92            21     0     0          0           0
##   20.93             4     0     0          0           0
##   20.94            19     0     0          0           0
##   20.95             2     0     0          0           0
##   20.96             4     0     0          0           0
##   20.97            16     0     0          0           0
##   20.98           111     0     0          0           0
##   20.99             9     0     0          0           0
##   21.01             1     0     0          0           0
##   21.02            20     0     0          0           0
##   21.03            69     0     0          0           0
##   21.06             1     0     0          0           0
##   21.08            11     0     0          0           0
##   21.09             8     0     0          0           0
##   21.1              2     0     0          0           0
##   21.11            31     0     0          0           0
##   21.12             3     0     0          0           0
##   21.13            12     0     0          0           0
##   21.14            89     0     0          0           0
##   21.16            16     0     0          0           0
##   21.18             8     0     0          0           0
##   21.19             4     0     0          0           0
##   21.2              2     0     0          0           0
##   21.21            10     0     0          0           0
##   21.22            16     0     0          0           0
##   21.23             2     0     0          0           0
##   21.24             5     0     0          0           0
##   21.25             5     0     0          0           0
##   21.26           106     0     0          0           0
##   21.27             1     0     0          0           0
##   21.28            16     0     0          0           0
##   21.29            84     0     0          0           0
##   21.3             25     0     0          0           0
##   21.31            16     0     0          0           0
##   21.34             9     0     0          0           0
##   21.35             5     0     0          0           0
##   21.37             2     0     0          0           0
##   21.38             1     0     0          0           0
##   21.4             13     0     0          0           0
##   21.41            61     0     0          0           0
##   21.42             1     0     0          0           0
##   21.43             7     0     0          0           0
##   21.44             2     0     0          0           0
##   21.45             7     0     0          0           0
##   21.46           111     0     0          0           0
##   21.47            22     0     0          0           0
##   21.48            50     0     0          0           0
##   21.5              2     0     0          0           0
##   21.51             3     0     0          0           0
##   21.52            69     0     0          0           0
##   21.53             4     0     0          0           0
##   21.54             6     0     0          0           0
##   21.55             2     0     0          0           0
##   21.56             9     0     0          0           0
##   21.57             4     0     0          0           0
##   21.58            22     0     0          0           0
##   21.59             3     0     0          0           0
##   21.6              6     0     0          0           0
##   21.61            30     0     0          0           0
##   21.62            16     0     0          0           0
##   21.63           136     0     0          0           0
##   21.64             2     0     0          0           0
##   21.66             3     0     0          0           0
##   21.67             2     0     0          0           0
##   21.68             1     0     0          0           0
##   21.7             48     0     0          0           0
##   21.71             8     0     0          0           0
##   21.72             7     0     0          0           0
##   21.73            32     0     0          0           0
##   21.74             7     0     0          0           0
##   21.75             1     0     0          0           0
##   21.76             5     0     0          0           0
##   21.77            27     0     0          0           0
##   21.79           114     0     0          0           0
##   21.8             27     0     0          0           0
##   21.81            13     0     0          0           0
##   21.83            17     0     0          0           0
##   21.86            10     0     0          0           0
##   21.87            11     0     0          0           0
##   21.88             1     0     0          0           0
##   21.89             4     0     0          0           0
##   21.9              5     0     0          0           0
##   21.91             8     0     0          0           0
##   21.92             5     0     0          0           0
##   21.93           109     0     0          0           0
##   21.94             6     0     0          0           0
##   21.95            98     0     0          0           0
##   21.96             1     0     0          0           0
##   21.97            65     0     0          0           0
##   21.99             2     0     0          0           0
##   22                3     0     0          0           0
##   22.01             2     0     0          0           0
##   22.03             2     0     0          0           0
##   22.04            12     0     0          0           0
##   22.05            85     0     0          0           0
##   22.06             1     0     0          0           0
##   22.07             2     0     0          0           0
##   22.08             3     0     0          0           0
##   22.1              7     0     0          0           0
##   22.11            20     0     0          0           0
##   22.12             1     0     0          0           0
##   22.13             5     0     0          0           0
##   22.14            92     0     0          0           0
##   22.15            71     0     0          0           0
##   22.16             2     0     0          0           0
##   22.18             3     0     0          0           0
##   22.2              8     0     0          0           0
##   22.21             3     0     0          0           0
##   22.22            14     0     0          0           0
##   22.24            65     0     0          0           0
##   22.25             1     0     0          0           0
##   22.26             7     0     0          0           0
##   22.27            10     0     0          0           0
##   22.28             1     0     0          0           0
##   22.3             22     0     0          0           0
##   22.31           141     0     0          0           0
##   22.32            51     0     0          0           0
##   22.34             3     0     0          0           0
##   22.35             9     0     0          0           0
##   22.37             2     0     0          0           0
##   22.38            55     0     0          0           0
##   22.39             1     0     0          0           0
##   22.4              8     0     0          0           0
##   22.41             1     0     0          0           0
##   22.42             5     0     0          0           0
##   22.43            25     0     0          0           0
##   22.44             5     0     0          0           0
##   22.45             8     0     0          0           0
##   22.46           141     0     0          0           0
##   22.47            20     0     0          0           0
##   22.48             6     0     0          0           0
##   22.49             4     0     0          0           0
##   22.5             45     0     0          0           0
##   22.51             2     0     0          0           0
##   22.52             5     0     0          0           0
##   22.53             6     0     0          0           0
##   22.55             5     0     0          0           0
##   22.58             1     0     0          0           0
##   22.59            13     0     0          0           0
##   22.6            116     0     0          0           0
##   22.62             2     0     0          0           0
##   22.63            10     0     0          0           0
##   22.65             5     0     0          0           0
##   22.66            21     0     0          0           0
##   22.67            66     0     0          0           0
##   22.68            12     0     0          0           0
##   22.7              1     0     0          0           0
##   22.71            80     0     0          0           0
##   22.72             3     0     0          0           0
##   22.73             6     0     0          0           0
##   22.74             3     0     0          0           0
##   22.75             2     0     0          0           0
##   22.76             3     0     0          0           0
##   22.77             5     0     0          0           0
##   22.78             4     0     0          0           0
##   22.79            12     0     0          0           0
##   22.8             13     0     0          0           0
##   22.81            99     0     0          0           0
##   22.82             2     0     0          0           0
##   22.83            14     0     0          0           0
##   22.84             3     0     0          0           0
##   22.85            12     0     0          0           0
##   22.86            75     0     0          0           0
##   22.87             6     0     0          0           0
##   22.88             3     0     0          0           0
##   22.89            66     0     0          0           0
##   22.91             4     0     0          0           0
##   22.92            16     0     0          0           0
##   22.95             1     0     0          0           0
##   22.96           112     0     0          0           0
##   22.97             1     0     0          0           0
##   22.98             5     0     0          0           0
##   22.99             5     0     0          0           0
##   23                9     0     0          0           0
##   23.01            46     0     0          0           0
##   23.02             9     0     0          0           0
##   23.03           100     0     0          0           0
##   23.04             2     0     0          0           0
##   23.05            27     0     0          0           0
##   23.06            48     0     0          0           0
##   23.08             9     0     0          0           0
##   23.09            29     0     0          0           0
##   23.1              7     0     0          0           0
##   23.11            42     0     0          0           0
##   23.12            12     0     0          0           0
##   23.13            14     0     0          0           0
##   23.14             1     0     0          0           0
##   23.15            12     0     0          0           0
##   23.17            93     0     0          0           0
##   23.18            20     0     0          0           0
##   23.19             1     0     0          0           0
##   23.21             5     0     0          0           0
##   23.22             4     0     0          0           0
##   23.23            17     0     0          0           0
##   23.24            16     0     0          0           0
##   23.25             1     0     0          0           0
##   23.26             7     0     0          0           0
##   23.27             1     0     0          0           0
##   23.29             4     0     0          0           0
##   23.3            128     0     0          0           0
##   23.31             3     0     0          0           0
##   23.32             5     0     0          0           0
##   23.33            21     0     0          0           0
##   23.34            17     0     0          0           0
##   23.36             2     0     0          0           0
##   23.37             5     0     0          0           0
##   23.38             9     0     0          0           0
##   23.39            14     0     0          0           0
##   23.4             91     0     0          0           0
##   23.41            23     0     0          0           0
##   23.42             9     0     0          0           0
##   23.43            15     0     0          0           0
##   23.44            54     0     0          0           0
##   23.45             2     0     0          0           0
##   23.46            13     0     0          0           0
##   23.48            14     0     0          0           0
##   23.49           109     0     0          0           0
##   23.5              1     0     0          0           0
##   23.51             3     0     0          0           0
##   23.52            13     0     0          0           0
##   23.53             7     0     0          0           0
##   23.54             5     0     0          0           0
##   23.55             2     0     0          0           0
##   23.56            18     0     0          0           0
##   23.57            84     0     0          0           0
##   23.58             1     0     0          0           0
##   23.59             3     0     0          0           0
##   23.6              6     0     0          0           0
##   23.62            33     0     0          0           0
##   23.63           105     0     0          0           0
##   23.65             3     0     0          0           0
##   23.66             1     0     0          0           0
##   23.67            88     0     0          0           0
##   23.68             3     0     0          0           0
##   23.69            15     0     0          0           0
##   23.7              3     0     0          0           0
##   23.71            64     0     0          0           0
##   23.72            14     0     0          0           0
##   23.73            84     0     0          0           0
##   23.74            11     0     0          0           0
##   23.75            72     0     0          0           0
##   23.77             1     0     0          0           0
##   23.78           102     0     0          0           0
##   23.79             1     0     0          0           0
##   23.8             11     0     0          0           0
##   23.81            17     0     0          0           0
##   23.82             5     0     0          0           0
##   23.83             5     0     0          0           0
##   23.84             3     0     0          0           0
##   23.85             6     0     0          0           0
##   23.86             8     0     0          0           0
##   23.87             9     0     0          0           0
##   23.88             8     0     0          0           0
##   23.89            17     0     0          0           0
##   23.9              1     0     0          0           0
##   23.91            78     0     0          0           0
##   23.92            12     0     0          0           0
##   23.94             5     0     0          0           0
##   23.95             3     0     0          0           0
##   23.96            17     0     0          0           0
##   23.98             1     0     0          0           0
##   23.99             9     0     0          0           0
##   24                7     0     0          0           0
##   24.01            12     0     0          0           0
##   24.02            20     0     0          0           0
##   24.03           120     0     0          0           0
##   24.04             3     0     0          0           0
##   24.05             5     0     0          0           0
##   24.06             1     0     0          0           0
##   24.07             7     0     0          0           0
##   24.09            10     0     0          0           0
##   24.1              1     0     0          0           0
##   24.11             8     0     0          0           0
##   24.12             3     0     0          0           0
##   24.13            77     0     0          0           0
##   24.14            29     0     0          0           0
##   24.15             1     0     0          0           0
##   24.16             4     0     0          0           0
##   24.17             4     0     0          0           0
##   24.18             4     0     0          0           0
##   24.19            15     0     0          0           0
##   24.2              5     0     0          0           0
##   24.21           136     0     0          0           0
##   24.22            19     0     0          0           0
##   24.23             1     0     0          0           0
##   24.24            11     0     0          0           0
##   24.25             5     0     0          0           0
##   24.27            10     0     0          0           0
##   24.28            99     0     0          0           0
##   24.3              2     0     0          0           0
##   24.31             4     0     0          0           0
##   24.33           109     0     0          0           0
##   24.34            18     0     0          0           0
##   24.36             1     0     0          0           0
##   24.37            87     0     0          0           0
##   24.38             3     0     0          0           0
##   24.39           132     0     0          0           0
##   24.41           222     0     0          0           0
##   24.42             1     0     0          0           0
##   24.43             3     0     0          0           0
##   24.44             2     0     0          0           0
##   24.45            14     0     0          0           0
##   24.46             5     0     0          0           0
##   24.47             1     0     0          0           0
##   24.48             3     0     0          0           0
##   24.49             7     0     0          0           0
##   24.5              2     0     0          0           0
##   24.51            15     0     0          0           0
##   24.52             4     0     0          0           0
##   24.53             6     0     0          0           0
##   24.54             5     0     0          0           0
##   24.55            10     0     0          0           0
##   24.56            37     0     0          0           0
##   24.57             1     0     0          0           0
##   24.58             3     0     0          0           0
##   24.59            10     0     0          0           0
##   24.6              4     0     0          0           0
##   24.61             5     0     0          0           0
##   24.62             6     0     0          0           0
##   24.63            31     0     0          0           0
##   24.64             1     0     0          0           0
##   24.65             7     0     0          0           0
##   24.66             3     0     0          0           0
##   24.67             8     0     0          0           0
##   24.68            15     0     0          0           0
##   24.69            94     0     0          0           0
##   24.72             7     0     0          0           0
##   24.73             1     0     0          0           0
##   24.74             1     0     0          0           0
##   24.75            13     0     0          0           0
##   24.77             3     0     0          0           0
##   24.78             8     0     0          0           0
##   24.8             90     0     0          0           0
##   24.81            19     0     0          0           0
##   24.82             7     0     0          0           0
##   24.83            18     0     0          0           0
##   24.85             1     0     0          0           0
##   24.86            12     0     0          0           0
##   24.87             2     0     0          0           0
##   24.89            86     0     0          0           0
##   24.9              9     0     0          0           0
##   24.91             8     0     0          0           0
##   24.92             1     0     0          0           0
##   24.93             2     0     0          0           0
##   24.94             6     0     0          0           0
##   24.95            11     0     0          0           0
##   24.96           120     0     0          0           0
##   24.97            14     0     0          0           0
##   24.98             4     0     0          0           0
##   24.99             3     0     0          0           0
##   25                0     0     0         15           0
##   25.01             0     0     0          2           0
##   25.02             0     0     0         65           0
##   25.03             0     0     0          1           0
##   25.04             0     0     0         14           0
##   25.06             0     0     0        130           0
##   25.07             0     0     0         36           0
##   25.08             0     0     0          2           0
##   25.09             0     0     0        157           0
##   25.1              0     0     0        145           0
##   25.11             0     0     0         69           0
##   25.13             0     0     0          3           0
##   25.14             0     0     0          7           0
##   25.15             0     0     0         10           0
##   25.16             0     0     0          2           0
##   25.18             0     0     0          8           0
##   25.19             0     0     0          3           0
##   25.2              0     0     0          3           0
##   25.22             0     0     0          1           0
##   25.23             0     0     0         11           0
##   25.24             0     0     0         31           0
##   25.25             0     0     0         17           0
##   25.26             0     0     0          1           0
##   25.27             0     0     0          2           0
##   25.28             0     0     0          1           0
##   25.29             0     0     0          9           0
##   25.31             0     0     0          5           0
##   25.32             0     0     0          5           0
##   25.33             0     0     0         11           0
##   25.34             0     0     0          4           0
##   25.35             0     0     0          3           0
##   25.36             0     0     0          4           0
##   25.37             0     0     0         11           0
##   25.38             0     0     0          9           0
##   25.39             0     0     0         48           0
##   25.4              0     0     0         22           0
##   25.41             0     0     0          4           0
##   25.42             0     0     0          6           0
##   25.43             0     0     0          2           0
##   25.44             0     0     0          1           0
##   25.46             0     0     0         11           0
##   25.47             0     0     0          3           0
##   25.48             0     0     0          2           0
##   25.5              0     0     0         20           0
##   25.51             0     0     0         36           0
##   25.52             0     0     0          5           0
##   25.53             0     0     0          4           0
##   25.54             0     0     0         30           0
##   25.55             0     0     0         10           0
##   25.56             0     0     0          9           0
##   25.58             0     0     0          6           0
##   25.59             0     0     0          2           0
##   25.61             0     0     0         77           0
##   25.62             0     0     0         12           0
##   25.63             0     0     0          8           0
##   25.65             0     0     0          1           0
##   25.66             0     0     0          9           0
##   25.68             0     0     0         42           0
##   25.69             0     0     0         70           0
##   25.7              0     0     0         11           0
##   25.71             0     0     0          8           0
##   25.72             0     0     0          1           0
##   25.73             0     0     0         21           0
##   25.75             0     0     0        119           0
##   25.76             0     0     0          2           0
##   25.77             0     0     0         63           0
##   25.78             0     0     0          4           0
##   25.79             0     0     0         51           0
##   25.8              0     0     0         63           0
##   25.82             0     0     0         90           0
##   25.83             0     0     0         98           0
##   25.84             0     0     0        125           0
##   25.85             0     0     0         93           0
##   25.86             0     0     0          4           0
##   25.88             0     0     0          2           0
##   25.89             0     0     0          5           0
##   25.9              0     0     0          3           0
##   25.91             0     0     0          1           0
##   25.92             0     0     0          5           0
##   25.93             0     0     0          6           0
##   25.94             0     0     0          9           0
##   25.95             0     0     0          8           0
##   25.96             0     0     0          4           0
##   25.97             0     0     0          8           0
##   25.98             0     0     0          2           0
##   25.99             0     0     0         10           0
##   26                0     0     0          7           0
##   26.01             0     0     0          1           0
##   26.04             0     0     0         10           0
##   26.05             0     0     0          4           0
##   26.07             0     0     0         10           0
##   26.08             0     0     0          5           0
##   26.09             0     0     0         11           0
##   26.11             0     0     0          6           0
##   26.12             0     0     0         10           0
##   26.13             0     0     0          4           0
##   26.14             0     0     0          5           0
##   26.15             0     0     0         31           0
##   26.16             0     0     0          7           0
##   26.17             0     0     0          9           0
##   26.18             0     0     0          2           0
##   26.19             0     0     0          8           0
##   26.21             0     0     0          1           0
##   26.22             0     0     0         20           0
##   26.23             0     0     0          4           0
##   26.24             0     0     0          4           0
##   26.25             0     0     0         14           0
##   26.26             0     0     0         20           0
##   26.29             0     0     0         17           0
##   26.3              0     0     0          9           0
##   26.31             0     0     0         19           0
##   26.32             0     0     0         13           0
##   26.33             0     0     0          1           0
##   26.34             0     0     0          5           0
##   26.35             0     0     0          1           0
##   26.36             0     0     0          6           0
##   26.37             0     0     0         21           0
##   26.39             0     0     0         46           0
##   26.4              0     0     0          2           0
##   26.41             0     0     0          1           0
##   26.42             0     0     0          1           0
##   26.43             0     0     0         15           0
##   26.45             0     0     0         88           0
##   26.46             0     0     0         11           0
##   26.47             0     0     0         12           0
##   26.48             0     0     0          1           0
##   26.49             0     0     0          1           0
##   26.5              0     0     0         51           0
##   26.51             0     0     0          1           0
##   26.52             0     0     0         44           0
##   26.54             0     0     0         76           0
##   26.56             0     0     0          4           0
##   26.57             0     0     0         76           0
##   26.58             0     0     0         98           0
##   26.59             0     0     0          2           0
##   26.6              0     0     0          1           0
##   26.61             0     0     0        128           0
##   26.62             0     0     0          2           0
##   26.63             0     0     0        231           0
##   26.64             0     0     0          3           0
##   26.65             0     0     0          2           0
##   26.66             0     0     0          6           0
##   26.68             0     0     0          9           0
##   26.69             0     0     0          7           0
##   26.7              0     0     0         11           0
##   26.71             0     0     0          2           0
##   26.72             0     0     0          3           0
##   26.73             0     0     0          3           0
##   26.75             0     0     0          2           0
##   26.76             0     0     0          4           0
##   26.78             0     0     0         19           0
##   26.79             0     0     0          5           0
##   26.81             0     0     0          1           0
##   26.82             0     0     0          1           0
##   26.83             0     0     0          8           0
##   26.84             0     0     0          1           0
##   26.85             0     0     0          6           0
##   26.86             0     0     0          1           0
##   26.87             0     0     0         10           0
##   26.88             0     0     0          7           0
##   26.89             0     0     0          9           0
##   26.9              0     0     0          2           0
##   26.91             0     0     0          8           0
##   26.92             0     0     0          2           0
##   26.93             0     0     0         13           0
##   26.94             0     0     0          6           0
##   26.95             0     0     0         11           0
##   26.96             0     0     0         32           0
##   26.97             0     0     0          5           0
##   26.98             0     0     0          2           0
##   26.99             0     0     0          3           0
##   27.01             0     0     0          2           0
##   27.02             0     0     0          6           0
##   27.04             0     0     0          2           0
##   27.05             0     0     0         17           0
##   27.06             0     0     0         15           0
##   27.07             0     0     0         14           0
##   27.09             0     0     0          1           0
##   27.1              0     0     0         10           0
##   27.12             0     0     0        131           0
##   27.13             0     0     0          3           0
##   27.14             0     0     0          3           0
##   27.15             0     0     0          3           0
##   27.16             0     0     0          4           0
##   27.17             0     0     0          9           0
##   27.18             0     0     0          1           0
##   27.2              0     0     0         31           0
##   27.21             0     0     0          3           0
##   27.22             0     0     0          8           0
##   27.25             0     0     0          8           0
##   27.26             0     0     0         77           0
##   27.27             0     0     0          8           0
##   27.28             0     0     0          6           0
##   27.29             0     0     0          6           0
##   27.31             0     0     0          3           0
##   27.32             0     0     0         45           0
##   27.34             0     0     0         36           0
##   27.35             0     0     0          3           0
##   27.36             0     0     0          2           0
##   27.37             0     0     0         80           0
##   27.39             0     0     0          6           0
##   27.4              0     0     0         14           0
##   27.41             0     0     0         46           0
##   27.44             0     0     0        133           0
##   27.46             0     0     0        144           0
##   27.47             0     0     0          2           0
##   27.48             0     0     0          9           0
##   27.49             0     0     0          1           0
##   27.5              0     0     0          7           0
##   27.51             0     0     0          4           0
##   27.52             0     0     0          1           0
##   27.53             0     0     0          2           0
##   27.54             0     0     0          1           0
##   27.55             0     0     0          3           0
##   27.56             0     0     0          3           0
##   27.57             0     0     0          5           0
##   27.59             0     0     0          1           0
##   27.6              0     0     0         22           0
##   27.61             0     0     0          4           0
##   27.62             0     0     0         14           0
##   27.63             0     0     0          6           0
##   27.64             0     0     0          4           0
##   27.67             0     0     0         12           0
##   27.68             0     0     0          3           0
##   27.69             0     0     0          5           0
##   27.7              0     0     0          1           0
##   27.71             0     0     0         19           0
##   27.72             0     0     0          5           0
##   27.73             0     0     0          6           0
##   27.74             0     0     0          1           0
##   27.75             0     0     0          3           0
##   27.76             0     0     0         21           0
##   27.78             0     0     0          6           0
##   27.79             0     0     0          6           0
##   27.8              0     0     0         34           0
##   27.81             0     0     0          7           0
##   27.82             0     0     0          6           0
##   27.84             0     0     0          7           0
##   27.86             0     0     0          1           0
##   27.87             0     0     0          4           0
##   27.88             0     0     0          6           0
##   27.89             0     0     0         62           0
##   27.91             0     0     0          4           0
##   27.92             0     0     0          2           0
##   27.93             0     0     0          3           0
##   27.94             0     0     0          1           0
##   27.96             0     0     0         11           0
##   27.97             0     0     0          2           0
##   27.98             0     0     0         41           0
##   27.99             0     0     0          5           0
##   28                0     0     0          9           0
##   28.01             0     0     0          3           0
##   28.03             0     0     0          2           0
##   28.04             0     0     0          2           0
##   28.06             0     0     0         68           0
##   28.07             0     0     0          3           0
##   28.08             0     0     0          5           0
##   28.09             0     0     0          2           0
##   28.1              0     0     0          1           0
##   28.11             0     0     0          1           0
##   28.12             0     0     0         16           0
##   28.13             0     0     0         47           0
##   28.15             0     0     0          4           0
##   28.16             0     0     0          1           0
##   28.17             0     0     0         11           0
##   28.19             0     0     0         88           0
##   28.21             0     0     0         11           0
##   28.22             0     0     0          1           0
##   28.23             0     0     0          3           0
##   28.24             0     0     0          1           0
##   28.25             0     0     0         87           0
##   28.27             0     0     0          1           0
##   28.28             0     0     0          7           0
##   28.29             0     0     0         51           0
##   28.3              0     0     0          1           0
##   28.31             0     0     0          4           0
##   28.32             0     0     0         51           0
##   28.34             0     0     0         78           0
##   28.35             0     0     0         33           0
##   28.36             0     0     0          1           0
##   28.37             0     0     0         15           0
##   28.38             0     0     0          3           0
##   28.4              0     0     0          3           0
##   28.41             0     0     0         10           0
##   28.43             0     0     0          2           0
##   28.44             0     0     0          1           0
##   28.45             0     0     0          1           0
##   28.46             0     0     0          1           0
##   28.47             0     0     0          6           0
##   28.48             0     0     0         46           0
##   28.49             0     0     0          3           0
##   28.5              0     0     0          6           0
##   28.52             0     0     0          2           0
##   28.53             0     0     0          5           0
##   28.55             0     0     0          5           0
##   28.57             0     0     0          7           0
##   28.59             0     0     0         30           0
##   28.6              0     0     0          6           0
##   28.62             0     0     0          8           0
##   28.63             0     0     0          4           0
##   28.65             0     0     0          5           0
##   28.66             0     0     0          5           0
##   28.67             0     0     0          4           0
##   28.68             0     0     0          1           0
##   28.7              0     0     0         81           0
##   28.71             0     0     0          3           0
##   28.72             0     0     0          3           0
##   28.73             0     0     0         13           0
##   28.74             0     0     0          6           0
##   28.75             0     0     0         16           0
##   28.76             0     0     0          2           0
##   28.78             0     0     0          2           0
##   28.79             0     0     0          3           0
##   28.8              0     0     0         32           0
##   28.82             0     0     0          1           0
##   28.84             0     0     0         10           0
##   28.85             0     0     0          1           0
##   28.87             0     0     0          4           0
##   28.88             0     0     0          1           0
##   28.89             0     0     0         78           0
##   28.9              0     0     0          8           0
##   28.91             0     0     0          1           0
##   28.93             0     0     0          1           0
##   28.94             0     0     0          1           0
##   28.95             0     0     0          2           0
##   28.97             0     0     0         28           0
##   28.98             0     0     0          5           0
##   29                0     0     0          2           0
##   29.01             0     0     0          7           0
##   29.02             0     0     0          2           0
##   29.03             0     0     0         19           0
##   29.04             0     0     0          2           0
##   29.05             0     0     0         88           0
##   29.07             0     0     0          1           0
##   29.08             0     0     0          1           0
##   29.09             0     0     0          1           0
##   29.1              0     0     0          8           0
##   29.11             0     0     0          1           0
##   29.12             0     0     0         36           0
##   29.13             0     0     0          3           0
##   29.14             0     0     0          1           0
##   29.15             0     0     0          2           0
##   29.16             0     0     0         18           0
##   29.18             0     0     0         65           0
##   29.19             0     0     0          4           0
##   29.2              0     0     0          1           0
##   29.21             0     0     0          6           0
##   29.22             0     0     0          2           0
##   29.23             0     0     0         28           0
##   29.24             0     0     0          5           0
##   29.26             0     0     0         40           0
##   29.27             0     0     0          1           0
##   29.29             0     0     0         92           0
##   29.3              0     0     0          3           0
##   29.32             0     0     0          1           0
##   29.35             0     0     0          4           0
##   29.36             0     0     0          1           0
##   29.37             0     0     0          8           0
##   29.38             0     0     0          8           0
##   29.39             0     0     0          1           0
##   29.4              0     0     0          2           0
##   29.41             0     0     0         26           0
##   29.42             0     0     0          1           0
##   29.43             0     0     0          3           0
##   29.44             0     0     0          4           0
##   29.45             0     0     0          2           0
##   29.49             0     0     0          1           0
##   29.5              0     0     0          3           0
##   29.52             0     0     0          4           0
##   29.53             0     0     0         73           0
##   29.54             0     0     0          3           0
##   29.55             0     0     0          1           0
##   29.57             0     0     0          3           0
##   29.58             0     0     0          2           0
##   29.6              0     0     0          4           0
##   29.62             0     0     0          7           0
##   29.63             0     0     0          5           0
##   29.64             0     0     0          1           0
##   29.65             0     0     0         26           0
##   29.67             0     0     0          2           0
##   29.68             0     0     0         15           0
##   29.69             0     0     0          3           0
##   29.7              0     0     0          5           0
##   29.71             0     0     0          2           0
##   29.74             0     0     0          1           0
##   29.75             0     0     0          1           0
##   29.76             0     0     0         48           0
##   29.79             0     0     0          2           0
##   29.8              0     0     0          4           0
##   29.81             0     0     0          1           0
##   29.82             0     0     0          3           0
##   29.83             0     0     0          2           0
##   29.84             0     0     0         57           0
##   29.85             0     0     0          3           0
##   29.86             0     0     0         25           0
##   29.87             0     0     0          3           0
##   29.88             0     0     0          1           0
##   29.9              0     0     0          5           0
##   29.91             0     0     0          1           0
##   29.92             0     0     0          1           0
##   29.94             0     0     0          2           0
##   29.95             0     0     0         56           0
##   29.98             0     0     0          2           0
##   29.99             0     0     0         19           0
##   30                0    13     0          0           0
##   30.02             0     4     0          0           0
##   30.04             0    50     0          0           0
##   30.05             0     1     0          0           0
##   30.07             0     2     0          0           0
##   30.08             0     4     0          0           0
##   30.11             0    43     0          0           0
##   30.12             0     4     0          0           0
##   30.13             0    54     0          0           0
##   30.14             0     2     0          0           0
##   30.17             0     9     0          0           0
##   30.18             0    29     0          0           0
##   30.21             0     2     0          0           0
##   30.23             0    29     0          0           0
##   30.24             0     4     0          0           0
##   30.25             0     4     0          0           0
##   30.27             0    24     0          0           0
##   30.28             0     4     0          0           0
##   30.29             0     3     0          0           0
##   30.3              0     7     0          0           0
##   30.31             0     2     0          0           0
##   30.34             0    21     0          0           0
##   30.36             0     6     0          0           0
##   30.37             0     3     0          0           0
##   30.38             0     4     0          0           0
##   30.4              0     1     0          0           0
##   30.41             0    74     0          0           0
##   30.42             0    13     0          0           0
##   30.43             0     7     0          0           0
##   30.45             0     2     0          0           0
##   30.46             0     1     0          0           0
##   30.47             0     5     0          0           0
##   30.5              0     2     0          0           0
##   30.51             0     3     0          0           0
##   30.52             0    39     0          0           0
##   30.54             0    17     0          0           0
##   30.55             0     4     0          0           0
##   30.56             0     3     0          0           0
##   30.59             0     2     0          0           0
##   30.61             0     1     0          0           0
##   30.62             0    12     0          0           0
##   30.65             0     4     0          0           0
##   30.66             0     2     0          0           0
##   30.67             0    38     0          0           0
##   30.68             0    43     0          0           0
##   30.69             0     1     0          0           0
##   30.7              0     1     0          0           0
##   30.71             0     4     0          0           0
##   30.72             0     3     0          0           0
##   30.73             0     9     0          0           0
##   30.74             0     1     0          0           0
##   30.75             0     4     0          0           0
##   30.78             0     2     0          0           0
##   30.79             0    26     0          0           0
##   30.8              0     3     0          0           0
##   30.81             0     9     0          0           0
##   30.82             0     2     0          0           0
##   30.83             0     4     0          0           0
##   30.85             0    23     0          0           0
##   30.86             0    16     0          0           0
##   30.87             0     1     0          0           0
##   30.88             0     1     0          0           0
##   30.9              0    54     0          0           0
##   30.91             0     3     0          0           0
##   30.95             0     4     0          0           0
##   30.96             0     2     0          0           0
##   30.99             0     9     0          0           0
##   31                0    35     0          0           0
##   31.01             0    21     0          0           0
##   31.02             0     2     0          0           0
##   31.04             0     3     0          0           0
##   31.05             0     3     0          0           0
##   31.07             0     2     0          0           0
##   31.08             0     1     0          0           0
##   31.09             0    30     0          0           0
##   31.12             0     1     0          0           0
##   31.14             0     4     0          0           0
##   31.15             0     1     0          0           0
##   31.16             0     1     0          0           0
##   31.17             0    11     0          0           0
##   31.18             0    12     0          0           0
##   31.19             0    23     0          0           0
##   31.2              0     1     0          0           0
##   31.21             0     1     0          0           0
##   31.22             0     1     0          0           0
##   31.24             0     5     0          0           0
##   31.25             0    35     0          0           0
##   31.28             0     3     0          0           0
##   31.29             0     1     0          0           0
##   31.31             0     5     0          0           0
##   31.32             0    58     0          0           0
##   31.33             0     1     0          0           0
##   31.35             0     6     0          0           0
##   31.36             0     1     0          0           0
##   31.38             0    15     0          0           0
##   31.4              0     2     0          0           0
##   31.41             0     2     0          0           0
##   31.42             0     1     0          0           0
##   31.45             0     2     0          0           0
##   31.46             0    13     0          0           0
##   31.47             0    15     0          0           0
##   31.48             0     2     0          0           0
##   31.5              0     1     0          0           0
##   31.51             0     2     0          0           0
##   31.52             0     2     0          0           0
##   31.53             0     4     0          0           0
##   31.55             0     1     0          0           0
##   31.57             0    39     0          0           0
##   31.58             0     5     0          0           0
##   31.59             0     1     0          0           0
##   31.6              0     2     0          0           0
##   31.62             0    37     0          0           0
##   31.63             0     5     0          0           0
##   31.64             0     4     0          0           0
##   31.65             0     3     0          0           0
##   31.66             0    20     0          0           0
##   31.67             0     1     0          0           0
##   31.69             0     1     0          0           0
##   31.71             0     3     0          0           0
##   31.72             0     1     0          0           0
##   31.74             0     7     0          0           0
##   31.75             0    32     0          0           0
##   31.78             0     2     0          0           0
##   31.79             0     2     0          0           0
##   31.8              0     5     0          0           0
##   31.82             0     1     0          0           0
##   31.83             0     1     0          0           0
##   31.84             0     1     0          0           0
##   31.85             0     1     0          0           0
##   31.86             0     1     0          0           0
##   31.87             0    18     0          0           0
##   31.89             0    39     0          0           0
##   31.91             0     1     0          0           0
##   31.92             0     2     0          0           0
##   31.93             0    24     0          0           0
##   31.95             0     5     0          0           0
##   31.96             0     4     0          0           0
##   31.99             0     2     0          0           0
##   32                0     3     0          0           0
##   32.01             0    16     0          0           0
##   32.02             0     3     0          0           0
##   32.06             0     1     0          0           0
##   32.08             0    21     0          0           0
##   32.1              0    17     0          0           0
##   32.11             0    10     0          0           0
##   32.12             0    15     0          0           0
##   32.14             0     2     0          0           0
##   32.17             0     1     0          0           0
##   32.22             0     2     0          0           0
##   32.23             0     1     0          0           0
##   32.24             0     1     0          0           0
##   32.26             0     2     0          0           0
##   32.27             0     2     0          0           0
##   32.28             0    89     0          0           0
##   32.29             0     5     0          0           0
##   32.32             0    12     0          0           0
##   32.36             0     2     0          0           0
##   32.38             0     1     0          0           0
##   32.41             0     2     0          0           0
##   32.42             0     1     0          0           0
##   32.43             0     1     0          0           0
##   32.44             0     4     0          0           0
##   32.45             0     8     0          0           0
##   32.49             0    33     0          0           0
##   32.5              0     7     0          0           0
##   32.54             0     1     0          0           0
##   32.55             0    17     0          0           0
##   32.56             0     7     0          0           0
##   32.58             0     1     0          0           0
##   32.6              0     5     0          0           0
##   32.61             0    36     0          0           0
##   32.62             0     3     0          0           0
##   32.64             0     1     0          0           0
##   32.65             0     3     0          0           0
##   32.66             0     1     0          0           0
##   32.69             0    17     0          0           0
##   32.71             0     1     0          0           0
##   32.73             0     2     0          0           0
##   32.74             0     7     0          0           0
##   32.77             0     5     0          0           0
##   32.78             0    12     0          0           0
##   32.8              0     1     0          0           0
##   32.81             0     1     0          0           0
##   32.84             0     2     0          0           0
##   32.85             0     1     0          0           0
##   32.86             0     1     0          0           0
##   32.87             0     3     0          0           0
##   32.88             0     1     0          0           0
##   32.89             0    24     0          0           0
##   32.9              0     1     0          0           0
##   32.91             0     2     0          0           0
##   32.92             0    24     0          0           0
##   32.93             0     2     0          0           0
##   32.95             0     7     0          0           0
##   32.96             0     2     0          0           0
##   32.98             0    21     0          0           0
##   32.99             0     1     0          0           0
##   33                0    24     0          0           0
##   33.02             0     1     0          0           0
##   33.03             0     1     0          0           0
##   33.05             0     2     0          0           0
##   33.07             0     5     0          0           0
##   33.08             0     1     0          0           0
##   33.09             0    11     0          0           0
##   33.11             0     2     0          0           0
##   33.12             0     9     0          0           0
##   33.13             0     2     0          0           0
##   33.14             0     1     0          0           0
##   33.19             0     4     0          0           0
##   33.2              0    14     0          0           0
##   33.21             0     1     0          0           0
##   33.23             0    21     0          0           0
##   33.25             0     2     0          0           0
##   33.28             0    49     0          0           0
##   33.29             0     4     0          0           0
##   33.3              0     1     0          0           0
##   33.31             0     1     0          0           0
##   33.32             0     2     0          0           0
##   33.33             0     3     0          0           0
##   33.36             0     1     0          0           0
##   33.38             0     8     0          0           0
##   33.43             0     1     0          0           0
##   33.44             0     1     0          0           0
##   33.45             0    25     0          0           0
##   33.46             0     1     0          0           0
##   33.47             0    26     0          0           0
##   33.48             0     4     0          0           0
##   33.49             0     1     0          0           0
##   33.52             0     5     0          0           0
##   33.57             0     1     0          0           0
##   33.58             0     1     0          0           0
##   33.59             0     3     0          0           0
##   33.61             0     2     0          0           0
##   33.63             0     2     0          0           0
##   33.64             0    12     0          0           0
##   33.66             0    17     0          0           0
##   33.67             0    11     0          0           0
##   33.68             0     1     0          0           0
##   33.72             0     8     0          0           0
##   33.73             0     1     0          0           0
##   33.75             0     7     0          0           0
##   33.76             0     1     0          0           0
##   33.77             0     1     0          0           0
##   33.79             0     1     0          0           0
##   33.8              0     4     0          0           0
##   33.81             0     2     0          0           0
##   33.82             0     1     0          0           0
##   33.84             0     7     0          0           0
##   33.86             0     1     0          0           0
##   33.87             0     1     0          0           0
##   33.89             0    15     0          0           0
##   33.91             0    29     0          0           0
##   33.93             0     1     0          0           0
##   33.96             0    13     0          0           0
##   33.97             0     2     0          0           0
##   33.99             0     4     0          0           0
##   34.01             0    12     0          0           0
##   34.02             0     7     0          0           0
##   34.03             0     1     0          0           0
##   34.04             0     1     0          0           0
##   34.06             0     5     0          0           0
##   34.08             0     4     0          0           0
##   34.11             0     4     0          0           0
##   34.14             0     2     0          0           0
##   34.15             0     1     0          0           0
##   34.16             0     2     0          0           0
##   34.17             0     6     0          0           0
##   34.18             0    12     0          0           0
##   34.21             0    11     0          0           0
##   34.22             0     4     0          0           0
##   34.27             0     2     0          0           0
##   34.28             0     1     0          0           0
##   34.3              0     5     0          0           0
##   34.31             0     1     0          0           0
##   34.33             0    38     0          0           0
##   34.34             0     3     0          0           0
##   34.36             0     2     0          0           0
##   34.37             0     3     0          0           0
##   34.38             0     1     0          0           0
##   34.39             0     3     0          0           0
##   34.4              0     1     0          0           0
##   34.41             0     2     0          0           0
##   34.44             0    24     0          0           0
##   34.45             0     4     0          0           0
##   34.46             0    23     0          0           0
##   34.48             0     1     0          0           0
##   34.5              0     1     0          0           0
##   34.52             0     1     0          0           0
##   34.53             0     3     0          0           0
##   34.54             0     3     0          0           0
##   34.56             0     1     0          0           0
##   34.57             0     5     0          0           0
##   34.58             0     5     0          0           0
##   34.6              0     3     0          0           0
##   34.61             0     3     0          0           0
##   34.67             0     6     0          0           0
##   34.68             0     1     0          0           0
##   34.69             0     1     0          0           0
##   34.7              0    20     0          0           0
##   34.72             0     4     0          0           0
##   34.74             0     1     0          0           0
##   34.75             0    11     0          0           0
##   34.77             0     1     0          0           0
##   34.78             0     1     0          0           0
##   34.8              0     1     0          0           0
##   34.81             0     2     0          0           0
##   34.85             0     2     0          0           0
##   34.87             0    18     0          0           0
##   34.88             0     1     0          0           0
##   34.9              0     5     0          0           0
##   34.93             0     2     0          0           0
##   34.95             0    14     0          0           0
##   34.96             0     2     0          0           0
##   34.97             0    19     0          0           0
##   34.98             0     1     0          0           0
##   34.99             0     2     0          0           0
##   35                0     2     0          0           0
##   35.02             0     1     0          0           0
##   35.05             0     2     0          0           0
##   35.08             0     1     0          0           0
##   35.11             0     3     0          0           0
##   35.12             0     1     0          0           0
##   35.13             0     1     0          0           0
##   35.15             0    17     0          0           0
##   35.16             0     1     0          0           0
##   35.19             0     4     0          0           0
##   35.24             0    12     0          0           0
##   35.26             0    12     0          0           0
##   35.28             0     4     0          0           0
##   35.29             0     1     0          0           0
##   35.3              0     1     0          0           0
##   35.31             0     5     0          0           0
##   35.33             0     3     0          0           0
##   35.35             0     1     0          0           0
##   35.36             0     3     0          0           0
##   35.4              0     1     0          0           0
##   35.43             0    22     0          0           0
##   35.44             0    16     0          0           0
##   35.48             0     2     0          0           0
##   35.49             0     1     0          0           0
##   35.5              0     1     0          0           0
##   35.51             0    19     0          0           0
##   35.52             0     1     0          0           0
##   35.54             0     2     0          0           0
##   35.55             0     1     0          0           0
##   35.56             0     6     0          0           0
##   35.57             0     1     0          0           0
##   35.58             0     7     0          0           0
##   35.59             0     1     0          0           0
##   35.61             0     2     0          0           0
##   35.62             0    10     0          0           0
##   35.67             0     8     0          0           0
##   35.71             0     3     0          0           0
##   35.73             0     9     0          0           0
##   35.74             0     8     0          0           0
##   35.75             0     1     0          0           0
##   35.78             0     4     0          0           0
##   35.8              0     1     0          0           0
##   35.81             0     1     0          0           0
##   35.82             0     3     0          0           0
##   35.83             0     3     0          0           0
##   35.85             0     1     0          0           0
##   35.87             0    20     0          0           0
##   35.88             0     3     0          0           0
##   35.89             0     1     0          0           0
##   35.9              0     5     0          0           0
##   35.93             0     2     0          0           0
##   35.94             0    11     0          0           0
##   35.95             0    18     0          0           0
##   35.98             0     2     0          0           0
##   35.99             0     1     0          0           0
##   36                0     1     0          0           0
##   36.01             0     1     0          0           0
##   36.02             0    14     0          0           0
##   36.03             0     2     0          0           0
##   36.04             0     3     0          0           0
##   36.05             0     6     0          0           0
##   36.11             0     1     0          0           0
##   36.13             0     1     0          0           0
##   36.15             0     1     0          0           0
##   36.18             0     6     0          0           0
##   36.19             0     2     0          0           0
##   36.2              0     1     0          0           0
##   36.21             0     3     0          0           0
##   36.22             0     1     0          0           0
##   36.25             0     3     0          0           0
##   36.26             0     7     0          0           0
##   36.28             0     7     0          0           0
##   36.29             0     3     0          0           0
##   36.31             0     4     0          0           0
##   36.32             0     6     0          0           0
##   36.33             0     1     0          0           0
##   36.35             0     1     0          0           0
##   36.36             0     4     0          0           0
##   36.38             0     1     0          0           0
##   36.39             0     3     0          0           0
##   36.48             0     1     0          0           0
##   36.49             0    17     0          0           0
##   36.52             0     1     0          0           0
##   36.56             0     2     0          0           0
##   36.58             0    23     0          0           0
##   36.59             0     4     0          0           0
##   36.6              0     2     0          0           0
##   36.61             0    13     0          0           0
##   36.62             0     6     0          0           0
##   36.65             0     1     0          0           0
##   36.68             0     1     0          0           0
##   36.69             0     9     0          0           0
##   36.73             0     1     0          0           0
##   36.78             0     2     0          0           0
##   36.8              0     2     0          0           0
##   36.81             0     4     0          0           0
##   36.82             0     1     0          0           0
##   36.84             0     1     0          0           0
##   36.87             0     7     0          0           0
##   36.88             0     1     0          0           0
##   36.9              0     8     0          0           0
##   36.91             0     2     0          0           0
##   36.92             0    16     0          0           0
##   36.93             0     1     0          0           0
##   36.94             0     5     0          0           0
##   36.95             0     1     0          0           0
##   36.96             0     8     0          0           0
##   37                0     1     0          0           0
##   37.01             0     2     0          0           0
##   37.03             0     1     0          0           0
##   37.08             0     1     0          0           0
##   37.09             0     5     0          0           0
##   37.1              0    10     0          0           0
##   37.11             0     7     0          0           0
##   37.12             0    13     0          0           0
##   37.18             0     1     0          0           0
##   37.2              0     4     0          0           0
##   37.22             0     2     0          0           0
##   37.23             0     3     0          0           0
##   37.25             0     9     0          0           0
##   37.28             0     1     0          0           0
##   37.3              0     6     0          0           0
##   37.31             0     9     0          0           0
##   37.36             0     6     0          0           0
##   37.37             0     6     0          0           0
##   37.38             0     2     0          0           0
##   37.41             0     3     0          0           0
##   37.42             0     2     0          0           0
##   37.44             0     7     0          0           0
##   37.45             0     1     0          0           0
##   37.46             0     1     0          0           0
##   37.49             0    10     0          0           0
##   37.5              0    10     0          0           0
##   37.54             0     1     0          0           0
##   37.57             0     1     0          0           0
##   37.59             0    11     0          0           0
##   37.6              0     2     0          0           0
##   37.61             0     4     0          0           0
##   37.64             0     1     0          0           0
##   37.65             0     1     0          0           0
##   37.66             0    12     0          0           0
##   37.68             0     2     0          0           0
##   37.71             0     1     0          0           0
##   37.73             0     2     0          0           0
##   37.75             0     1     0          0           0
##   37.76             0    19     0          0           0
##   37.77             0     1     0          0           0
##   37.79             0    11     0          0           0
##   37.8              0     2     0          0           0
##   37.83             0     1     0          0           0
##   37.84             0    13     0          0           0
##   37.86             0     1     0          0           0
##   37.87             0     1     0          0           0
##   37.88             0     1     0          0           0
##   37.89             0     6     0          0           0
##   37.91             0     3     0          0           0
##   37.93             0     5     0          0           0
##   37.95             0     3     0          0           0
##   37.96             0     8     0          0           0
##   37.97             0     8     0          0           0
##   37.98             0    14     0          0           0
##   38.01             0    19     0          0           0
##   38.02             0     1     0          0           0
##   38.04             0     2     0          0           0
##   38.06             0     4     0          0           0
##   38.07             0     1     0          0           0
##   38.08             0     2     0          0           0
##   38.09             0     7     0          0           0
##   38.1              0     1     0          0           0
##   38.11             0     1     0          0           0
##   38.14             0     1     0          0           0
##   38.17             0     1     0          0           0
##   38.21             0     3     0          0           0
##   38.22             0     4     0          0           0
##   38.24             0     1     0          0           0
##   38.25             0     1     0          0           0
##   38.26             0     1     0          0           0
##   38.27             0    17     0          0           0
##   38.28             0     4     0          0           0
##   38.31             0     3     0          0           0
##   38.34             0     1     0          0           0
##   38.35             0     3     0          0           0
##   38.37             0     3     0          0           0
##   38.39             0     4     0          0           0
##   38.41             0     4     0          0           0
##   38.42             0     1     0          0           0
##   38.43             0     6     0          0           0
##   38.44             0     2     0          0           0
##   38.45             0     1     0          0           0
##   38.52             0     9     0          0           0
##   38.53             0     1     0          0           0
##   38.58             0     1     0          0           0
##   38.59             0     1     0          0           0
##   38.61             0     1     0          0           0
##   38.62             0     4     0          0           0
##   38.65             0     4     0          0           0
##   38.66             0     1     0          0           0
##   38.67             0     1     0          0           0
##   38.69             0     2     0          0           0
##   38.73             0     2     0          0           0
##   38.74             0    18     0          0           0
##   38.75             0     1     0          0           0
##   38.77             0     2     0          0           0
##   38.79             0     2     0          0           0
##   38.82             0     1     0          0           0
##   38.91             0     1     0          0           0
##   38.92             0     1     0          0           0
##   38.95             0     1     0          0           0
##   38.97             0    14     0          0           0
##   39                0     1     0          0           0
##   39.05             0     5     0          0           0
##   39.06             0     7     0          0           0
##   39.08             0     1     0          0           0
##   39.11             0     1     0          0           0
##   39.13             0     5     0          0           0
##   39.14             0     2     0          0           0
##   39.16             0    16     0          0           0
##   39.2              0     1     0          0           0
##   39.22             0     1     0          0           0
##   39.25             0     1     0          0           0
##   39.27             0     1     0          0           0
##   39.28             0     1     0          0           0
##   39.32             0     5     0          0           0
##   39.33             0     4     0          0           0
##   39.36             0     1     0          0           0
##   39.38             0     1     0          0           0
##   39.45             0     1     0          0           0
##   39.46             0     2     0          0           0
##   39.48             0     9     0          0           0
##   39.49             0     1     0          0           0
##   39.53             0     8     0          0           0
##   39.54             0     1     0          0           0
##   39.58             0     4     0          0           0
##   39.6              0     2     0          0           0
##   39.67             0     1     0          0           0
##   39.68             0     5     0          0           0
##   39.75             0     5     0          0           0
##   39.77             0     2     0          0           0
##   39.8              0     4     0          0           0
##   39.84             0     1     0          0           0
##   39.86             0     1     0          0           0
##   39.87             0     8     0          0           0
##   39.89             0     1     0          0           0
##   39.94             0    16     0          0           0
##   40.03             0     1     0          0           0
##   40.09             0     3     0          0           0
##   40.14             0     2     0          0           0
##   40.17             0     2     0          0           0
##   40.18             0     6     0          0           0
##   40.19             0     1     0          0           0
##   40.21             0     1     0          0           0
##   40.24             0     4     0          0           0
##   40.25             0     1     0          0           0
##   40.27             0     1     0          0           0
##   40.29             0     1     0          0           0
##   40.31             0     1     0          0           0
##   40.34             0     4     0          0           0
##   40.35             0    19     0          0           0
##   40.37             0     1     0          0           0
##   40.39             0     1     0          0           0
##   40.41             0     2     0          0           0
##   40.42             0     1     0          0           0
##   40.44             0     1     0          0           0
##   40.45             0     3     0          0           0
##   40.49             0     1     0          0           0
```

# Recode Language

```r
table(ibiccs_clean$lang)
```

```
## 
##  Anglais Espagnol Français 
##    22236       44     1621
```

```r
## Language
ibiccs_clean <- ibiccs_clean %>%
	mutate(language = case_when(
		lang == "Anglais" ~ "English",
		lang == "Espagnol" ~ "Fren/Span",
		lang == "Français" ~ "Fren/Span"
	))
table(ibiccs_clean$lang, ibiccs_clean$language)
```

```
##           
##            English Fren/Span
##   Anglais    22236         0
##   Espagnol       0        44
##   Français       0      1621
```

# Recode Gender

```r
table(ibiccs_clean$q54)
```

```
## 
## Femme Homme 
## 14042  9859
```

```r
#Gender
ibiccs_clean <- ibiccs_clean %>%
  mutate(gender = case_when(
    q54 == "Femme" ~ "Female",
    q54 == "Homme" ~ "Male"
  ))
table(ibiccs_clean$q54, ibiccs_clean$gender)
```

```
##        
##         Female  Male
##   Femme  14042     0
##   Homme      0  9859
```

# Recode Self-Rated Health

```r
table(ibiccs_clean$q2)
```

```
## 
##                            Bon                      Excellent 
##                           6725                           4803 
##                        Mauvais                          Moyen 
##                            489                           2104 
## Ne sais pas/Refuse de répondre                       Très bon 
##                             39                           9741
```

```r
ibiccs_clean <- ibiccs_clean %>%
  mutate(health = case_when(
    q2 == "Excellent" ~ "Excellent",
    q2 == "Très bon" ~ "Excellent",
    q2 == "Bon" ~ "Good",
    q2 == "Moyen" ~ "Poor",
    q2 == "Mauvais" ~ "Poor"
  ))
table(ibiccs_clean$q2, ibiccs_clean$health)
```

```
##                                 
##                                  Excellent Good Poor
##   Bon                                    0 6725    0
##   Excellent                           4803    0    0
##   Mauvais                                0    0  489
##   Moyen                                  0    0 2104
##   Ne sais pas/Refuse de répondre         0    0    0
##   Très bon                            9741    0    0
```

# Recode Transportation

```r
table(ibiccs_clean$q13)
```

```
## 
##                               Autre (précisez:) 
##                                              35 
##                                          Marche 
##                                            4484 
##                               Ne s'applique pas 
##                                              61 
##                                     Ne sais pas 
##                                              36 
##                                         Scooter 
##                                              21 
##                                            Taxi 
##                                             205 
##                             Transport en commun 
##                                            7886 
## Véhicule motorisé (loué, emprunté, covoiturage) 
##                                            9768 
##                           Vélo en libre-service 
##                                             243 
##                                  Vélo personnel 
##                                             934 
##                             Voiture personnelle 
##                                             228
```

```r
ibiccs_clean <- ibiccs_clean %>%
  mutate(common_transportation = case_when(
    q13 == "Marche" ~ "Walking",
    q13 == "Véhicule motorisé (loué, emprunté, covoiturage)" ~ "Car",
    q13 == "Voiture personnelle" ~ "Car",
    q13 == "Scooter" ~ "Other",
    q13 == "Taxi" ~ "Other",
    q13 == "Autre (précisez:)" ~ "Other",
    q13 == "Transport en commun" ~ "Public Transportation",
    q13 == "Vélo en libre-service" ~ "Bicycle",
    q13 == "Vélo personnel" ~ "Bicycle"
  ))
table(ibiccs_clean$q13, ibiccs_clean$common_transportation)
```

```
##                                                  
##                                                   Bicycle  Car Other
##   Autre (précisez:)                                     0    0    35
##   Marche                                                0    0     0
##   Ne s'applique pas                                     0    0     0
##   Ne sais pas                                           0    0     0
##   Scooter                                               0    0    21
##   Taxi                                                  0    0   205
##   Transport en commun                                   0    0     0
##   Véhicule motorisé (loué, emprunté, covoiturage)       0 9768     0
##   Vélo en libre-service                               243    0     0
##   Vélo personnel                                      934    0     0
##   Voiture personnelle                                   0  228     0
##                                                  
##                                                   Public Transportation
##   Autre (précisez:)                                                   0
##   Marche                                                              0
##   Ne s'applique pas                                                   0
##   Ne sais pas                                                         0
##   Scooter                                                             0
##   Taxi                                                                0
##   Transport en commun                                              7886
##   Véhicule motorisé (loué, emprunté, covoiturage)                     0
##   Vélo en libre-service                                               0
##   Vélo personnel                                                      0
##   Voiture personnelle                                                 0
##                                                  
##                                                   Walking
##   Autre (précisez:)                                     0
##   Marche                                             4484
##   Ne s'applique pas                                     0
##   Ne sais pas                                           0
##   Scooter                                               0
##   Taxi                                                  0
##   Transport en commun                                   0
##   Véhicule motorisé (loué, emprunté, covoiturage)       0
##   Vélo en libre-service                                 0
##   Vélo personnel                                        0
##   Voiture personnelle                                   0
```

# Recode Physically Active (Y/N)

```r
table(ibiccs_clean$q14)
```

```
## 
## Ne sais pas/Ne s'applique pas                           Non 
##                           276                          4124 
##                           Oui            Refuse de répondre 
##                         19471                            30
```

```r
ibiccs_clean <- ibiccs_clean %>%
  mutate(physically_active = case_when(
    q14 == "Oui" ~ "Yes",
    q14 == "Non" ~ "No"
  ))
table(ibiccs_clean$q14, ibiccs_clean$physically_active)
```

```
##                                
##                                    No   Yes
##   Ne sais pas/Ne s'applique pas     0     0
##   Non                            4124     0
##   Oui                               0 19471
##   Refuse de répondre                0     0
```

# Recode Type of Physical Activity 

```r
# Code into Sedentary, Walking, Moderate, Vigorous Activity
table(ibiccs_clean$q18)
```

```
## 
##    1    2    3    4    5    6    7    8    9   10   11   12   13   14   15 
##  266  447   49   97  243  508  976   52  204   78  291   10   53  332  662 
##   16   17   18   19   20   21   22   23   24   25   26   27   28   29   30 
##   51   31  561  101  181    8  254  102   29   24   13   17  649    5   30 
##   31   32   33   34   35   36   37   38   39   40   41   42   43   44   45 
##  206    6   55  254   22  229  920   24   17   44    4    9   11   46    1 
##   46   47   48   49   50   51   52   53   54   55   56   57   58   59   60 
##   12    8   15   16    5  139   58   23  266    3    5  355  225   55   80 
##   61   62   63   64   65   66   67   68   69   70   71   96   97   98   99 
##  145   30   75 3243    8 1203   20  862   34   52   17  544 3167  594   40
```

```r
  ibiccs_clean <- ibiccs_clean %>%
    mutate(pa_level = case_when(
      q15 == 1 ~ "Low",
      q15 == 2 ~ "Moderate",
      q15 == 3 ~ "Low",
      q15 == 4 ~ "Moderate",
      q15 == 5 ~ "Vigorous",
      q15 == 6 ~ "Moderate",
      q15 == 7 ~ "Moderate",
      q15 == 8 ~ "Low",
      q15 == 9 ~ "Low",
      q15 == 10 ~ "Vigorous",
      q15 == 11 ~ "Vigorous",
      q15 == 12 ~ "Moderate",
      q15 == 13 ~ "Low",
      q15 == 14 ~ "Vigorous",
      q15 == 15 ~ "Vigorous",
      q15 == 16 ~ "Sedentary",
      q15 == 17 ~ "Low",
      q15 == 18 ~ "Moderate",
      q15 == 19 ~ "Low",
      q15 == 20 ~ "Moderate",
      q15 == 21 ~ "Moderate",
      q15 == 22 ~ "Vigorous",
      q15 == 23 ~ "Vigorous",
      q15 == 24 ~ "Low",
      q15 == 25 ~ "Low",
      q15 == 26 ~ "Low",
      q15 == 27 ~ "Moderate",
      q15 == 28 ~ "Vigorous",
      q15 == 29 ~ "Vigorous",
      q15 == 30 ~ "Vigorous",
      q15 == 31 ~ "Low",
      q15 == 32 ~ "Moderate",
      q15 == 33 ~ "Moderate",
      q15 == 34 ~ "Moderate",
      q15 == 35 ~ "Moderate",
      q15 == 36 ~ "Moderate",
      q15 == 37 ~ "Vigorous",
      q15 == 38 ~ "Vigorous",
      q15 == 39 ~ "Vigorous",
      q15 == 40 ~ "Vigorous",
      q15 == 41 ~ "Vigorous",
      q15 == 42 ~ "Moderate",
      q15 == 43 ~ "Moderate",
      q15 == 44 ~ "Vigorous",
      q15 == 45 ~ "Low",
      q15 == 46 ~ "Moderate",
      q15 == 47 ~ "Moderate",
      q15 == 48 ~ "Vigorous",
      q15 == 49 ~ "Moderate",
      q15 == 50 ~ "Moderate",
      q15 == 51 ~ "Vigorous",
      q15 == 52 ~ "Vigorous",
      q15 == 53 ~ "Vigorous",
      q15 == 54 ~ "Moderate",
      q15 == 55 ~ "Low",
      q15 == 56 ~ "Vigorous",
      q15 == 57 ~ "Moderate",
      q15 == 58 ~ "Vigorous",
      q15 == 59 ~ "Moderate",
      q15 == 60 ~ "Vigorous",
      q15 == 61 ~ "Vigorous",
      q15 == 62 ~ "Vigorous",
      q15 == 63 ~ "Vigorous",
      q15 == 64 ~ "Moderate",
      q15 == 65 ~ "Moderate",
      q15 == 66 ~ "Vigorous",
      q15 == 67 ~ "Vigorous",
      q15 == 68 ~ "Low",
      q15 == 69 ~ "Moderate",
      q15 == 96 ~ "NA",
      q15 == 97 ~ "Sedentary",
      q15 == 98 ~ "NA",
      q15 == 99 ~ "NA",
      TRUE ~ "NA"
    ))
table(ibiccs_clean$q15, ibiccs_clean$pa_level)
```

```
##     
##       Low Moderate   NA Sedentary Vigorous
##   1   157        0    0         0        0
##   2     0      629    0         0        0
##   3    47        0    0         0        0
##   4     0       81    0         0        0
##   5     0        0    0         0      288
##   6     0      436    0         0        0
##   7     0     1044    0         0        0
##   8    26        0    0         0        0
##   9   131        0    0         0        0
##   10    0        0    0         0       74
##   11    0        0    0         0      179
##   12    0       12    0         0        0
##   13   33        0    0         0        0
##   14    0        0    0         0      316
##   15    0        0    0         0      828
##   16    0        0    0        30        0
##   17   27        0    0         0        0
##   18    0      357    0         0        0
##   19  122        0    0         0        0
##   20    0      174    0         0        0
##   21    0        9    0         0        0
##   22    0        0    0         0      156
##   23    0        0    0         0      182
##   24   29        0    0         0        0
##   25   27        0    0         0        0
##   26    8        0    0         0        0
##   27    0       14    0         0        0
##   28    0        0    0         0      852
##   29    0        0    0         0        2
##   30    0        0    0         0       23
##   31   92        0    0         0        0
##   32    0        3    0         0        0
##   33    0       30    0         0        0
##   34    0      188    0         0        0
##   35    0       15    0         0        0
##   36    0       93    0         0        0
##   37    0        0    0         0     1555
##   38    0        0    0         0       25
##   39    0        0    0         0        8
##   40    0        0    0         0       34
##   41    0        0    0         0       15
##   42    0       18    0         0        0
##   43    0       13    0         0        0
##   44    0        0    0         0       56
##   46    0        1    0         0        0
##   47    0        3    0         0        0
##   48    0        0    0         0       11
##   49    0       11    0         0        0
##   50    0        4    0         0        0
##   51    0        0    0         0      167
##   52    0        0    0         0       56
##   53    0        0    0         0       25
##   54    0      142    0         0        0
##   55    8        0    0         0        0
##   56    0        0    0         0       10
##   57    0      300    0         0        0
##   58    0        0    0         0      199
##   59    0       28    0         0        0
##   60    0        0    0         0       60
##   61    0        0    0         0      179
##   62    0        0    0         0       28
##   63    0        0    0         0       98
##   64    0     7090    0         0        0
##   65    0        2    0         0        0
##   66    0        0    0         0     1165
##   67    0        0    0         0       13
##   68  840        0    0         0        0
##   69    0       74    0         0        0
##   70    0        0   65         0        0
##   71    0        0   21         0        0
##   96    0        0  362         0        0
##   98    0        0   54         0        0
##   99    0        0   17         0        0
```

# Recode Days Per Week Spent Travelling via Car

```r
table(ibiccs_clean$q21)
```

```
## 
##    0    1    2    3    4    5    6    7   98   99 
## 2785 2527 2631 2070 1648 3136 2019 4925 2037  123
```

```r
typeof(ibiccs_clean$q21)
```

```
## [1] "integer"
```

```r
ibiccs_clean <- ibiccs_clean %>%
  mutate(day_per_week_motor_vehicle = case_when(
    q21 == 0 ~ 0,
    q21 == 1 ~ 1,
    q21 == 2 ~ 2,
    q21 == 3 ~ 3,
    q21 == 4 ~ 4,
    q21 == 5 ~ 5,
    q21 == 6 ~ 6,
    q21 == 7 ~ 7,
    q21 == 98 ~ NA_real_,
    q21 == 99 ~ NA_real_
  ))

table(ibiccs_clean$day_per_week_motor_vehicle)
```

```
## 
##    0    1    2    3    4    5    6    7 
## 2785 2527 2631 2070 1648 3136 2019 4925
```

# Recode Days Per Week Spent Travelling via Public Transport

```r
table(ibiccs_clean$q23)
```

```
## 
##    0    1    2    3    4    5    6    7    8    9 
## 6169 2993 2167 1598 1339 3617 1482 1583 2726  227
```

```r
ibiccs_clean <- ibiccs_clean %>%
  mutate(day_per_week_public_transit = case_when(
    q23 == 0 ~ 0,
    q23 == 1 ~ 1,
    q23 == 2 ~ 2,
    q23 == 3 ~ 3,
    q23 == 4 ~ 4,
    q23 == 5 ~ 5,
    q23 == 6 ~ 6,
    q23 == 7 ~ 7,
    q23 == 8 ~ NA_real_,
    q23 == 9 ~ NA_real_
  ))

table(ibiccs_clean$q23, ibiccs_clean$day_per_week_public_transit)
```

```
##    
##        0    1    2    3    4    5    6    7
##   0 6169    0    0    0    0    0    0    0
##   1    0 2993    0    0    0    0    0    0
##   2    0    0 2167    0    0    0    0    0
##   3    0    0    0 1598    0    0    0    0
##   4    0    0    0    0 1339    0    0    0
##   5    0    0    0    0    0 3617    0    0
##   6    0    0    0    0    0    0 1482    0
##   7    0    0    0    0    0    0    0 1583
##   8    0    0    0    0    0    0    0    0
##   9    0    0    0    0    0    0    0    0
```

# Recode Days Per Week Spent Travelling via Walking

```r
table(ibiccs_clean$q25)
```

```
## 
##    0    1    2    3    4    5    6    7    8    9 
## 2115 1841 2361 2245 1831 3994 1711 5436 2149  218
```

```r
ibiccs_clean <- ibiccs_clean %>%
  mutate(day_per_week_walking = case_when(
    q25 == 0 ~ 0,
    q25 == 1 ~ 1,
    q25 == 2 ~ 2,
    q25 == 3 ~ 3,
    q25 == 4 ~ 4,
    q25 == 5 ~ 5,
    q25 == 6 ~ 6,
    q25 == 7 ~ 7,
    q25 == 8 ~ NA_real_,
    q25 == 9 ~ NA_real_
  ))

table(ibiccs_clean$q25, ibiccs_clean$day_per_week_walking)
```

```
##    
##        0    1    2    3    4    5    6    7
##   0 2115    0    0    0    0    0    0    0
##   1    0 1841    0    0    0    0    0    0
##   2    0    0 2361    0    0    0    0    0
##   3    0    0    0 2245    0    0    0    0
##   4    0    0    0    0 1831    0    0    0
##   5    0    0    0    0    0 3994    0    0
##   6    0    0    0    0    0    0 1711    0
##   7    0    0    0    0    0    0    0 5436
##   8    0    0    0    0    0    0    0    0
##   9    0    0    0    0    0    0    0    0
```

# Recode Days Per Week Spent Travelling via Bike

```r
table(ibiccs_clean$q27)
```

```
## 
##     0     1     2     3     4     5     6     7    98    99 
## 12010  1793  1185   741   462   632   215   294  6395   174
```

```r
ibiccs_clean <- ibiccs_clean %>%
  mutate(day_per_week_bike = case_when(
    q27 == 0 ~ 0,
    q27 == 1 ~ 1,
    q27 == 2 ~ 2,
    q27 == 3 ~ 3,
    q27 == 4 ~ 4,
    q27 == 5 ~ 5,
    q27 == 6 ~ 6,
    q27 == 7 ~ 7,
    q27 == 98 ~ NA_real_,
    q27 == 99 ~ NA_real_
  ))

table(ibiccs_clean$q27, ibiccs_clean$day_per_week_bike)
```

```
##     
##          0     1     2     3     4     5     6     7
##   0  12010     0     0     0     0     0     0     0
##   1      0  1793     0     0     0     0     0     0
##   2      0     0  1185     0     0     0     0     0
##   3      0     0     0   741     0     0     0     0
##   4      0     0     0     0   462     0     0     0
##   5      0     0     0     0     0   632     0     0
##   6      0     0     0     0     0     0   215     0
##   7      0     0     0     0     0     0     0   294
##   98     0     0     0     0     0     0     0     0
##   99     0     0     0     0     0     0     0     0
```

# Recode Age

```r
summary(ibiccs_clean$q42)
```

```
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    18.0    31.0    41.0    42.6    53.0    94.0
```

```r
#CCHS/STATCAN or continuous
```

# Recode Marital Status

```r
table(ibiccs_clean$q44)
```

```
## 
##               Célibatiare               Divorcé (e) 
##                      9452                      1854 
##                 En couple Marié(e)/Conjoint de fait 
##                        79                     11287 
##        Refuse de répondre                Séparé (e) 
##                       291                       460 
##                 Veuf (ve) 
##                       478
```

```r
ibiccs_clean <- ibiccs_clean %>%
  mutate(marital_status = case_when(
    q44 == "Célibatiare" ~ "Single",
    q44 == "Divorcé(e)" ~ "Divorced/Separated/Widowed",
    q44 == "En couple" ~ "Relationship/Married/Common-Law",
    q44 == "Marié(e)/Conjoint de fait" ~ "Relationship/Married/Common-Law",
    q44 == "Séparé(e)" ~ "Divorced/Separated/Widowed",
    q44 == "Veuf(ve)" ~ "Divorced/Separated/Widowed"
  ))
table(ibiccs_clean$q44, ibiccs_clean$marital_status)
```

```
##                            
##                             Relationship/Married/Common-Law Single
##   Célibatiare                                             0   9452
##   Divorcé (e)                                             0      0
##   En couple                                              79      0
##   Marié(e)/Conjoint de fait                           11287      0
##   Refuse de répondre                                      0      0
##   Séparé (e)                                              0      0
##   Veuf (ve)                                               0      0
```

# Recode Number of Children in Home

```r
table(ibiccs_clean$q45)
```

```
## 
##     1     2     3     4     5     6     7     8     9 
##  2915  1863   471   119    40    18     9 18191   275
```

```r
ibiccs_clean <- ibiccs_clean %>%
  mutate(children_household = case_when(
    q45 == 1 ~ 1,
    q45 == 2 ~ 2,
    q45 == 3 ~ 3,
    q45 == 4 ~ 3,
    q45 == 5 ~ 3,
    q45 == 6 ~ 3,
    q45 == 7 ~ 3,
    q45 == 8 ~ 0,
    q45 == 9 ~ NA_real_
  ))
table(ibiccs_clean$q45, ibiccs_clean$children_household)
```

```
##    
##         0     1     2     3
##   1     0  2915     0     0
##   2     0     0  1863     0
##   3     0     0     0   471
##   4     0     0     0   119
##   5     0     0     0    40
##   6     0     0     0    18
##   7     0     0     0     9
##   8 18191     0     0     0
##   9     0     0     0     0
```

# Recode Months in Current Home?

```r
summary(ibiccs_clean$q46b)
```

```
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
##       0       3       5       5       6      81   15358
```

# Recode Ethnicity

```r
table(ibiccs_clean$q47)
```

```
## 
## Amérindien des États-Unis / Autochtone d'Amérique 
##                                                79 
##             Arabe (Moyen-Orient, Afrique du Nord) 
##                                               135 
##                Asiatique / insulaire du Pacifique 
##                                              2661 
##                                             Autre 
##                                               129 
##                            Blanc(che) / Caucasien 
##                                             17154 
##                 Hispanique / Latino / Espagnol(e) 
##                                               933 
##                              Indien / Pakistanais 
##                                               330 
##                        Je préfère ne pas répondre 
##                                               639 
##                                            Jewish 
##                                                16 
##                    Mixed / Mixed race / Bi-racial 
##                                               171 
##         Noir(e) / Africain(e) / Afro-Américain(e) 
##                                              1654
```

```r
ibiccs_clean <- ibiccs_clean %>%
  mutate(ethnicity = case_when(
    q47 == "Amérindien des États-Unis / Autochtone d'Amérique" ~ "Native American",
    q47 == "Arabe (Moyen-Orient, Afrique du Nord)" ~ "Other",
    q47 == "Asiatique / insulaire du Pacifique" ~ "Asian",
    q47 == "Autre" ~ "Other",
    q47 == "Blanc(che) / Caucasien" ~ "Causcasian",
    q47 == "Hispanique / Latino / Espagnol(e)" ~ "Hispanic",
    q47 == "Indien / Pakistanais" ~ "Other",
    q47 == "Jewish" ~ "Other",
    q47 == "Mixed / Mixed race / Bi-racial" ~ "Other",
    q47 == "Noir(e) / Africain(e) / Afro-Américain(e)" ~ "African American",
    q47 == "Je préfère ne pas répondre" ~ "Refuse",
    TRUE ~ "NA"
  ))
table(ibiccs_clean$q47, ibiccs_clean$ethnicity)
```

```
##                                                    
##                                                     African American Asian
##   Amérindien des États-Unis / Autochtone d'Amérique                0     0
##   Arabe (Moyen-Orient, Afrique du Nord)                            0     0
##   Asiatique / insulaire du Pacifique                               0  2661
##   Autre                                                            0     0
##   Blanc(che) / Caucasien                                           0     0
##   Hispanique / Latino / Espagnol(e)                                0     0
##   Indien / Pakistanais                                             0     0
##   Je préfère ne pas répondre                                       0     0
##   Jewish                                                           0     0
##   Mixed / Mixed race / Bi-racial                                   0     0
##   Noir(e) / Africain(e) / Afro-Américain(e)                     1654     0
##                                                    
##                                                     Causcasian Hispanic
##   Amérindien des États-Unis / Autochtone d'Amérique          0        0
##   Arabe (Moyen-Orient, Afrique du Nord)                      0        0
##   Asiatique / insulaire du Pacifique                         0        0
##   Autre                                                      0        0
##   Blanc(che) / Caucasien                                 17154        0
##   Hispanique / Latino / Espagnol(e)                          0      933
##   Indien / Pakistanais                                       0        0
##   Je préfère ne pas répondre                                 0        0
##   Jewish                                                     0        0
##   Mixed / Mixed race / Bi-racial                             0        0
##   Noir(e) / Africain(e) / Afro-Américain(e)                  0        0
##                                                    
##                                                     Native American Other
##   Amérindien des États-Unis / Autochtone d'Amérique              79     0
##   Arabe (Moyen-Orient, Afrique du Nord)                           0   135
##   Asiatique / insulaire du Pacifique                              0     0
##   Autre                                                           0   129
##   Blanc(che) / Caucasien                                          0     0
##   Hispanique / Latino / Espagnol(e)                               0     0
##   Indien / Pakistanais                                            0   330
##   Je préfère ne pas répondre                                      0     0
##   Jewish                                                          0    16
##   Mixed / Mixed race / Bi-racial                                  0   171
##   Noir(e) / Africain(e) / Afro-Américain(e)                       0     0
##                                                    
##                                                     Refuse
##   Amérindien des États-Unis / Autochtone d'Amérique      0
##   Arabe (Moyen-Orient, Afrique du Nord)                  0
##   Asiatique / insulaire du Pacifique                     0
##   Autre                                                  0
##   Blanc(che) / Caucasien                                 0
##   Hispanique / Latino / Espagnol(e)                      0
##   Indien / Pakistanais                                   0
##   Je préfère ne pas répondre                           639
##   Jewish                                                 0
##   Mixed / Mixed race / Bi-racial                         0
##   Noir(e) / Africain(e) / Afro-Américain(e)              0
```

# Recode Country Born

```r
table(ibiccs_clean$q48)
```

```
## 
##     1     2     3     4     5     6     7     8     9    10    11    12 
##  7171 13175   246    11    11    20    29    49    20    28    14    17 
##    13    14    15    16    17    18    19    20    21    22    23    24 
##    15    12   109   153   104   231   166    39     7    22    77    43 
##    25    26    27    28    29    30    31    32    33    34    35    36 
##    73    28    21    57    27    18    93    63    44    48    66    33 
##    37    38    39    40    41    42    43    44    45    46    47    48 
##    33    23    25    24   159    51    27    43     8    15     4    40 
##    49    50    51    52    53    54    55    56    57    58    59    60 
##     5    26    14    11    20    11    13    34     3    18    13    13 
##    61    62    63    64    65    66    67    68    69    70    71    72 
##    12     9    33    24    13    15    20     9     6    13    10     3 
##    73    74    75    76    77    78    79    80    81    96    99 
##    16     8     4     5    19    12     6     9    13   196   473
```

```r
ibiccs_clean <- ibiccs_clean %>%
  mutate(country_born = case_when(
    q48 == 1 ~ "Canada",
    q48 == 2 ~ "United States",
    q48 >= 3 ~ "Other", 
    q48 <= 81 ~ "Other",
    q48 == 96 ~ "Other",
    q48 == 99 ~ "Refuse",
    TRUE ~ "NA"
  ))
table(ibiccs_clean$q48, ibiccs_clean$country_born)
```

```
##     
##      Canada Other United States
##   1    7171     0             0
##   2       0     0         13175
##   3       0   246             0
##   4       0    11             0
##   5       0    11             0
##   6       0    20             0
##   7       0    29             0
##   8       0    49             0
##   9       0    20             0
##   10      0    28             0
##   11      0    14             0
##   12      0    17             0
##   13      0    15             0
##   14      0    12             0
##   15      0   109             0
##   16      0   153             0
##   17      0   104             0
##   18      0   231             0
##   19      0   166             0
##   20      0    39             0
##   21      0     7             0
##   22      0    22             0
##   23      0    77             0
##   24      0    43             0
##   25      0    73             0
##   26      0    28             0
##   27      0    21             0
##   28      0    57             0
##   29      0    27             0
##   30      0    18             0
##   31      0    93             0
##   32      0    63             0
##   33      0    44             0
##   34      0    48             0
##   35      0    66             0
##   36      0    33             0
##   37      0    33             0
##   38      0    23             0
##   39      0    25             0
##   40      0    24             0
##   41      0   159             0
##   42      0    51             0
##   43      0    27             0
##   44      0    43             0
##   45      0     8             0
##   46      0    15             0
##   47      0     4             0
##   48      0    40             0
##   49      0     5             0
##   50      0    26             0
##   51      0    14             0
##   52      0    11             0
##   53      0    20             0
##   54      0    11             0
##   55      0    13             0
##   56      0    34             0
##   57      0     3             0
##   58      0    18             0
##   59      0    13             0
##   60      0    13             0
##   61      0    12             0
##   62      0     9             0
##   63      0    33             0
##   64      0    24             0
##   65      0    13             0
##   66      0    15             0
##   67      0    20             0
##   68      0     9             0
##   69      0     6             0
##   70      0    13             0
##   71      0    10             0
##   72      0     3             0
##   73      0    16             0
##   74      0     8             0
##   75      0     4             0
##   76      0     5             0
##   77      0    19             0
##   78      0    12             0
##   79      0     6             0
##   80      0     9             0
##   81      0    13             0
##   96      0   196             0
##   99      0   473             0
```

# Recode Motor Vehicle Access

```r
table(ibiccs_clean$q50)
```

```
## 
## Ne sais pas/Ne s'applique pas                           Non 
##                           230                          6295 
##                           Oui 
##                         17376
```

```r
ibiccs_clean <- ibiccs_clean %>%
  mutate(motor_vehicle_access = case_when(
    q50 == "Non" ~ "No",
    q50 == "Oui" ~ "Yes"
  ))
table(ibiccs_clean$q50, ibiccs_clean$motor_vehicle_access)
```

```
##                                
##                                    No   Yes
##   Ne sais pas/Ne s'applique pas     0     0
##   Non                            6295     0
##   Oui                               0 17376
```

# Recode Education Level

```r
table(ibiccs_clean$q51)
```

```
## 
##                  Aucun grade, certificat ou diplôme 
##                                                  32 
##                                   Autre (précisez): 
##                                                  81 
##                                        Baccalauréat 
##                                                8638 
##                                               Cégep 
##                                                3197 
## Certificat d'école de métier, certificat ou diplôme 
##                                                2559 
##         Diplôme d'études secondaire ou l'équivalent 
##                                                2471 
##     Diplôme universitaire supérieur au baccalauréat 
##                                                6655 
##                                      École primaire 
##                                                  88 
##                                  Refuse de répondre 
##                                                 180
```

```r
ibiccs_clean <- ibiccs_clean %>%
  mutate(education = case_when(
    q51 == "Aucun grade, certificat ou diplôme" ~ "High School/Lower",
    q51 == "Baccalauréat" ~ "Baccalaureate",
    q51 == "Cégep" ~ "Cégep",
    q51 == "Certificat d'école de métier, certificat ou diplôme" ~ "Certificate/Diploma",
    q51 == "Diplôme d'études secondaire ou l'équivalent" ~ "High School/Lower",
    q51 == "Diplôme universitaire supérieur au baccalauréat" ~ "Graduate School",
    q51 == "École primaire" ~ "High School/Lower"
  ))
table(ibiccs_clean$q51, ibiccs_clean$education)
```

```
##                                                      
##                                                       Baccalaureate Cégep
##   Aucun grade, certificat ou diplôme                              0     0
##   Autre (précisez):                                               0     0
##   Baccalauréat                                                 8638     0
##   Cégep                                                           0  3197
##   Certificat d'école de métier, certificat ou diplôme             0     0
##   Diplôme d'études secondaire ou l'équivalent                     0     0
##   Diplôme universitaire supérieur au baccalauréat                 0     0
##   École primaire                                                  0     0
##   Refuse de répondre                                              0     0
##                                                      
##                                                       Certificate/Diploma
##   Aucun grade, certificat ou diplôme                                    0
##   Autre (précisez):                                                     0
##   Baccalauréat                                                          0
##   Cégep                                                                 0
##   Certificat d'école de métier, certificat ou diplôme                2559
##   Diplôme d'études secondaire ou l'équivalent                           0
##   Diplôme universitaire supérieur au baccalauréat                       0
##   École primaire                                                        0
##   Refuse de répondre                                                    0
##                                                      
##                                                       Graduate School
##   Aucun grade, certificat ou diplôme                                0
##   Autre (précisez):                                                 0
##   Baccalauréat                                                      0
##   Cégep                                                             0
##   Certificat d'école de métier, certificat ou diplôme               0
##   Diplôme d'études secondaire ou l'équivalent                       0
##   Diplôme universitaire supérieur au baccalauréat                6655
##   École primaire                                                    0
##   Refuse de répondre                                                0
##                                                      
##                                                       High School/Lower
##   Aucun grade, certificat ou diplôme                                 32
##   Autre (précisez):                                                   0
##   Baccalauréat                                                        0
##   Cégep                                                               0
##   Certificat d'école de métier, certificat ou diplôme                 0
##   Diplôme d'études secondaire ou l'équivalent                      2471
##   Diplôme universitaire supérieur au baccalauréat                     0
##   École primaire                                                     88
##   Refuse de répondre                                                  0
```

# Recode Occupation Status

```r
table(ibiccs_clean$Q52_occupational_status_category)
```

```
## 
##                  Disability  Full time or Self-employed 
##                         453                       15373 
## Homemaker or parental leave                   Part time 
##                         983                        1899 
##                     Retired                     Student 
##                        2434                        1586 
##     Unemployed seeking work 
##                         977
```

```r
ibiccs_clean <- ibiccs_clean %>%
  mutate(occupation_status = case_when(
    Q52_occupational_status_category == "Disability" ~ "Unemployed",
    Q52_occupational_status_category == "Full time or Self-employed" ~ "Employed",
    Q52_occupational_status_category == "Homemaker or parental leave" ~ "Unemployed",
    Q52_occupational_status_category == "Part time" ~ "Employed",
    Q52_occupational_status_category == "Retired" ~ "Unemployed",
    Q52_occupational_status_category == "Student" ~ "Student",
    Q52_occupational_status_category == "Unemployed seeking work" ~ "Unemployed"
  ))
table(ibiccs_clean$Q52_occupational_status_category, ibiccs_clean$occupation_status)
```

```
##                              
##                               Employed Student Unemployed
##   Disability                         0       0        453
##   Full time or Self-employed     15373       0          0
##   Homemaker or parental leave        0       0        983
##   Part time                       1899       0          0
##   Retired                            0       0       2434
##   Student                            0    1586          0
##   Unemployed seeking work            0       0        977
```

# Recode Household Income

```r
table(ibiccs_clean$q53)
```

```
## 
##   Entre 10000 $ and 19999 $ par année 
##                                  1084 
## Entre 100000 $ and 149999 $ par année 
##                                  3490 
## Entre 150000 $ and 199999 $ par année 
##                                  1296 
##   Entre 20000 $ and 34999 $ par année 
##                                  2061 
##   Entre 35000 $ and 49999 $ par année 
##                                  2700 
##   Entre 50000 $ and 74999 $ par année 
##                                  4396 
##   Entre 75000 $ and 99999 $ par année 
##                                  3425 
##            Moins de 10000 $ par année 
##                                  1366 
##            Plus de 200000 $ par année 
##                                  1104 
##                    Refuse de répondre 
##                                  2979
```

```r
ibiccs_clean <- ibiccs_clean %>%
  mutate(household_income = case_when(
    q53 == "Moins de 10000 $ par année" ~ "$0-$19999",
    q53 == "Entre 10000 $ and 19999 $ par année" ~ "$0-$19999",
    q53 == "Entre 20000 $ and 34999 $ par année" ~ "$20000-$49999",
    q53 == "Entre 35000 $ and 49999 $ par année" ~ "$20000-$49999",
    q53 == "Entre 50000 $ and 74999 $ par année" ~ "$50000-$74999",
    q53 == "Entre 75000 $ and 99999 $ par année" ~ "$75000-$99999",
    q53 == "Entre 100000 $ and 149999 $ par année" ~ "$100000-149999",
    q53 == "Entre 150000 $ and 199999 $ par année" ~ "$150000+",
    q53 == "Plus de 200000 $ par année" ~ "$150000+"
  ))
table(ibiccs_clean$q53, ibiccs_clean$household_income)
```

```
##                                        
##                                         $0-$19999 $100000-149999 $150000+
##   Entre 10000 $ and 19999 $ par année        1084              0        0
##   Entre 100000 $ and 149999 $ par année         0           3490        0
##   Entre 150000 $ and 199999 $ par année         0              0     1296
##   Entre 20000 $ and 34999 $ par année           0              0        0
##   Entre 35000 $ and 49999 $ par année           0              0        0
##   Entre 50000 $ and 74999 $ par année           0              0        0
##   Entre 75000 $ and 99999 $ par année           0              0        0
##   Moins de 10000 $ par année                 1366              0        0
##   Plus de 200000 $ par année                    0              0     1104
##   Refuse de répondre                            0              0        0
##                                        
##                                         $20000-$49999 $50000-$74999
##   Entre 10000 $ and 19999 $ par année               0             0
##   Entre 100000 $ and 149999 $ par année             0             0
##   Entre 150000 $ and 199999 $ par année             0             0
##   Entre 20000 $ and 34999 $ par année            2061             0
##   Entre 35000 $ and 49999 $ par année            2700             0
##   Entre 50000 $ and 74999 $ par année               0          4396
##   Entre 75000 $ and 99999 $ par année               0             0
##   Moins de 10000 $ par année                        0             0
##   Plus de 200000 $ par année                        0             0
##   Refuse de répondre                                0             0
##                                        
##                                         $75000-$99999
##   Entre 10000 $ and 19999 $ par année               0
##   Entre 100000 $ and 149999 $ par année             0
##   Entre 150000 $ and 199999 $ par année             0
##   Entre 20000 $ and 34999 $ par année               0
##   Entre 35000 $ and 49999 $ par année               0
##   Entre 50000 $ and 74999 $ par année               0
##   Entre 75000 $ and 99999 $ par année            3425
##   Moins de 10000 $ par année                        0
##   Plus de 200000 $ par année                        0
##   Refuse de répondre                                0
```

# Filtering Out Cities

```r
Boston <- filter(ibiccs_clean, ville == "Boston")
Chicago <- filter(ibiccs_clean, ville == "Chicago")
Detroit <- filter(ibiccs_clean, ville == "Détroit")
NewYork <- filter(ibiccs_clean, ville == "New-York")
Philadelphia <- filter(ibiccs_clean, ville == "Philadelphie")
Montreal <- filter(ibiccs_clean, ville == "Montréal")
Toronto <- filter(ibiccs_clean, ville == "Toronto")
Vancouver <- filter(ibiccs_clean, ville == "Vancouver")
```

# Filtering Out Variables in Clean Data & Filtering Cities

```r
vars_clean <- c('language', 'ville', 'gender', 'health', 'common_transportation', 'physically_active', 'pa_level', 'day_per_week_motor_vehicle', 'day_per_week_public_transit', 'day_per_week_walking', 'day_per_week_bike', 'q42', 'marital_status', 'children_household', 'ethnicity', 'country_born', 'motor_vehicle_access', 'education', 'occupation_status', 'household_income', 'bmi', 'bmi_category', 'WalkScore', 'WalkScoreLabel', 'TransitScore', 'TransitScoreLabel', 'BikeScore', 'BikeScoreLabel', 'DiningandDrinkingScore', 'GroceryScore')

ibiccs <- dplyr::select(ibiccs_clean, vars_clean)
Boston <- dplyr::select(Boston, vars_clean)
Chicago <- dplyr::select(Chicago, vars_clean)
Detroit <- dplyr::select(Detroit, vars_clean)
NewYork <- dplyr::select(NewYork, vars_clean)
Philadelphia <- dplyr::select(Philadelphia, vars_clean)
Montreal <- dplyr::select(Montreal, vars_clean)
Toronto <- dplyr::select(Toronto, vars_clean)
Vancouver <- dplyr::select(Vancouver, vars_clean)
city <- rbind(Philadelphia, NewYork, Detroit, Chicago, Boston, Montreal, Toronto, Vancouver)
```

# Binding by Country

```r
city_USA <- rbind(Philadelphia, NewYork, Detroit, Chicago, Boston)
city_CAN <- rbind(Montreal, Toronto, Vancouver)
```


#Tables for Each City and Combined

```r
vars <- c('language', 'ville', 'gender', 'health', 'common_transportation', 'physically_active', 'pa_level', 'day_per_week_motor_vehicle', 'day_per_week_public_transit', 'day_per_week_walking', 'day_per_week_bike', 'q42', 'marital_status', 'children_household', 'ethnicity', 'country_born', 'motor_vehicle_access', 'education', 'occupation_status', 'household_income', 'bmi', 'bmi_category', 'WalkScore', 'WalkScoreLabel', 'TransitScore', 'TransitScoreLabel', 'BikeScore', 'BikeScoreLabel', 'DiningandDrinkingScore', 'GroceryScore')
CreateTableOne(vars = vars, strata = "ville", data = ibiccs)
```

```
##                                          Stratified by ville
##                                           Boston          Chicago       
##   n                                         1977           4085         
##   language = Fren/Span (%)                     3 (  0.2)     20 (  0.5) 
##   ville (%)                                                             
##      Boston                                 1977 (100.0)      0 (  0.0) 
##      Chicago                                   0 (  0.0)   4085 (100.0) 
##      Détroit                                   0 (  0.0)      0 (  0.0) 
##      Montréal                                  0 (  0.0)      0 (  0.0) 
##      New-York                                  0 (  0.0)      0 (  0.0) 
##      Philadelphie                              0 (  0.0)      0 (  0.0) 
##      Toronto                                   0 (  0.0)      0 (  0.0) 
##      Vancouver                                 0 (  0.0)      0 (  0.0) 
##   gender = Male (%)                          694 ( 35.1)   1628 ( 39.9) 
##   health (%)                                                            
##      Excellent                              1285 ( 65.2)   2559 ( 62.8) 
##      Good                                    521 ( 26.4)   1105 ( 27.1) 
##      Poor                                    166 (  8.4)    412 ( 10.1) 
##   common_transportation (%)                                             
##      Bicycle                                 104 (  5.3)    170 (  4.2) 
##      Car                                     685 ( 34.7)   1803 ( 44.3) 
##      Other                                    16 (  0.8)     48 (  1.2) 
##      Public Transportation                   669 ( 33.9)   1473 ( 36.2) 
##      Walking                                 500 ( 25.3)    576 ( 14.2) 
##   physically_active = Yes (%)               1703 ( 87.0)   3418 ( 84.5) 
##   pa_level (%)                                                          
##      Low                                     132 (  6.7)    285 (  7.0) 
##      Moderate                                837 ( 42.3)   1712 ( 41.9) 
##      NA                                      317 ( 16.0)    743 ( 18.2) 
##      Sedentary                                 2 (  0.1)      4 (  0.1) 
##      Vigorous                                689 ( 34.9)   1341 ( 32.8) 
##   day_per_week_motor_vehicle (mean (SD))    3.68 (2.47)    4.08 (2.35)  
##   day_per_week_public_transit (mean (SD))   2.95 (2.37)    2.77 (2.36)  
##   day_per_week_walking (mean (SD))          4.62 (2.25)    4.10 (2.30)  
##   day_per_week_bike (mean (SD))             0.87 (1.74)    0.84 (1.58)  
##   q42 (mean (SD))                          37.21 (13.86)  39.59 (12.73) 
##   marital_status = Single (%)               1025 ( 57.8)   1844 ( 50.5) 
##   children_household (mean (SD))            0.25 (0.62)    0.37 (0.77)  
##   ethnicity (%)                                                         
##      African American                        110 (  5.6)    449 ( 11.0) 
##      Asian                                   218 ( 11.0)    313 (  7.7) 
##      Causcasian                             1480 ( 74.9)   2863 ( 70.1) 
##      Hispanic                                 67 (  3.4)    300 (  7.3) 
##      Native American                           7 (  0.4)      8 (  0.2) 
##      Other                                    49 (  2.5)     72 (  1.8) 
##      Refuse                                   46 (  2.3)     80 (  2.0) 
##   country_born (%)                                                      
##      Canada                                   21 (  1.1)     31 (  0.8) 
##      Other                                   220 ( 11.1)    342 (  8.4) 
##      United States                          1736 ( 87.8)   3712 ( 90.9) 
##   motor_vehicle_access = Yes (%)            1442 ( 73.5)   3266 ( 80.5) 
##   education (%)                                                         
##      Baccalaureate                           757 ( 38.6)   1624 ( 40.1) 
##      Cégep                                   231 ( 11.8)    495 ( 12.2) 
##      Certificate/Diploma                      65 (  3.3)    293 (  7.2) 
##      Graduate School                         774 ( 39.5)   1320 ( 32.6) 
##      High School/Lower                       132 (  6.7)    317 (  7.8) 
##   occupation_status (%)                                                 
##      Employed                               1442 ( 73.5)   3160 ( 78.0) 
##      Student                                 272 ( 13.9)    271 (  6.7) 
##      Unemployed                              249 ( 12.7)    622 ( 15.3) 
##   household_income (%)                                                  
##      $0-$19999                               210 ( 12.0)    436 ( 11.8) 
##      $100000-149999                          304 ( 17.4)    617 ( 16.6) 
##      $150000+                                232 ( 13.2)    438 ( 11.8) 
##      $20000-$49999                           389 ( 22.2)    812 ( 21.9) 
##      $50000-$74999                           342 ( 19.5)    799 ( 21.6) 
##      $75000-$99999                           275 ( 15.7)    604 ( 16.3) 
##   bmi (mean (SD))                          25.06 (4.59)   25.89 (4.86)  
##   bmi_category (%)                                                      
##      normal weight                           982 ( 49.7)   1745 ( 42.7) 
##      obese                                   248 ( 12.5)    698 ( 17.1) 
##      other                                   192 (  9.7)    438 ( 10.7) 
##      overweight                              511 ( 25.8)   1139 ( 27.9) 
##      underweight                              44 (  2.2)     65 (  1.6) 
##   WalkScore (mean (SD))                    86.19 (17.12)  80.36 (17.45) 
##   WalkScoreLabel (%)                                                    
##                                               38 (  1.9)     51 (  1.2) 
##      Car-Dependent                            96 (  4.9)    274 (  6.7) 
##      Somewhat Walkable                        85 (  4.3)    510 ( 12.5) 
##      Very Walkable                           598 ( 30.2)   1680 ( 41.1) 
##      Walker's Paradise                      1160 ( 58.7)   1570 ( 38.4) 
##   TransitScore (mean (SD))                 73.62 (16.68)  77.05 (11.31) 
##   TransitScoreLabel (%)                                                 
##                                             1694 ( 85.7)   3713 ( 90.9) 
##      Excellent Transit                       201 ( 10.2)    277 (  6.8) 
##      Good Transit                             64 (  3.2)     82 (  2.0) 
##      Minimal Transit                           0 (  0.0)      0 (  0.0) 
##      Rider's Paradise                         16 (  0.8)     13 (  0.3) 
##      Some Transit                              2 (  0.1)      0 (  0.0) 
##   BikeScore (mean (SD))                   106.50 (32.02)  87.29 (29.96) 
##   BikeScoreLabel (%)                                                    
##                                              598 ( 30.2)    558 ( 13.7) 
##      Bikeable                                475 ( 24.0)   1113 ( 27.2) 
##      Biker's Paradise                        323 ( 16.3)      0 (  0.0) 
##      Somewhat Bikeable                        26 (  1.3)    264 (  6.5) 
##      Very Bikeable                           555 ( 28.1)   2150 ( 52.6) 
##   DiningandDrinkingScore (mean (SD))       86.12 (17.23)  82.41 (18.59) 
##   GroceryScore (mean (SD))                 88.94 (21.26)  78.71 (28.21) 
##                                          Stratified by ville
##                                           Détroit         Montréal      
##   n                                         3077           2678         
##   language = Fren/Span (%)                     3 (  0.1)   1617 ( 60.4) 
##   ville (%)                                                             
##      Boston                                    0 (  0.0)      0 (  0.0) 
##      Chicago                                   0 (  0.0)      0 (  0.0) 
##      Détroit                                3077 (100.0)      0 (  0.0) 
##      Montréal                                  0 (  0.0)   2678 (100.0) 
##      New-York                                  0 (  0.0)      0 (  0.0) 
##      Philadelphie                              0 (  0.0)      0 (  0.0) 
##      Toronto                                   0 (  0.0)      0 (  0.0) 
##      Vancouver                                 0 (  0.0)      0 (  0.0) 
##   gender = Male (%)                         1134 ( 36.9)   1159 ( 43.3) 
##   health (%)                                                            
##      Excellent                              1758 ( 57.2)   1501 ( 56.1) 
##      Good                                    928 ( 30.2)    791 ( 29.6) 
##      Poor                                    390 ( 12.7)    383 ( 14.3) 
##   common_transportation (%)                                             
##      Bicycle                                  75 (  2.5)    207 (  7.8) 
##      Car                                    2718 ( 89.2)    914 ( 34.3) 
##      Other                                    11 (  0.4)     29 (  1.1) 
##      Public Transportation                   105 (  3.4)   1019 ( 38.3) 
##      Walking                                 139 (  4.6)    492 ( 18.5) 
##   physically_active = Yes (%)               2355 ( 77.6)   2107 ( 80.0) 
##   pa_level (%)                                                          
##      Low                                     242 (  7.9)    160 (  6.0) 
##      Moderate                               1246 ( 40.5)   1335 ( 49.9) 
##      NA                                      776 ( 25.2)    647 ( 24.2) 
##      Sedentary                                11 (  0.4)      3 (  0.1) 
##      Vigorous                                802 ( 26.1)    533 ( 19.9) 
##   day_per_week_motor_vehicle (mean (SD))    5.75 (1.74)    3.24 (2.47)  
##   day_per_week_public_transit (mean (SD))   0.58 (1.55)    2.63 (2.39)  
##   day_per_week_walking (mean (SD))          2.32 (2.37)    3.96 (2.32)  
##   day_per_week_bike (mean (SD))             0.65 (1.43)    0.89 (1.67)  
##   q42 (mean (SD))                          41.11 (12.74)  47.02 (14.17) 
##   marital_status = Single (%)                988 ( 36.6)    906 ( 40.5) 
##   children_household (mean (SD))            0.60 (0.92)    0.31 (0.68)  
##   ethnicity (%)                                                         
##      African American                        361 ( 11.7)     52 (  1.9) 
##      Asian                                   123 (  4.0)    104 (  3.9) 
##      Causcasian                             2422 ( 78.7)   2301 ( 85.9) 
##      Hispanic                                 44 (  1.4)     50 (  1.9) 
##      Native American                          15 (  0.5)      8 (  0.3) 
##      Other                                    61 (  2.0)     97 (  3.6) 
##      Refuse                                   51 (  1.7)     66 (  2.5) 
##   country_born (%)                                                      
##      Canada                                   38 (  1.2)   2144 ( 80.1) 
##      Other                                   172 (  5.6)    500 ( 18.7) 
##      United States                          2867 ( 93.2)     34 (  1.3) 
##   motor_vehicle_access = Yes (%)            2936 ( 96.0)   1821 ( 68.5) 
##   education (%)                                                         
##      Baccalaureate                           951 ( 31.2)    788 ( 29.8) 
##      Cégep                                   506 ( 16.6)    528 ( 19.9) 
##      Certificate/Diploma                     444 ( 14.6)    330 ( 12.5) 
##      Graduate School                         736 ( 24.1)    581 ( 21.9) 
##      High School/Lower                       411 ( 13.5)    421 ( 15.9) 
##   occupation_status (%)                                                 
##      Employed                               2152 ( 70.4)   1750 ( 65.8) 
##      Student                                 243 (  7.9)    141 (  5.3) 
##      Unemployed                              663 ( 21.7)    769 ( 28.9) 
##   household_income (%)                                                  
##      $0-$19999                               412 ( 15.2)    286 ( 12.3) 
##      $100000-149999                          443 ( 16.3)    271 ( 11.7) 
##      $150000+                                193 (  7.1)    148 (  6.4) 
##      $20000-$49999                           666 ( 24.6)    731 ( 31.5) 
##      $50000-$74999                           536 ( 19.8)    523 ( 22.5) 
##      $75000-$99999                           461 ( 17.0)    365 ( 15.7) 
##   bmi (mean (SD))                          26.75 (5.11)   25.88 (4.65)  
##   bmi_category (%)                                                      
##      normal weight                          1073 ( 34.9)   1122 ( 41.9) 
##      obese                                   661 ( 21.5)    454 ( 17.0) 
##      other                                   439 ( 14.3)    321 ( 12.0) 
##      overweight                              864 ( 28.1)    746 ( 27.9) 
##      underweight                              40 (  1.3)     35 (  1.3) 
##   WalkScore (mean (SD))                    36.05 (24.44)  81.88 (16.05) 
##   WalkScoreLabel (%)                                                    
##                                               27 (  0.9)     28 (  1.0) 
##      Car-Dependent                          2094 ( 68.1)    135 (  5.0) 
##      Somewhat Walkable                       733 ( 23.8)    303 ( 11.3) 
##      Very Walkable                           175 (  5.7)   1117 ( 41.7) 
##      Walker's Paradise                        48 (  1.6)   1095 ( 40.9) 
##   TransitScore (mean (SD))                 79.31 (7.37)   13.38 (18.57) 
##   TransitScoreLabel (%)                                                 
##                                             3077 (100.0)     45 (  1.7) 
##      Excellent Transit                         0 (  0.0)     71 (  2.7) 
##      Good Transit                              0 (  0.0)    485 ( 18.1) 
##      Minimal Transit                           0 (  0.0)     43 (  1.6) 
##      Rider's Paradise                          0 (  0.0)   1911 ( 71.4) 
##      Some Transit                              0 (  0.0)    123 (  4.6) 
##   BikeScore (mean (SD))                   133.74 (18.39)  86.99 (43.07) 
##   BikeScoreLabel (%)                                                    
##                                             2898 ( 94.2)    624 ( 23.3) 
##      Bikeable                                 90 (  2.9)    719 ( 26.8) 
##      Biker's Paradise                         40 (  1.3)    496 ( 18.5) 
##      Somewhat Bikeable                         1 (  0.0)     83 (  3.1) 
##      Very Bikeable                            48 (  1.6)    756 ( 28.2) 
##   DiningandDrinkingScore (mean (SD))       40.56 (26.92)  82.34 (17.58) 
##   GroceryScore (mean (SD))                 38.81 (34.49)  89.47 (17.42) 
##                                          Stratified by ville
##                                           New-York       Philadelphie   
##   n                                        3824            1478         
##   language = Fren/Span (%)                   16 (  0.4)       3 (  0.2) 
##   ville (%)                                                             
##      Boston                                   0 (  0.0)       0 (  0.0) 
##      Chicago                                  0 (  0.0)       0 (  0.0) 
##      Détroit                                  0 (  0.0)       0 (  0.0) 
##      Montréal                                 0 (  0.0)       0 (  0.0) 
##      New-York                              3824 (100.0)       0 (  0.0) 
##      Philadelphie                             0 (  0.0)    1478 (100.0) 
##      Toronto                                  0 (  0.0)       0 (  0.0) 
##      Vancouver                                0 (  0.0)       0 (  0.0) 
##   gender = Male (%)                        1593 ( 41.7)     536 ( 36.3) 
##   health (%)                                                            
##      Excellent                             2537 ( 66.4)     928 ( 62.9) 
##      Good                                   986 ( 25.8)     404 ( 27.4) 
##      Poor                                   295 (  7.7)     144 (  9.8) 
##   common_transportation (%)                                             
##      Bicycle                                184 (  4.8)      87 (  5.9) 
##      Car                                    360 (  9.4)     606 ( 41.1) 
##      Other                                   83 (  2.2)      17 (  1.2) 
##      Public Transportation                 2207 ( 57.9)     321 ( 21.8) 
##      Walking                                978 ( 25.7)     443 ( 30.1) 
##   physically_active = Yes (%)              3088 ( 82.0)    1193 ( 81.5) 
##   pa_level (%)                                                          
##      Low                                    236 (  6.2)      99 (  6.7) 
##      Moderate                              1578 ( 41.3)     627 ( 42.4) 
##      NA                                     809 ( 21.2)     312 ( 21.1) 
##      Sedentary                                2 (  0.1)       0 (  0.0) 
##      Vigorous                              1199 ( 31.4)     440 ( 29.8) 
##   day_per_week_motor_vehicle (mean (SD))   2.26 (2.21)     3.85 (2.41)  
##   day_per_week_public_transit (mean (SD))  4.17 (2.16)     2.32 (2.22)  
##   day_per_week_walking (mean (SD))         5.15 (2.00)     4.32 (2.31)  
##   day_per_week_bike (mean (SD))            0.89 (1.63)     0.98 (1.76)  
##   q42 (mean (SD))                         39.74 (13.55)   39.19 (13.51) 
##   marital_status = Single (%)              1879 ( 54.7)     729 ( 55.6) 
##   children_household (mean (SD))           0.33 (0.70)     0.38 (0.77)  
##   ethnicity (%)                                                         
##      African American                       336 (  8.8)     231 ( 15.6) 
##      Asian                                  483 ( 12.6)     128 (  8.7) 
##      Causcasian                            2493 ( 65.2)     999 ( 67.6) 
##      Hispanic                               317 (  8.3)      60 (  4.1) 
##      Native American                          9 (  0.2)       0 (  0.0) 
##      Other                                   90 (  2.4)      38 (  2.6) 
##      Refuse                                  96 (  2.5)      22 (  1.5) 
##   country_born (%)                                                      
##      Canada                                  50 (  1.3)       7 (  0.5) 
##      Other                                  497 ( 13.0)      94 (  6.4) 
##      United States                         3277 ( 85.7)    1377 ( 93.2) 
##   motor_vehicle_access = Yes (%)           1671 ( 44.2)    1109 ( 75.9) 
##   education (%)                                                         
##      Baccalaureate                         1589 ( 41.8)     509 ( 34.9) 
##      Cégep                                  466 ( 12.3)     206 ( 14.1) 
##      Certificate/Diploma                    168 (  4.4)      86 (  5.9) 
##      Graduate School                       1284 ( 33.8)     447 ( 30.6) 
##      High School/Lower                      294 (  7.7)     212 ( 14.5) 
##   occupation_status (%)                                                 
##      Employed                              2943 ( 77.7)    1049 ( 71.3) 
##      Student                                270 (  7.1)     172 ( 11.7) 
##      Unemployed                             574 ( 15.2)     251 ( 17.1) 
##   household_income (%)                                                  
##      $0-$19999                              397 ( 11.7)     227 ( 16.8) 
##      $100000-149999                         631 ( 18.6)     182 ( 13.5) 
##      $150000+                               598 ( 17.7)     124 (  9.2) 
##      $20000-$49999                          605 ( 17.9)     335 ( 24.8) 
##      $50000-$74999                          611 ( 18.0)     301 ( 22.3) 
##      $75000-$99999                          545 ( 16.1)     182 ( 13.5) 
##   bmi (mean (SD))                         25.05 (4.52)    26.02 (4.97)  
##   bmi_category (%)                                                      
##      normal weight                         1841 ( 48.1)     618 ( 41.8) 
##      obese                                  490 ( 12.8)     273 ( 18.5) 
##      other                                  450 ( 11.8)     164 ( 11.1) 
##      overweight                             971 ( 25.4)     404 ( 27.3) 
##      underweight                             72 (  1.9)      19 (  1.3) 
##   WalkScore (mean (SD))                   95.88 (11.04)   86.27 (17.72) 
##   WalkScoreLabel (%)                                                    
##                                              65 (  1.7)      22 (  1.5) 
##      Car-Dependent                           61 (  1.6)      83 (  5.6) 
##      Somewhat Walkable                       33 (  0.9)      96 (  6.5) 
##      Very Walkable                          169 (  4.4)     244 ( 16.5) 
##      Walker's Paradise                     3496 ( 91.4)    1033 ( 69.9) 
##   TransitScore (mean (SD))                71.19 (24.19)   73.31 (21.71) 
##   TransitScoreLabel (%)                                                 
##                                            3394 ( 88.8)    1371 ( 92.8) 
##      Excellent Transit                       34 (  0.9)       0 (  0.0) 
##      Good Transit                             7 (  0.2)       2 (  0.1) 
##      Minimal Transit                          0 (  0.0)       0 (  0.0) 
##      Rider's Paradise                       389 ( 10.2)     105 (  7.1) 
##      Some Transit                             0 (  0.0)       0 (  0.0) 
##   BikeScore (mean (SD))                   90.15 (24.92)  106.32 (30.52) 
##   BikeScoreLabel (%)                                                    
##                                             178 (  4.7)     148 ( 10.0) 
##      Bikeable                              1137 ( 29.7)     236 ( 16.0) 
##      Biker's Paradise                       145 (  3.8)     594 ( 40.2) 
##      Somewhat Bikeable                       71 (  1.9)      38 (  2.6) 
##      Very Bikeable                         2293 ( 60.0)     462 ( 31.3) 
##   DiningandDrinkingScore (mean (SD))      96.05 (11.20)   87.70 (16.44) 
##   GroceryScore (mean (SD))                97.91 (11.21)   90.43 (22.07) 
##                                          Stratified by ville
##                                           Toronto        Vancouver     
##   n                                        4264           2518         
##   language = Fren/Span (%)                    3 (  0.1)      0 (  0.0) 
##   ville (%)                                                            
##      Boston                                   0 (  0.0)      0 (  0.0) 
##      Chicago                                  0 (  0.0)      0 (  0.0) 
##      Détroit                                  0 (  0.0)      0 (  0.0) 
##      Montréal                                 0 (  0.0)      0 (  0.0) 
##      New-York                                 0 (  0.0)      0 (  0.0) 
##      Philadelphie                             0 (  0.0)      0 (  0.0) 
##      Toronto                               4264 (100.0)      0 (  0.0) 
##      Vancouver                                0 (  0.0)   2518 (100.0) 
##   gender = Male (%)                        1984 ( 46.5)   1131 ( 44.9) 
##   health (%)                                                           
##      Excellent                             2572 ( 60.4)   1404 ( 55.9) 
##      Good                                  1220 ( 28.7)    770 ( 30.6) 
##      Poor                                   464 ( 10.9)    339 ( 13.5) 
##   common_transportation (%)                                            
##      Bicycle                                231 (  5.4)    119 (  4.7) 
##      Car                                   1665 ( 39.2)   1245 ( 49.5) 
##      Other                                   42 (  1.0)     15 (  0.6) 
##      Public Transportation                 1459 ( 34.3)    633 ( 25.2) 
##      Walking                                853 ( 20.1)    503 ( 20.0) 
##   physically_active = Yes (%)              3493 ( 83.0)   2114 ( 85.0) 
##   pa_level (%)                                                         
##      Low                                    256 (  6.0)    137 (  5.4) 
##      Moderate                              2131 ( 50.0)   1305 ( 51.8) 
##      NA                                     871 ( 20.4)    474 ( 18.8) 
##      Sedentary                                3 (  0.1)      5 (  0.2) 
##      Vigorous                              1003 ( 23.5)    597 ( 23.7) 
##   day_per_week_motor_vehicle (mean (SD))   3.66 (2.41)    4.05 (2.32)  
##   day_per_week_public_transit (mean (SD))  2.68 (2.27)    2.22 (2.23)  
##   day_per_week_walking (mean (SD))         4.19 (2.25)    4.22 (2.26)  
##   day_per_week_bike (mean (SD))            0.95 (1.73)    0.78 (1.53)  
##   q42 (mean (SD))                         46.98 (14.52)  47.49 (14.51) 
##   marital_status = Single (%)              1345 ( 37.6)    736 ( 34.4) 
##   children_household (mean (SD))           0.31 (0.68)    0.36 (0.72)  
##   ethnicity (%)                                                        
##      African American                        96 (  2.3)     19 (  0.8) 
##      Asian                                  572 ( 13.4)    720 ( 28.6) 
##      Causcasian                            3065 ( 71.9)   1531 ( 60.8) 
##      Hispanic                                71 (  1.7)     24 (  1.0) 
##      Native American                         14 (  0.3)     18 (  0.7) 
##      Other                                  279 (  6.5)     95 (  3.8) 
##      Refuse                                 167 (  3.9)    111 (  4.4) 
##   country_born (%)                                                     
##      Canada                                3058 ( 71.7)   1822 ( 72.4) 
##      Other                                 1100 ( 25.8)    630 ( 25.0) 
##      United States                          106 (  2.5)     66 (  2.6) 
##   motor_vehicle_access = Yes (%)           3057 ( 72.7)   2074 ( 83.1) 
##   education (%)                                                        
##      Baccalaureate                         1543 ( 36.6)    877 ( 35.7) 
##      Cégep                                  451 ( 10.7)    314 ( 12.8) 
##      Certificate/Diploma                    746 ( 17.7)    427 ( 17.4) 
##      Graduate School                        995 ( 23.6)    518 ( 21.1) 
##      High School/Lower                      481 ( 11.4)    323 ( 13.1) 
##   occupation_status (%)                                                
##      Employed                              3051 ( 72.2)   1725 ( 69.4) 
##      Student                                134 (  3.2)     83 (  3.3) 
##      Unemployed                            1040 ( 24.6)    679 ( 27.3) 
##   household_income (%)                                                 
##      $0-$19999                              301 (  8.4)    181 (  8.7) 
##      $100000-149999                         673 ( 18.7)    369 ( 17.7) 
##      $150000+                               463 ( 12.8)    204 (  9.8) 
##      $20000-$49999                          768 ( 21.3)    455 ( 21.8) 
##      $50000-$74999                          780 ( 21.6)    504 ( 24.1) 
##      $75000-$99999                          619 ( 17.2)    374 ( 17.9) 
##   bmi (mean (SD))                         25.60 (4.46)   24.87 (4.27)  
##   bmi_category (%)                                                     
##      normal weight                         1843 ( 43.2)   1213 ( 48.2) 
##      obese                                  586 ( 13.7)    262 ( 10.4) 
##      other                                  498 ( 11.7)    239 (  9.5) 
##      overweight                            1276 ( 29.9)    747 ( 29.7) 
##      underweight                             61 (  1.4)     57 (  2.3) 
##   WalkScore (mean (SD))                   79.56 (18.77)  78.79 (19.52) 
##   WalkScoreLabel (%)                                                   
##                                              26 (  0.6)     27 (  1.1) 
##      Car-Dependent                          351 (  8.2)    243 (  9.7) 
##      Somewhat Walkable                      700 ( 16.4)    403 ( 16.0) 
##      Very Walkable                         1467 ( 34.4)    869 ( 34.5) 
##      Walker's Paradise                     1720 ( 40.3)    976 ( 38.8) 
##   TransitScore (mean (SD))                48.42 (25.00)  45.29 (19.95) 
##   TransitScoreLabel (%)                                                
##                                              33 (  0.8)     88 (  3.5) 
##      Excellent Transit                     1547 ( 36.3)   1035 ( 41.1) 
##      Good Transit                           939 ( 22.0)    865 ( 34.4) 
##      Minimal Transit                         34 (  0.8)      5 (  0.2) 
##      Rider's Paradise                      1671 ( 39.2)    371 ( 14.7) 
##      Some Transit                            40 (  0.9)    154 (  6.1) 
##   BikeScore (mean (SD))                   70.90 (30.62)  92.61 (36.44) 
##   BikeScoreLabel (%)                                                   
##                                             120 (  2.8)    512 ( 20.3) 
##      Bikeable                              2214 ( 51.9)    745 ( 29.6) 
##      Biker's Paradise                       431 ( 10.1)    422 ( 16.8) 
##      Somewhat Bikeable                      500 ( 11.7)    179 (  7.1) 
##      Very Bikeable                          999 ( 23.4)    660 ( 26.2) 
##   DiningandDrinkingScore (mean (SD))      81.64 (19.10)  81.17 (19.59) 
##   GroceryScore (mean (SD))                82.99 (23.65)  84.45 (22.22) 
##                                          Stratified by ville
##                                           p      test
##   n                                                  
##   language = Fren/Span (%)                <0.001     
##   ville (%)                               <0.001     
##      Boston                                          
##      Chicago                                         
##      Détroit                                         
##      Montréal                                        
##      New-York                                        
##      Philadelphie                                    
##      Toronto                                         
##      Vancouver                                       
##   gender = Male (%)                       <0.001     
##   health (%)                              <0.001     
##      Excellent                                       
##      Good                                            
##      Poor                                            
##   common_transportation (%)               <0.001     
##      Bicycle                                         
##      Car                                             
##      Other                                           
##      Public Transportation                           
##      Walking                                         
##   physically_active = Yes (%)             <0.001     
##   pa_level (%)                            <0.001     
##      Low                                             
##      Moderate                                        
##      NA                                              
##      Sedentary                                       
##      Vigorous                                        
##   day_per_week_motor_vehicle (mean (SD))  <0.001     
##   day_per_week_public_transit (mean (SD)) <0.001     
##   day_per_week_walking (mean (SD))        <0.001     
##   day_per_week_bike (mean (SD))           <0.001     
##   q42 (mean (SD))                         <0.001     
##   marital_status = Single (%)             <0.001     
##   children_household (mean (SD))          <0.001     
##   ethnicity (%)                           <0.001     
##      African American                                
##      Asian                                           
##      Causcasian                                      
##      Hispanic                                        
##      Native American                                 
##      Other                                           
##      Refuse                                          
##   country_born (%)                        <0.001     
##      Canada                                          
##      Other                                           
##      United States                                   
##   motor_vehicle_access = Yes (%)          <0.001     
##   education (%)                           <0.001     
##      Baccalaureate                                   
##      Cégep                                           
##      Certificate/Diploma                             
##      Graduate School                                 
##      High School/Lower                               
##   occupation_status (%)                   <0.001     
##      Employed                                        
##      Student                                         
##      Unemployed                                      
##   household_income (%)                    <0.001     
##      $0-$19999                                       
##      $100000-149999                                  
##      $150000+                                        
##      $20000-$49999                                   
##      $50000-$74999                                   
##      $75000-$99999                                   
##   bmi (mean (SD))                         <0.001     
##   bmi_category (%)                        <0.001     
##      normal weight                                   
##      obese                                           
##      other                                           
##      overweight                                      
##      underweight                                     
##   WalkScore (mean (SD))                   <0.001     
##   WalkScoreLabel (%)                      <0.001     
##                                                      
##      Car-Dependent                                   
##      Somewhat Walkable                               
##      Very Walkable                                   
##      Walker's Paradise                               
##   TransitScore (mean (SD))                <0.001     
##   TransitScoreLabel (%)                   <0.001     
##                                                      
##      Excellent Transit                               
##      Good Transit                                    
##      Minimal Transit                                 
##      Rider's Paradise                                
##      Some Transit                                    
##   BikeScore (mean (SD))                   <0.001     
##   BikeScoreLabel (%)                      <0.001     
##                                                      
##      Bikeable                                        
##      Biker's Paradise                                
##      Somewhat Bikeable                               
##      Very Bikeable                                   
##   DiningandDrinkingScore (mean (SD))      <0.001     
##   GroceryScore (mean (SD))                <0.001
```

# Fix this Code - Breaks Session
ibiccs %>%
    group_by(ville) %>%
      CreateTableOne(vars = vars)

language_lm <- lm(bmi ~ cbind(lang, q2), Boston)
tidy(language_lm)

# Histogram of BMI

```r
hist_bmi <- ggplot(city, aes(bmi)) + 
  geom_histogram()
plot(hist_bmi)
```

```
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
```

![](Thesis-Analysis_files/figure-html/unnamed-chunk-29-1.png)<!-- -->

```r
hist_bmi_city <- ggplot(city, aes(bmi)) + 
  geom_density(aes(group = ville, colour = ville)) +
  theme_minimal()
plot(hist_bmi_city)
```

![](Thesis-Analysis_files/figure-html/unnamed-chunk-29-2.png)<!-- -->

# Histogram of WalkScore

```r
hist_walkscore <- ggplot(city, aes(WalkScore)) + 
  geom_histogram()
plot(hist_walkscore)
```

```
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
```

![](Thesis-Analysis_files/figure-html/unnamed-chunk-30-1.png)<!-- -->

```r
hist_walkscore_city <- ggplot(city, aes(WalkScore)) + 
  geom_density(aes(group = ville, colour = ville)) +
  theme_minimal()
plot(hist_walkscore_city)
```

![](Thesis-Analysis_files/figure-html/unnamed-chunk-30-2.png)<!-- -->

# Histogram of TransitScore

```r
hist_trasnsitscore <- ggplot(city, aes(TransitScore)) + 
  geom_histogram()
plot(hist_trasnsitscore)
```

```
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
```

![](Thesis-Analysis_files/figure-html/unnamed-chunk-31-1.png)<!-- -->

```r
hist_trasnsitscore_city <- ggplot(city, aes(TransitScore)) + 
  geom_density(aes(group = ville, colour = ville)) +
  theme_minimal()
plot(hist_trasnsitscore_city)
```

![](Thesis-Analysis_files/figure-html/unnamed-chunk-31-2.png)<!-- -->

# Histogram of GroceryScore

```r
hist_groceryscore <- ggplot(city, aes(GroceryScore)) + 
  geom_histogram()
plot(hist_groceryscore)
```

```
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
```

![](Thesis-Analysis_files/figure-html/unnamed-chunk-32-1.png)<!-- -->

```r
hist_groceryscore_city <- ggplot(city, aes(GroceryScore)) + 
  geom_density(aes(group = ville, colour = ville)) +
  theme_minimal()
plot(hist_groceryscore_city)
```

![](Thesis-Analysis_files/figure-html/unnamed-chunk-32-2.png)<!-- -->

# Histogram of DiningAndDrinkingScore

```r
hist_diningdrinkingscore <- ggplot(city, aes(DiningandDrinkingScore)) + 
  geom_histogram()
plot(hist_diningdrinkingscore)
```

```
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
```

![](Thesis-Analysis_files/figure-html/unnamed-chunk-33-1.png)<!-- -->

```r
hist_diningdrinkingscore_city <- ggplot(city, aes(DiningandDrinkingScore)) + 
  geom_density(aes(group = ville, colour = ville)) +
  theme_minimal()
plot(hist_diningdrinkingscore_city)
```

![](Thesis-Analysis_files/figure-html/unnamed-chunk-33-2.png)<!-- -->

# Linear Regression

```r
explanatory <- c('language', 'ville', 'gender', 'health', 'physically_active', 'q42', 'marital_status', 'country_born', 'motor_vehicle_access', 'occupation_status', 'bmi_category', 'WalkScore', 'TransitScore', 'BikeScore', 'DiningandDrinkingScore', 'GroceryScore', 'day_per_week_motor_vehicle', 'day_per_week_public_transit', 'day_per_week_walking', 'day_per_week_bike', 'children_household')
dependent <- "bmi"
ibiccs %>%
  finalfit.lm(dependent, explanatory, na.rm = TRUE)
```

```
##                 Dependent: bmi                                  Mean (sd)
## 25                    language                         English 25.6 (4.7)
## 26                                                   Fren/Span 26.0 (4.8)
## 38                       ville                          Boston 25.1 (4.6)
## 39                                                     Chicago 25.9 (4.9)
## 40                                                     Détroit 26.7 (5.1)
## 41                                                    Montréal 25.9 (4.7)
## 42                                                    New-York 25.0 (4.5)
## 43                                                Philadelphie 26.0 (5.0)
## 44                                                     Toronto 25.6 (4.5)
## 45                                                   Vancouver 24.9 (4.3)
## 19                      gender                          Female 25.0 (4.9)
## 20                                                        Male 26.4 (4.3)
## 22                      health                       Excellent 24.7 (4.1)
## 23                                                        Good 26.8 (5.0)
## 24                                                        Poor 28.4 (5.6)
## 34           physically_active                              No 26.7 (5.3)
## 35                                                         Yes 25.4 (4.5)
## 36                         q42                         [18,94] 25.6 (4.7)
## 27              marital_status Relationship/Married/Common-Law 25.8 (4.6)
## 28                                                      Single 25.2 (4.8)
## 11                country_born                          Canada 25.7 (4.6)
## 12                                                       Other 24.8 (4.3)
## 13                                               United States 25.9 (4.9)
## 29        motor_vehicle_access                              No 25.2 (4.8)
## 30                                                         Yes 25.8 (4.7)
## 31           occupation_status                        Employed 25.6 (4.6)
## 32                                                     Student 24.2 (4.8)
## 33                                                  Unemployed 26.4 (4.9)
## 2                 bmi_category                   normal weight 22.2 (1.7)
## 3                                                        obese 33.6 (2.8)
## 4                                                   overweight 27.1 (1.4)
## 5                                                  underweight 18.1 (0.3)
## 46                   WalkScore                         [0,100] 25.6 (4.7)
## 37                TransitScore                          [1,80] 25.6 (4.7)
## 1                    BikeScore                         [1,138] 25.6 (4.7)
## 18      DiningandDrinkingScore                         [0,100] 25.6 (4.7)
## 21                GroceryScore                         [0,100] 25.6 (4.7)
## 15  day_per_week_motor_vehicle                           [0,7] 25.6 (4.7)
## 16 day_per_week_public_transit                           [0,7] 25.6 (4.7)
## 17        day_per_week_walking                           [0,7] 25.6 (4.7)
## 14           day_per_week_bike                           [0,7] 25.6 (4.6)
## 7           children_household                               0 25.5 (4.7)
## 8                                                            1 25.9 (4.8)
## 9                                                            2 26.1 (4.7)
## 10                                                           3 26.9 (5.2)
## 6                         <NA>                            <NA>       <NA>
##          Coefficient (univariable)     Coefficient (multivariable)
## 25                               -                               -
## 26    0.43 (0.18 to 0.69, p=0.001)  -0.11 (-0.31 to 0.08, p=0.249)
## 38                               -                               -
## 39    0.83 (0.57 to 1.10, p<0.001)   0.08 (-0.06 to 0.21, p=0.252)
## 40    1.69 (1.41 to 1.97, p<0.001)   0.06 (-0.12 to 0.23, p=0.532)
## 41    0.82 (0.53 to 1.11, p<0.001)   0.03 (-0.23 to 0.29, p=0.795)
## 42  -0.01 (-0.28 to 0.26, p=0.937)  -0.11 (-0.25 to 0.03, p=0.127)
## 43    0.96 (0.63 to 1.29, p<0.001)  -0.03 (-0.20 to 0.13, p=0.708)
## 44    0.54 (0.28 to 0.81, p<0.001)  -0.01 (-0.21 to 0.19, p=0.939)
## 45  -0.18 (-0.47 to 0.11, p=0.213) -0.21 (-0.42 to -0.01, p=0.043)
## 19                               -                               -
## 20    1.39 (1.26 to 1.52, p<0.001)    0.26 (0.19 to 0.33, p<0.001)
## 22                               -                               -
## 23    2.05 (1.91 to 2.19, p<0.001)    0.29 (0.21 to 0.36, p<0.001)
## 24    3.66 (3.45 to 3.87, p<0.001)    0.53 (0.40 to 0.66, p<0.001)
## 34                               -                               -
## 35 -1.27 (-1.44 to -1.10, p<0.001)  -0.04 (-0.13 to 0.06, p=0.448)
## 36    0.06 (0.05 to 0.06, p<0.001)    0.01 (0.01 to 0.01, p<0.001)
## 27                               -                               -
## 28 -0.57 (-0.71 to -0.44, p<0.001)   0.02 (-0.05 to 0.10, p=0.560)
## 11                               -                               -
## 12 -0.91 (-1.11 to -0.71, p<0.001) -0.17 (-0.29 to -0.05, p=0.006)
## 13    0.18 (0.04 to 0.33, p=0.012)   0.02 (-0.14 to 0.18, p=0.839)
## 29                               -                               -
## 30    0.63 (0.48 to 0.77, p<0.001)  -0.03 (-0.12 to 0.07, p=0.594)
## 31                               -                               -
## 32 -1.32 (-1.57 to -1.06, p<0.001)   0.01 (-0.12 to 0.14, p=0.908)
## 33    0.90 (0.74 to 1.06, p<0.001)  -0.06 (-0.16 to 0.03, p=0.205)
## 2                                -                               -
## 3  11.44 (11.37 to 11.51, p<0.001) 11.14 (11.04 to 11.23, p<0.001)
## 4     4.89 (4.83 to 4.95, p<0.001)    4.69 (4.61 to 4.77, p<0.001)
## 5  -4.11 (-4.30 to -3.92, p<0.001) -3.99 (-4.24 to -3.75, p<0.001)
## 46 -0.02 (-0.02 to -0.02, p<0.001)   0.00 (-0.00 to 0.01, p=0.456)
## 37    0.01 (0.00 to 0.01, p<0.001)   0.00 (-0.00 to 0.00, p=0.587)
## 1     0.00 (0.00 to 0.00, p=0.035)  -0.00 (-0.00 to 0.00, p=0.099)
## 18 -0.02 (-0.02 to -0.02, p<0.001) -0.01 (-0.01 to -0.00, p=0.047)
## 21 -0.01 (-0.01 to -0.01, p<0.001)   0.00 (-0.00 to 0.00, p=0.259)
## 15    0.21 (0.19 to 0.24, p<0.001)   0.01 (-0.00 to 0.03, p=0.136)
## 16 -0.18 (-0.21 to -0.15, p<0.001)   0.01 (-0.01 to 0.02, p=0.421)
## 17 -0.25 (-0.27 to -0.22, p<0.001) -0.02 (-0.03 to -0.00, p=0.042)
## 14 -0.15 (-0.19 to -0.10, p<0.001)  -0.01 (-0.03 to 0.01, p=0.262)
## 7                                -                               -
## 8                                -                               -
## 9                                -                               -
## 10                               -                               -
## 6     0.36 (0.27 to 0.44, p<0.001)    0.08 (0.04 to 0.13, p<0.001)
```

```r
# Regressions for variables that won't run in explanatory
educ_reg <- lm(bmi ~ factor(education), data = ibiccs)
summary(educ_reg)
```

```
## 
## Call:
## lm(formula = bmi ~ factor(education), data = ibiccs)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -9.275 -3.438 -0.801  2.539 15.409 
## 
## Coefficients:
##                                      Estimate Std. Error t value Pr(>|t|)
## (Intercept)                           25.2285     0.0525  480.19   <2e-16
## factor(education)Cégep                 1.1505     0.1024   11.23   <2e-16
## factor(education)Certificate/Diploma   1.3631     0.1126   12.10   <2e-16
## factor(education)Graduate School      -0.1476     0.0794   -1.86    0.063
## factor(education)High School/Lower     1.6166     0.1153   14.03   <2e-16
##                                         
## (Intercept)                          ***
## factor(education)Cégep               ***
## factor(education)Certificate/Diploma ***
## factor(education)Graduate School     .  
## factor(education)High School/Lower   ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 4.65 on 21002 degrees of freedom
##   (2894 observations deleted due to missingness)
## Multiple R-squared:  0.021,	Adjusted R-squared:  0.0208 
## F-statistic:  112 on 4 and 21002 DF,  p-value: <2e-16
```

```r
confint(educ_reg)
```

```
##                                        2.5 %    97.5 %
## (Intercept)                          25.1255 25.331477
## factor(education)Cégep                0.9497  1.351290
## factor(education)Certificate/Diploma  1.1424  1.583923
## factor(education)Graduate School     -0.3032  0.007946
## factor(education)High School/Lower    1.3907  1.842495
```

```r
tran_reg <- lm(bmi ~ factor(common_transportation), data = ibiccs)
summary(tran_reg)
```

```
## 
## Call:
## lm(formula = bmi ~ factor(common_transportation), data = ibiccs)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -8.876 -3.374 -0.764  2.619 15.631 
## 
## Coefficients:
##                                                    Estimate Std. Error
## (Intercept)                                          24.556      0.147
## factor(common_transportation)Car                      1.860      0.155
## factor(common_transportation)Other                    1.723      0.374
## factor(common_transportation)Public Transportation    0.768      0.158
## factor(common_transportation)Walking                  0.163      0.164
##                                                    t value  Pr(>|t|)    
## (Intercept)                                         166.62   < 2e-16 ***
## factor(common_transportation)Car                     11.97   < 2e-16 ***
## factor(common_transportation)Other                    4.61 0.0000041 ***
## factor(common_transportation)Public Transportation    4.87 0.0000011 ***
## factor(common_transportation)Walking                  0.99      0.32    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 4.65 on 21113 degrees of freedom
##   (2783 observations deleted due to missingness)
## Multiple R-squared:  0.023,	Adjusted R-squared:  0.0228 
## F-statistic:  124 on 4 and 21113 DF,  p-value: <2e-16
```

```r
confint(tran_reg)
```

```
##                                                      2.5 %  97.5 %
## (Intercept)                                        24.2673 24.8451
## factor(common_transportation)Car                    1.5556  2.1650
## factor(common_transportation)Other                  0.9900  2.4565
## factor(common_transportation)Public Transportation  0.4589  1.0764
## factor(common_transportation)Walking               -0.1590  0.4854
```

```r
income_reg <- lm(bmi ~ factor(household_income), data = ibiccs)
summary(income_reg)
```

```
## 
## Call:
## lm(formula = bmi ~ factor(household_income), data = ibiccs)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -8.774 -3.492 -0.794  2.662 15.107 
## 
## Coefficients:
##                                        Estimate Std. Error t value
## (Intercept)                              26.334      0.106  248.73
## factor(household_income)$100000-149999   -0.706      0.134   -5.26
## factor(household_income)$150000+         -0.992      0.145   -6.85
## factor(household_income)$20000-$49999    -0.431      0.128   -3.36
## factor(household_income)$50000-$74999    -0.697      0.130   -5.38
## factor(household_income)$75000-$99999    -0.692      0.135   -5.13
##                                        Pr(>|t|)    
## (Intercept)                             < 2e-16 ***
## factor(household_income)$100000-149999  1.4e-07 ***
## factor(household_income)$150000+        7.7e-12 ***
## factor(household_income)$20000-$49999   0.00079 ***
## factor(household_income)$50000-$74999   7.6e-08 ***
## factor(household_income)$75000-$99999   2.9e-07 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 4.71 on 18836 degrees of freedom
##   (5059 observations deleted due to missingness)
## Multiple R-squared:  0.00306,	Adjusted R-squared:  0.0028 
## F-statistic: 11.6 on 5 and 18836 DF,  p-value: 3.57e-11
```

```r
confint(income_reg)
```

```
##                                          2.5 %  97.5 %
## (Intercept)                            26.1268 26.5419
## factor(household_income)$100000-149999 -0.9691 -0.4432
## factor(household_income)$150000+       -1.2753 -0.7078
## factor(household_income)$20000-$49999  -0.6826 -0.1792
## factor(household_income)$50000-$74999  -0.9504 -0.4427
## factor(household_income)$75000-$99999  -0.9569 -0.4278
```

```r
ethn_reg <- lm(bmi ~ factor(ethnicity), data = ibiccs)
summary(ethn_reg)
```

```
## 
## Call:
## lm(formula = bmi ~ factor(ethnicity), data = ibiccs)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -10.008  -3.398  -0.758   2.542  16.259 
## 
## Coefficients:
##                                  Estimate Std. Error t value Pr(>|t|)    
## (Intercept)                        27.748      0.127  218.41  < 2e-16 ***
## factor(ethnicity)Asian             -4.067      0.158  -25.78  < 2e-16 ***
## factor(ethnicity)Causcasian        -1.970      0.132  -14.88  < 2e-16 ***
## factor(ethnicity)Hispanic          -1.539      0.212   -7.26  3.9e-13 ***
## factor(ethnicity)Native American   -2.131      0.605   -3.52  0.00043 ***
## factor(ethnicity)Other             -2.458      0.217  -11.34  < 2e-16 ***
## factor(ethnicity)Refuse            -2.929      0.258  -11.36  < 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 4.62 on 21153 degrees of freedom
##   (2741 observations deleted due to missingness)
## Multiple R-squared:  0.0345,	Adjusted R-squared:  0.0343 
## F-statistic:  126 on 6 and 21153 DF,  p-value: <2e-16
```

```r
confint(ethn_reg)
```

```
##                                   2.5 %  97.5 %
## (Intercept)                      27.499 27.9966
## factor(ethnicity)Asian           -4.376 -3.7578
## factor(ethnicity)Causcasian      -2.229 -1.7105
## factor(ethnicity)Hispanic        -1.954 -1.1236
## factor(ethnicity)Native American -3.318 -0.9448
## factor(ethnicity)Other           -2.883 -2.0329
## factor(ethnicity)Refuse          -3.435 -2.4236
```

```r
pa_lvl_reg <- lm(bmi ~ factor(pa_level), data = ibiccs)
summary(pa_lvl_reg)
```

```
## 
## Call:
## lm(formula = bmi ~ factor(pa_level), data = ibiccs)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
##  -9.03  -3.42  -0.75   2.54  15.61 
## 
## Coefficients:
##                           Estimate Std. Error t value Pr(>|t|)    
## (Intercept)                 25.030      0.127  197.34  < 2e-16 ***
## factor(pa_level)Moderate     0.780      0.135    5.76  8.5e-09 ***
## factor(pa_level)NA           1.562      0.147   10.63  < 2e-16 ***
## factor(pa_level)Sedentary    2.593      0.923    2.81    0.005 ** 
## factor(pa_level)Vigorous    -0.153      0.140   -1.09    0.274    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 4.66 on 21155 degrees of freedom
##   (2741 observations deleted due to missingness)
## Multiple R-squared:  0.0172,	Adjusted R-squared:  0.017 
## F-statistic: 92.4 on 4 and 21155 DF,  p-value: <2e-16
```

```r
confint(pa_lvl_reg)
```

```
##                             2.5 %  97.5 %
## (Intercept)               24.7818 25.2790
## factor(pa_level)Moderate   0.5147  1.0454
## factor(pa_level)NA         1.2743  1.8504
## factor(pa_level)Sedentary  0.7835  4.4034
## factor(pa_level)Vigorous  -0.4279  0.1214
```
Interpretation: What covariates are we keeping?
'language', 'ville', 'gender', 'health', 'physically_active', 'q42', 'marital_status', 'country_born', 'motor_vehicle_access', 'occupation_status', 'bmi_category', 'WalkScore', 'TransitScore', 'BikeScore', 'DiningandDrinkingScore', 'GroceryScore', 'day_per_week_motor_vehicle', 'day_per_week_public_transit', 'day_per_week_walking', 'day_per_week_bike', 'children_household'

# Linear Regression

```r
lm1 <- lm(bmi ~ WalkScore + DiningandDrinkingScore + GroceryScore + factor(ville), data = ibiccs)
summary(lm1)
```

```
## 
## Call:
## lm(formula = bmi ~ WalkScore + DiningandDrinkingScore + GroceryScore + 
##     factor(ville), data = ibiccs)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -9.983 -3.455 -0.787  2.590 15.602 
## 
## Coefficients:
##                           Estimate Std. Error t value Pr(>|t|)    
## (Intercept)               26.29791    0.19130  137.47  < 2e-16 ***
## WalkScore                 -0.01675    0.00756   -2.22  0.02662 *  
## DiningandDrinkingScore    -0.01317    0.00580   -2.27  0.02325 *  
## GroceryScore               0.01474    0.00265    5.57  2.6e-08 ***
## factor(ville)Chicago       0.88916    0.13675    6.50  8.1e-11 ***
## factor(ville)Détroit       1.00145    0.17314    5.78  7.4e-09 ***
## factor(ville)Montréal      0.71927    0.14821    4.85  1.2e-06 ***
## factor(ville)New-York      0.16378    0.13874    1.18  0.23780    
## factor(ville)Philadelphie  1.00341    0.17099    5.87  4.5e-09 ***
## factor(ville)Toronto       0.48620    0.13599    3.58  0.00035 ***
## factor(ville)Vancouver    -0.26448    0.15016   -1.76  0.07820 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 4.66 on 20911 degrees of freedom
##   (2979 observations deleted due to missingness)
## Multiple R-squared:  0.0201,	Adjusted R-squared:  0.0197 
## F-statistic:   43 on 10 and 20911 DF,  p-value: <2e-16
```

```r
confint(lm1)
```

```
##                               2.5 %    97.5 %
## (Intercept)               25.922939 26.672884
## WalkScore                 -0.031561 -0.001943
## DiningandDrinkingScore    -0.024546 -0.001795
## GroceryScore               0.009547  0.019924
## factor(ville)Chicago       0.621122  1.157201
## factor(ville)Détroit       0.662073  1.340821
## factor(ville)Montréal      0.428758  1.009773
## factor(ville)New-York     -0.108149  0.435718
## factor(ville)Philadelphie  0.668248  1.338564
## factor(ville)Toronto       0.219654  0.752745
## factor(ville)Vancouver    -0.558809  0.029848
```

```r
lm2 <- lm(bmi ~ WalkScore + DiningandDrinkingScore + GroceryScore + factor(ville) + education + occupation_status + household_income, data = ibiccs)
summary(lm2)
```

```
## 
## Call:
## lm(formula = bmi ~ WalkScore + DiningandDrinkingScore + GroceryScore + 
##     factor(ville) + education + occupation_status + household_income, 
##     data = ibiccs)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -10.819  -3.329  -0.724   2.542  16.760 
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(>|t|)    
## (Intercept)                    26.20854    0.23754  110.33  < 2e-16 ***
## WalkScore                      -0.00879    0.00804   -1.09  0.27463    
## DiningandDrinkingScore         -0.01412    0.00617   -2.29  0.02205 *  
## GroceryScore                    0.01272    0.00280    4.54  5.6e-06 ***
## factor(ville)Chicago            0.73388    0.14227    5.16  2.5e-07 ***
## factor(ville)Détroit            0.91028    0.18072    5.04  4.8e-07 ***
## factor(ville)Montréal           0.20252    0.15748    1.29  0.19848    
## factor(ville)New-York          -0.07034    0.14518   -0.48  0.62805    
## factor(ville)Philadelphie       0.77106    0.17738    4.35  1.4e-05 ***
## factor(ville)Toronto            0.02463    0.14465    0.17  0.86478    
## factor(ville)Vancouver         -0.67523    0.16098   -4.19  2.7e-05 ***
## educationCégep                  1.21360    0.11049   10.98  < 2e-16 ***
## educationCertificate/Diploma    1.26010    0.12205   10.32  < 2e-16 ***
## educationGraduate School       -0.17912    0.08437   -2.12  0.03376 *  
## educationHigh School/Lower      1.28067    0.12757   10.04  < 2e-16 ***
## occupation_statusStudent       -1.73034    0.14675  -11.79  < 2e-16 ***
## occupation_statusUnemployed     0.61541    0.09091    6.77  1.3e-11 ***
## household_income$100000-149999 -0.24042    0.14021   -1.71  0.08643 .  
## household_income$150000+       -0.30547    0.15257   -2.00  0.04528 *  
## household_income$20000-$49999  -0.32428    0.12912   -2.51  0.01203 *  
## household_income$50000-$74999  -0.45499    0.13318   -3.42  0.00064 ***
## household_income$75000-$99999  -0.34858    0.13964   -2.50  0.01256 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 4.6 on 18489 degrees of freedom
##   (5390 observations deleted due to missingness)
## Multiple R-squared:  0.0503,	Adjusted R-squared:  0.0492 
## F-statistic: 46.7 on 21 and 18489 DF,  p-value: <2e-16
```

```r
confint(lm2)
```

```
##                                    2.5 %    97.5 %
## (Intercept)                    25.742943 26.674146
## WalkScore                      -0.024555  0.006979
## DiningandDrinkingScore         -0.026216 -0.002033
## GroceryScore                    0.007231  0.018212
## factor(ville)Chicago            0.455028  1.012741
## factor(ville)Détroit            0.556042  1.264516
## factor(ville)Montréal          -0.106167  0.511203
## factor(ville)New-York          -0.354898  0.214225
## factor(ville)Philadelphie       0.423369  1.118749
## factor(ville)Toronto           -0.258890  0.308156
## factor(ville)Vancouver         -0.990762 -0.359704
## educationCégep                  0.997026  1.430183
## educationCertificate/Diploma    1.020874  1.499319
## educationGraduate School       -0.344495 -0.013752
## educationHigh School/Lower      1.030627  1.530714
## occupation_statusStudent       -2.017989 -1.442700
## occupation_statusUnemployed     0.437217  0.793603
## household_income$100000-149999 -0.515251  0.034416
## household_income$150000+       -0.604512 -0.006427
## household_income$20000-$49999  -0.577371 -0.071192
## household_income$50000-$74999  -0.716026 -0.193954
## household_income$75000-$99999  -0.622276 -0.074881
```

```r
lm3 <- lm(bmi ~ WalkScore + DiningandDrinkingScore + GroceryScore + factor(ville) + education + occupation_status + household_income + language + gender + marital_status + ethnicity, data = ibiccs)
summary(lm3)
```

```
## 
## Call:
## lm(formula = bmi ~ WalkScore + DiningandDrinkingScore + GroceryScore + 
##     factor(ville) + education + occupation_status + household_income + 
##     language + gender + marital_status + ethnicity, data = ibiccs)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -11.061  -3.133  -0.816   2.393  17.214 
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(>|t|)    
## (Intercept)                    27.49769    0.28836   95.36  < 2e-16 ***
## WalkScore                      -0.01781    0.00843   -2.11  0.03459 *  
## DiningandDrinkingScore         -0.00336    0.00647   -0.52  0.60315    
## GroceryScore                    0.01236    0.00291    4.25  2.1e-05 ***
## factor(ville)Chicago            0.55407    0.14645    3.78  0.00016 ***
## factor(ville)Détroit            0.69868    0.18818    3.71  0.00021 ***
## factor(ville)Montréal          -0.01178    0.21133   -0.06  0.95554    
## factor(ville)New-York          -0.10983    0.14885   -0.74  0.46062    
## factor(ville)Philadelphie       0.60289    0.18258    3.30  0.00096 ***
## factor(ville)Toronto            0.07916    0.15116    0.52  0.60049    
## factor(ville)Vancouver         -0.48807    0.16950   -2.88  0.00399 ** 
## educationCégep                  0.97058    0.11742    8.27  < 2e-16 ***
## educationCertificate/Diploma    1.06107    0.12943    8.20  2.6e-16 ***
## educationGraduate School       -0.17946    0.08640   -2.08  0.03782 *  
## educationHigh School/Lower      0.88140    0.13728    6.42  1.4e-10 ***
## occupation_statusStudent       -1.23030    0.14878   -8.27  < 2e-16 ***
## occupation_statusUnemployed     0.55139    0.09828    5.61  2.1e-08 ***
## household_income$100000-149999 -0.38322    0.15166   -2.53  0.01152 *  
## household_income$150000+       -0.49164    0.16524   -2.98  0.00293 ** 
## household_income$20000-$49999  -0.24291    0.13791   -1.76  0.07819 .  
## household_income$50000-$74999  -0.42023    0.14176   -2.96  0.00304 ** 
## household_income$75000-$99999  -0.37183    0.14962   -2.49  0.01296 *  
## languageFren/Span               0.12686    0.21629    0.59  0.55752    
## genderMale                      1.36809    0.07163   19.10  < 2e-16 ***
## marital_statusSingle           -0.37643    0.08039   -4.68  2.9e-06 ***
## ethnicityAsian                 -3.25232    0.18095  -17.97  < 2e-16 ***
## ethnicityCauscasian            -1.65088    0.15193  -10.87  < 2e-16 ***
## ethnicityHispanic              -1.24998    0.23095   -5.41  6.3e-08 ***
## ethnicityNative American       -1.78746    0.65061   -2.75  0.00601 ** 
## ethnicityOther                 -2.07045    0.24253   -8.54  < 2e-16 ***
## ethnicityRefuse                -2.39861    0.35763   -6.71  2.1e-11 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 4.48 on 16278 degrees of freedom
##   (7592 observations deleted due to missingness)
## Multiple R-squared:  0.0908,	Adjusted R-squared:  0.0891 
## F-statistic: 54.2 on 30 and 16278 DF,  p-value: <2e-16
```

```r
confint(lm3)
```

```
##                                    2.5 %    97.5 %
## (Intercept)                    26.932477 28.062898
## WalkScore                      -0.034326 -0.001291
## DiningandDrinkingScore         -0.016051  0.009322
## GroceryScore                    0.006666  0.018059
## factor(ville)Chicago            0.267002  0.841132
## factor(ville)Détroit            0.329818  1.067542
## factor(ville)Montréal          -0.426008  0.402442
## factor(ville)New-York          -0.401603  0.181940
## factor(ville)Philadelphie       0.245019  0.960770
## factor(ville)Toronto           -0.217131  0.375460
## factor(ville)Vancouver         -0.820315 -0.155828
## educationCégep                  0.740429  1.200738
## educationCertificate/Diploma    0.807363  1.314770
## educationGraduate School       -0.348821 -0.010095
## educationHigh School/Lower      0.612309  1.150493
## occupation_statusStudent       -1.521927 -0.938674
## occupation_statusUnemployed     0.358747  0.744041
## household_income$100000-149999 -0.680478 -0.085954
## household_income$150000+       -0.815527 -0.167752
## household_income$20000-$49999  -0.513220  0.027403
## household_income$50000-$74999  -0.698084 -0.142369
## household_income$75000-$99999  -0.665107 -0.078558
## languageFren/Span              -0.297083  0.550806
## genderMale                      1.227691  1.508484
## marital_statusSingle           -0.534014 -0.218849
## ethnicityAsian                 -3.607005 -2.897643
## ethnicityCauscasian            -1.948678 -1.353075
## ethnicityHispanic              -1.702677 -0.797285
## ethnicityNative American       -3.062733 -0.512193
## ethnicityOther                 -2.545842 -1.595063
## ethnicityRefuse                -3.099604 -1.697612
```

# Scatter Plots for BMI & Variables

```r
#BMI & WalkScore
ggplot(ibiccs, aes(x = bmi, y = WalkScore)) + 
  geom_point() + 
  facet_wrap(~ ville)
```

![](Thesis-Analysis_files/figure-html/unnamed-chunk-36-1.png)<!-- -->

# Complete cases 

```r
ibiccs_cc <- ibiccs %>% 
              drop_na("bmi", "GroceryScore", "WalkScore", "DiningandDrinkingScore")
```
We remove missing data for all variables. We go from 23901 observations to 20922 observations. 

# Causal Mediation
# GroceryScore

```r
med.fit <- glm(GroceryScore ~ WalkScore, family = gaussian(link = "identity"), data = ibiccs_cc) 
summary(med.fit)
```

```
## 
## Call:
## glm(formula = GroceryScore ~ WalkScore, family = gaussian(link = "identity"), 
##     data = ibiccs_cc)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -66.59   -3.83   -0.08    5.60   63.41  
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept) -0.96590    0.30735   -3.14   0.0017 ** 
## WalkScore    1.04793    0.00375  279.45   <2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for gaussian family taken to be 180.5)
## 
##     Null deviance: 17875112  on 20921  degrees of freedom
## Residual deviance:  3776883  on 20920  degrees of freedom
## AIC: 168088
## 
## Number of Fisher Scoring iterations: 2
```

```r
out.fit <- glm(bmi ~ WalkScore * GroceryScore, family = gaussian(link = "identity"), data = ibiccs_cc)
summary(out.fit)
```

```
## 
## Call:
## glm(formula = bmi ~ WalkScore * GroceryScore, family = gaussian(link = "identity"), 
##     data = ibiccs_cc)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -9.844  -3.458  -0.797   2.567  15.301  
## 
## Coefficients:
##                          Estimate Std. Error t value Pr(>|t|)    
## (Intercept)            26.5684245  0.1547173  171.72  < 2e-16 ***
## WalkScore              -0.0202338  0.0040430   -5.00  5.6e-07 ***
## GroceryScore            0.0290941  0.0033992    8.56  < 2e-16 ***
## WalkScore:GroceryScore -0.0002451  0.0000442   -5.55  2.9e-08 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for gaussian family taken to be 21.83)
## 
##     Null deviance: 463192  on 20921  degrees of freedom
## Residual deviance: 456602  on 20918  degrees of freedom
## AIC: 123887
## 
## Number of Fisher Scoring iterations: 2
```

```r
med.out <- mediate(med.fit, out.fit, treat = "WalkScore", mediator = "GroceryScore", sims = 100) 
summary(med.out)
```

```
## 
## Causal Mediation Analysis 
## 
## Quasi-Bayesian Confidence Intervals
## 
##                           Estimate 95% CI Lower 95% CI Upper p-value    
## ACME (control)             0.02994      0.02441         0.04  <2e-16 ***
## ACME (treated)             0.02969      0.02421         0.04  <2e-16 ***
## ADE (control)             -0.01997     -0.02801        -0.01  <2e-16 ***
## ADE (treated)             -0.02022     -0.02820        -0.01  <2e-16 ***
## Total Effect               0.00972     -0.00117         0.02     0.1 .  
## Prop. Mediated (control)   2.94481    -14.96198        16.07     0.1 .  
## Prop. Mediated (treated)   2.91841    -14.85881        15.96     0.1 .  
## ACME (average)             0.02982      0.02431         0.04  <2e-16 ***
## ADE (average)             -0.02009     -0.02810        -0.01  <2e-16 ***
## Prop. Mediated (average)   2.93161    -14.91039        16.02     0.1 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Sample Size Used: 20922 
## 
## 
## Simulations: 100
```
Interpretation: 
The estimated mediation, direct, and total effects are all significantly different from zero. The results suggest that the WalkScore increases the value of the individual-level mediator (GroceryScore), which in turn decreases the value of the outcome (bmi).
Total: 1-unit change in WalkScore results in a .01 increase in BMI when GroceryScore is included.
ADE: 1-unit change in WalkScore results in a .02 decrease in BMI when GroceryScore is fixed.
ACME: 1-unit change in GroceryScore results in .03 increase in BMI when WalkScore is fixed.

# DiningandDrinkingScore

```r
med.fit <- glm(DiningandDrinkingScore ~ WalkScore, family = gaussian(link = "identity"), data = ibiccs_cc) 
summary(med.fit)
```

```
## 
## Call:
## glm(formula = DiningandDrinkingScore ~ WalkScore, family = gaussian(link = "identity"), 
##     data = ibiccs_cc)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -46.43   -2.30   -0.15    2.20   51.14  
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept)  4.69628    0.13849    33.9   <2e-16 ***
## WalkScore    0.96181    0.00169   569.2   <2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for gaussian family taken to be 36.66)
## 
##     Null deviance: 12643236  on 20921  degrees of freedom
## Residual deviance:   766854  on 20920  degrees of freedom
## AIC: 134731
## 
## Number of Fisher Scoring iterations: 2
```

```r
out.fit <- glm(bmi ~ WalkScore * DiningandDrinkingScore, family = gaussian(link = "identity"), data = ibiccs_cc)
summary(out.fit)
```

```
## 
## Call:
## glm(formula = bmi ~ WalkScore * DiningandDrinkingScore, family = gaussian(link = "identity"), 
##     data = ibiccs_cc)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -9.052  -3.437  -0.773   2.539  15.392  
## 
## Coefficients:
##                                    Estimate Std. Error t value Pr(>|t|)
## (Intercept)                      25.9238288  0.1673918  154.87  < 2e-16
## WalkScore                         0.0407126  0.0064922    6.27  3.7e-10
## DiningandDrinkingScore           -0.0001460  0.0056775   -0.03     0.98
## WalkScore:DiningandDrinkingScore -0.0005065  0.0000475  -10.66  < 2e-16
##                                     
## (Intercept)                      ***
## WalkScore                        ***
## DiningandDrinkingScore              
## WalkScore:DiningandDrinkingScore ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for gaussian family taken to be 21.77)
## 
##     Null deviance: 463192  on 20921  degrees of freedom
## Residual deviance: 455398  on 20918  degrees of freedom
## AIC: 123832
## 
## Number of Fisher Scoring iterations: 2
```

```r
med.out <- mediate(med.fit, out.fit, treat = "WalkScore", mediator = "DiningandDrinkingScore", sims = 100) 
summary(med.out)
```

```
## 
## Causal Mediation Analysis 
## 
## Quasi-Bayesian Confidence Intervals
## 
##                            Estimate 95% CI Lower 95% CI Upper p-value    
## ACME (control)            0.0000362   -0.0106657         0.01    0.96    
## ACME (treated)           -0.0004473   -0.0111299         0.01    0.98    
## ADE (control)             0.0377034    0.0233393         0.05  <2e-16 ***
## ADE (treated)             0.0372199    0.0228660         0.05  <2e-16 ***
## Total Effect              0.0372562    0.0262919         0.05  <2e-16 ***
## Prop. Mediated (control)  0.0070137   -0.3078577         0.27    0.96    
## Prop. Mediated (treated) -0.0050439   -0.3213533         0.26    0.98    
## ACME (average)           -0.0002055   -0.0108978         0.01    1.00    
## ADE (average)             0.0374617    0.0231027         0.05  <2e-16 ***
## Prop. Mediated (average)  0.0009849   -0.3146055         0.26    1.00    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Sample Size Used: 20922 
## 
## 
## Simulations: 100
```
Interpretation: 
The direct and total effects are all significantly different from zero; the estimated mediation is not significantly different from zero. 
Total: 1-unit change in WalkScore results in a .03 increase in BMI when DiningandDrinkingScore is included.
ADE: 1-unit change in WalkScore results in a .03 increase in BMI when DiningandDrinkingScore is fixed.
ACME: 1-unit change in DiningandDrinkingScore results in .0005 decrease in BMI when WalkScore is fixed.

## GroceryScore and covariates
# Step 1: Add Ville

```r
med.fit <- glm(GroceryScore ~ WalkScore + ville, family = gaussian(link = "identity"), data = ibiccs_cc) 
summary(med.fit)
```

```
## 
## Call:
## glm(formula = GroceryScore ~ WalkScore + ville, family = gaussian(link = "identity"), 
##     data = ibiccs_cc)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -66.63   -4.29   -0.22    5.81   62.48  
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(>|t|)    
## (Intercept)       -5.57038    0.53603  -10.39  < 2e-16 ***
## WalkScore          1.09550    0.00504  217.25  < 2e-16 ***
## villeChicago      -4.31607    0.38232  -11.29  < 2e-16 ***
## villeDétroit       4.91672    0.47839   10.28  < 2e-16 ***
## villeMontréal      5.22248    0.41431   12.61  < 2e-16 ***
## villeNew-York     -1.67018    0.38958   -4.29 0.000018 ***
## villePhiladelphie  1.30309    0.47952    2.72  0.00658 ** 
## villeToronto       1.31751    0.38025    3.46  0.00053 ***
## villeVancouver     3.54348    0.41848    8.47  < 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for gaussian family taken to be 171.3)
## 
##     Null deviance: 17875112  on 20921  degrees of freedom
## Residual deviance:  3582216  on 20913  degrees of freedom
## AIC: 166995
## 
## Number of Fisher Scoring iterations: 2
```

```r
out.fit <- glm(bmi ~ WalkScore * GroceryScore + ville, family = gaussian(link = "identity"), data = ibiccs_cc)
summary(out.fit)
```

```
## 
## Call:
## glm(formula = bmi ~ WalkScore * GroceryScore + ville, family = gaussian(link = "identity"), 
##     data = ibiccs_cc)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -10.155   -3.442   -0.779    2.583   15.771  
## 
## Coefficients:
##                         Estimate Std. Error t value Pr(>|t|)    
## (Intercept)            25.728065   0.221774  116.01  < 2e-16 ***
## WalkScore              -0.016698   0.004445   -3.76  0.00017 ***
## GroceryScore            0.029923   0.003538    8.46  < 2e-16 ***
## villeChicago            0.779662   0.137599    5.67  1.5e-08 ***
## villeDétroit            0.952920   0.170665    5.58  2.4e-08 ***
## villeMontréal           0.654044   0.148276    4.41  1.0e-05 ***
## villeNew-York           0.255598   0.139826    1.83  0.06757 .  
## villePhiladelphie       0.998939   0.170671    5.85  4.9e-09 ***
## villeToronto            0.394863   0.135879    2.91  0.00366 ** 
## villeVancouver         -0.364522   0.149635   -2.44  0.01486 *  
## WalkScore:GroceryScore -0.000240   0.000047   -5.10  3.4e-07 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for gaussian family taken to be 21.68)
## 
##     Null deviance: 463192  on 20921  degrees of freedom
## Residual deviance: 453408  on 20911  degrees of freedom
## AIC: 123754
## 
## Number of Fisher Scoring iterations: 2
```

```r
med.out <- mediate(med.fit, out.fit, treat = "WalkScore", mediator = "GroceryScore", sims = 100) 
summary(med.out)
```

```
## 
## Causal Mediation Analysis 
## 
## Quasi-Bayesian Confidence Intervals
## 
##                          Estimate 95% CI Lower 95% CI Upper p-value    
## ACME (control)            0.03312      0.02609         0.04  <2e-16 ***
## ACME (treated)            0.03286      0.02592         0.04  <2e-16 ***
## ADE (control)            -0.01617     -0.02438        -0.01  <2e-16 ***
## ADE (treated)            -0.01643     -0.02461        -0.01  <2e-16 ***
## Total Effect              0.01669      0.00595         0.03  <2e-16 ***
## Prop. Mediated (control)  1.99972      1.21123         4.51  <2e-16 ***
## Prop. Mediated (treated)  1.98429      1.19861         4.49  <2e-16 ***
## ACME (average)            0.03299      0.02601         0.04  <2e-16 ***
## ADE (average)            -0.01630     -0.02450        -0.01  <2e-16 ***
## Prop. Mediated (average)  1.99201      1.20492         4.50  <2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Sample Size Used: 20922 
## 
## 
## Simulations: 100
```
Interpretation:
The estimated mediation, direct, and total effects are all significantly different from zero. The results suggest that the WalkScore increases the value of the individual-level mediator (GroceryScore), which in turn decreases the value of the outcome (bmi).

# Step 2: Add all covariates *Focus*

```r
med.fit <- glm(GroceryScore ~ WalkScore + language + ville + gender + health + physically_active + q42 + marital_status + country_born + motor_vehicle_access + occupation_status + day_per_week_motor_vehicle + day_per_week_public_transit + day_per_week_walking + day_per_week_bike + children_household + common_transportation + ethnicity, family = gaussian(link = "identity"), data = ibiccs_cc) 
summary(med.fit)
```

```
## 
## Call:
## glm(formula = GroceryScore ~ WalkScore + language + ville + gender + 
##     health + physically_active + q42 + marital_status + country_born + 
##     motor_vehicle_access + occupation_status + day_per_week_motor_vehicle + 
##     day_per_week_public_transit + day_per_week_walking + day_per_week_bike + 
##     children_household + common_transportation + ethnicity, family = gaussian(link = "identity"), 
##     data = ibiccs_cc)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -62.33   -4.17   -0.01    5.76   64.89  
## 
## Coefficients:
##                                            Estimate Std. Error t value
## (Intercept)                                -2.03002    1.42877   -1.42
## WalkScore                                   1.10793    0.00711  155.89
## languageFren/Span                           0.55744    0.71723    0.78
## villeChicago                               -5.15981    0.48284  -10.69
## villeDétroit                                4.19422    0.62766    6.68
## villeMontréal                               3.99218    0.85507    4.67
## villeNew-York                              -1.31381    0.50738   -2.59
## villePhiladelphie                           0.76074    0.61098    1.25
## villeToronto                                0.54853    0.69738    0.79
## villeVancouver                              2.22246    0.73133    3.04
## genderMale                                  0.03350    0.24584    0.14
## healthGood                                  0.82092    0.27498    2.99
## healthPoor                                  1.41822    0.45892    3.09
## physically_activeYes                       -0.74650    0.34821   -2.14
## q42                                         0.00186    0.01123    0.17
## marital_statusSingle                        0.29703    0.28060    1.06
## country_bornOther                          -0.81229    0.45828   -1.77
## country_bornUnited States                  -1.15396    0.59421   -1.94
## motor_vehicle_accessYes                     0.53106    0.34552    1.54
## occupation_statusStudent                    1.13479    0.48553    2.34
## occupation_statusUnemployed                 0.33891    0.36206    0.94
## day_per_week_motor_vehicle                  0.17869    0.06879    2.60
## day_per_week_public_transit                 0.04173    0.07819    0.53
## day_per_week_walking                       -0.17126    0.05966   -2.87
## day_per_week_bike                           0.12799    0.09210    1.39
## children_household                          0.58319    0.17333    3.36
## common_transportationCar                   -0.29894    0.67466   -0.44
## common_transportationOther                 -0.19673    1.48792   -0.13
## common_transportationPublic Transportation -0.64337    0.66191   -0.97
## common_transportationWalking               -0.91906    0.65360   -1.41
## ethnicityAsian                             -3.69001    0.65500   -5.63
## ethnicityCauscasian                        -4.10261    0.54792   -7.49
## ethnicityHispanic                          -2.07471    0.83683   -2.48
## ethnicityNative American                   -0.76673    2.25403   -0.34
## ethnicityOther                             -4.23830    0.87868   -4.82
## ethnicityRefuse                            -1.21942    1.11101   -1.10
##                                            Pr(>|t|)    
## (Intercept)                                 0.15539    
## WalkScore                                   < 2e-16 ***
## languageFren/Span                           0.43705    
## villeChicago                                < 2e-16 ***
## villeDétroit                                2.5e-11 ***
## villeMontréal                               3.1e-06 ***
## villeNew-York                               0.00963 ** 
## villePhiladelphie                           0.21312    
## villeToronto                                0.43156    
## villeVancouver                              0.00238 ** 
## genderMale                                  0.89162    
## healthGood                                  0.00284 ** 
## healthPoor                                  0.00200 ** 
## physically_activeYes                        0.03207 *  
## q42                                         0.86831    
## marital_statusSingle                        0.28983    
## country_bornOther                           0.07634 .  
## country_bornUnited States                   0.05216 .  
## motor_vehicle_accessYes                     0.12432    
## occupation_statusStudent                    0.01944 *  
## occupation_statusUnemployed                 0.34927    
## day_per_week_motor_vehicle                  0.00940 ** 
## day_per_week_public_transit                 0.59353    
## day_per_week_walking                        0.00410 ** 
## day_per_week_bike                           0.16465    
## children_household                          0.00077 ***
## common_transportationCar                    0.65771    
## common_transportationOther                  0.89481    
## common_transportationPublic Transportation  0.33107    
## common_transportationWalking                0.15970    
## ethnicityAsian                              1.8e-08 ***
## ethnicityCauscasian                         7.5e-14 ***
## ethnicityHispanic                           0.01318 *  
## ethnicityNative American                    0.73374    
## ethnicityOther                              1.4e-06 ***
## ethnicityRefuse                             0.27241    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for gaussian family taken to be 171.7)
## 
##     Null deviance: 10553218  on 12352  degrees of freedom
## Residual deviance:  2114931  on 12317  degrees of freedom
##   (8569 observations deleted due to missingness)
## AIC: 98660
## 
## Number of Fisher Scoring iterations: 2
```

```r
out.fit <- glm(bmi ~ WalkScore * GroceryScore + language + ville + gender + health + physically_active + q42 + marital_status + country_born + motor_vehicle_access + occupation_status + day_per_week_motor_vehicle + day_per_week_public_transit + day_per_week_walking + day_per_week_bike + children_household + common_transportation + ethnicity, family = gaussian(link = "identity"), data = ibiccs_cc)
summary(out.fit)
```

```
## 
## Call:
## glm(formula = bmi ~ WalkScore * GroceryScore + language + ville + 
##     gender + health + physically_active + q42 + marital_status + 
##     country_born + motor_vehicle_access + occupation_status + 
##     day_per_week_motor_vehicle + day_per_week_public_transit + 
##     day_per_week_walking + day_per_week_bike + children_household + 
##     common_transportation + ethnicity, family = gaussian(link = "identity"), 
##     data = ibiccs_cc)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -12.050   -2.907   -0.598    2.128   17.164  
## 
## Coefficients:
##                                              Estimate Std. Error t value
## (Intercept)                                23.7014010  0.4722753   50.19
## WalkScore                                  -0.0089355  0.0051586   -1.73
## GroceryScore                                0.0186845  0.0042777    4.37
## languageFren/Span                           0.4997373  0.2295304    2.18
## villeChicago                                0.3008269  0.1563787    1.92
## villeDétroit                                0.1616229  0.2013245    0.80
## villeMontréal                              -0.8404109  0.2741165   -3.07
## villeNew-York                              -0.0821525  0.1635287   -0.50
## villePhiladelphie                           0.4235445  0.1956257    2.17
## villeToronto                               -0.4426920  0.2236574   -1.98
## villeVancouver                             -1.0466666  0.2345374   -4.46
## genderMale                                  1.3016716  0.0786867   16.54
## healthGood                                  1.9658709  0.0880259   22.33
## healthPoor                                  3.5034526  0.1469201   23.85
## physically_activeYes                       -0.3961783  0.1114478   -3.55
## q42                                         0.0572190  0.0035952   15.92
## marital_statusSingle                        0.1965702  0.0897998    2.19
## country_bornOther                          -0.6899208  0.1466688   -4.70
## country_bornUnited States                  -0.2206400  0.1901822   -1.16
## motor_vehicle_accessYes                    -0.2031473  0.1106970   -1.84
## occupation_statusStudent                   -0.2885116  0.1555537   -1.85
## occupation_statusUnemployed                -0.2581995  0.1158861   -2.23
## day_per_week_motor_vehicle                  0.0607042  0.0220397    2.75
## day_per_week_public_transit                -0.0302653  0.0250231   -1.21
## day_per_week_walking                       -0.0633244  0.0191029   -3.31
## day_per_week_bike                          -0.0399483  0.0294770   -1.36
## children_household                          0.3329178  0.0555003    6.00
## common_transportationCar                    0.5700112  0.2159776    2.64
## common_transportationOther                  0.3069059  0.4761473    0.64
## common_transportationPublic Transportation  0.5515890  0.2118247    2.60
## common_transportationWalking                0.1391526  0.2092416    0.67
## ethnicityAsian                             -2.9094744  0.2100395  -13.85
## ethnicityCauscasian                        -1.4943579  0.1759584   -8.49
## ethnicityHispanic                          -0.6674209  0.2679987   -2.49
## ethnicityNative American                   -1.4944120  0.7215322   -2.07
## ethnicityOther                             -1.5491625  0.2815478   -5.50
## ethnicityRefuse                            -2.1146515  0.3556605   -5.95
## WalkScore:GroceryScore                     -0.0001168  0.0000559   -2.09
##                                            Pr(>|t|)    
## (Intercept)                                 < 2e-16 ***
## WalkScore                                   0.08327 .  
## GroceryScore                                1.3e-05 ***
## languageFren/Span                           0.02948 *  
## villeChicago                                0.05441 .  
## villeDétroit                                0.42211    
## villeMontréal                               0.00217 ** 
## villeNew-York                               0.61541    
## villePhiladelphie                           0.03040 *  
## villeToronto                                0.04780 *  
## villeVancouver                              8.2e-06 ***
## genderMale                                  < 2e-16 ***
## healthGood                                  < 2e-16 ***
## healthPoor                                  < 2e-16 ***
## physically_activeYes                        0.00038 ***
## q42                                         < 2e-16 ***
## marital_statusSingle                        0.02862 *  
## country_bornOther                           2.6e-06 ***
## country_bornUnited States                   0.24601    
## motor_vehicle_accessYes                     0.06651 .  
## occupation_statusStudent                    0.06366 .  
## occupation_statusUnemployed                 0.02590 *  
## day_per_week_motor_vehicle                  0.00589 ** 
## day_per_week_public_transit                 0.22650    
## day_per_week_walking                        0.00092 ***
## day_per_week_bike                           0.17537    
## children_household                          2.0e-09 ***
## common_transportationCar                    0.00832 ** 
## common_transportationOther                  0.51922    
## common_transportationPublic Transportation  0.00923 ** 
## common_transportationWalking                0.50604    
## ethnicityAsian                              < 2e-16 ***
## ethnicityCauscasian                         < 2e-16 ***
## ethnicityHispanic                           0.01277 *  
## ethnicityNative American                    0.03836 *  
## ethnicityOther                              3.8e-08 ***
## ethnicityRefuse                             2.8e-09 ***
## WalkScore:GroceryScore                      0.03682 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for gaussian family taken to be 17.58)
## 
##     Null deviance: 263336  on 12352  degrees of freedom
## Residual deviance: 216533  on 12315  degrees of freedom
##   (8569 observations deleted due to missingness)
## AIC: 70511
## 
## Number of Fisher Scoring iterations: 2
```

```r
med.out <- mediate(med.fit, out.fit, treat = "WalkScore", mediator = "GroceryScore", sims = 100) 
summary(med.out)
```

```
## 
## Causal Mediation Analysis 
## 
## Quasi-Bayesian Confidence Intervals
## 
##                           Estimate 95% CI Lower 95% CI Upper p-value    
## ACME (control)             0.02126      0.01181         0.03  <2e-16 ***
## ACME (treated)             0.02113      0.01181         0.03  <2e-16 ***
## ADE (control)             -0.00889     -0.01987         0.00    0.10 .  
## ADE (treated)             -0.00902     -0.01989         0.00    0.08 .  
## Total Effect               0.01224     -0.00321         0.03    0.18    
## Prop. Mediated (control)   1.49492    -41.54352         6.76    0.18    
## Prop. Mediated (treated)   1.48514    -41.48822         6.74    0.18    
## ACME (average)             0.02120      0.01181         0.03  <2e-16 ***
## ADE (average)             -0.00895     -0.01988         0.00    0.08 .  
## Prop. Mediated (average)   1.49003    -41.51587         6.75    0.18    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Sample Size Used: 12353 
## 
## 
## Simulations: 100
```
Interpretation:
The estimated mediation is significantly different from zero; direct and total effects are not significantly different from zero. 
Total: 1-unit change in WalkScore results in a .01 increase in BMI when GroceryScore is included.
ADE: 1-unit change in WalkScore results in a .007 decrease in BMI when GroceryScore is fixed.
ACME: 1-unit change in GroceryScore results in .02 increase in BMI when WalkScore is fixed.

## DiningandDrinkingScore and covariates
# Step 1: Add ville

```r
med.fit <- glm(DiningandDrinkingScore ~ WalkScore + ville, family = gaussian(link = "identity"), data = ibiccs_cc) 
summary(med.fit)
```

```
## 
## Call:
## glm(formula = DiningandDrinkingScore ~ WalkScore + ville, family = gaussian(link = "identity"), 
##     data = ibiccs_cc)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -44.46   -2.37   -0.19    2.00   50.33  
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(>|t|)    
## (Intercept)         0.6559     0.2445    2.68   0.0073 ** 
## WalkScore           0.9923     0.0023  431.44  < 2e-16 ***
## villeChicago        2.1273     0.1744   12.20  < 2e-16 ***
## villeDétroit        4.1512     0.2182   19.02  < 2e-16 ***
## villeMontréal       0.3564     0.1890    1.89   0.0593 .  
## villeNew-York       0.2733     0.1777    1.54   0.1241    
## villePhiladelphie   1.4362     0.2187    6.57  5.3e-11 ***
## villeToronto        1.9659     0.1734   11.33  < 2e-16 ***
## villeVancouver      2.3018     0.1909   12.06  < 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for gaussian family taken to be 35.64)
## 
##     Null deviance: 12643236  on 20921  degrees of freedom
## Residual deviance:   745257  on 20913  degrees of freedom
## AIC: 134147
## 
## Number of Fisher Scoring iterations: 2
```

```r
out.fit <- glm(bmi ~ WalkScore * DiningandDrinkingScore + ville, family = gaussian(link = "identity"), data = ibiccs_cc)
summary(out.fit)
```

```
## 
## Call:
## glm(formula = bmi ~ WalkScore * DiningandDrinkingScore + ville, 
##     family = gaussian(link = "identity"), data = ibiccs_cc)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -9.558  -3.425  -0.771   2.573  15.880  
## 
## Coefficients:
##                                    Estimate Std. Error t value Pr(>|t|)
## (Intercept)                      24.7452826  0.2339955  105.75  < 2e-16
## WalkScore                         0.0543298  0.0068930    7.88  3.4e-15
## DiningandDrinkingScore           -0.0020183  0.0057871   -0.35   0.7273
## villeChicago                      0.7720803  0.1364849    5.66  1.6e-08
## villeDétroit                      1.2535914  0.1718178    7.30  3.1e-13
## villeMontréal                     0.6853776  0.1475665    4.64  3.4e-06
## villeNew-York                     0.3821078  0.1401397    2.73   0.0064
## villePhiladelphie                 1.0813946  0.1705564    6.34  2.3e-10
## villeToronto                      0.4407398  0.1357307    3.25   0.0012
## villeVancouver                   -0.2699241  0.1493740   -1.81   0.0708
## WalkScore:DiningandDrinkingScore -0.0005474  0.0000503  -10.87  < 2e-16
##                                     
## (Intercept)                      ***
## WalkScore                        ***
## DiningandDrinkingScore              
## villeChicago                     ***
## villeDétroit                     ***
## villeMontréal                    ***
## villeNew-York                    ** 
## villePhiladelphie                ***
## villeToronto                     ** 
## villeVancouver                   .  
## WalkScore:DiningandDrinkingScore ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for gaussian family taken to be 21.61)
## 
##     Null deviance: 463192  on 20921  degrees of freedom
## Residual deviance: 451978  on 20911  degrees of freedom
## AIC: 123688
## 
## Number of Fisher Scoring iterations: 2
```

```r
med.out <- mediate(med.fit, out.fit, treat = "WalkScore", mediator = "DiningandDrinkingScore", sims = 100) 
summary(med.out)
```

```
## 
## Causal Mediation Analysis 
## 
## Quasi-Bayesian Confidence Intervals
## 
##                          Estimate 95% CI Lower 95% CI Upper p-value    
## ACME (control)           -0.00195     -0.01250         0.01    0.74    
## ACME (treated)           -0.00249     -0.01302         0.01    0.66    
## ADE (control)             0.05310      0.03985         0.06  <2e-16 ***
## ADE (treated)             0.05256      0.03942         0.06  <2e-16 ***
## Total Effect              0.05061      0.03793         0.06  <2e-16 ***
## Prop. Mediated (control) -0.04108     -0.30904         0.14    0.74    
## Prop. Mediated (treated) -0.05139     -0.32020         0.13    0.66    
## ACME (average)           -0.00222     -0.01276         0.01    0.68    
## ADE (average)             0.05283      0.03963         0.06  <2e-16 ***
## Prop. Mediated (average) -0.04623     -0.31462         0.14    0.68    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Sample Size Used: 20922 
## 
## 
## Simulations: 100
```
Interpretation:
Direct effects are significantly different from zero; estimated mediation and total effects are not significantly different from zero. 

# Step 2: Add all covariates *Focus*

```r
med.fit <- glm(DiningandDrinkingScore ~ WalkScore + language + ville + gender + health + physically_active + q42 + marital_status + country_born + motor_vehicle_access + occupation_status + day_per_week_motor_vehicle + day_per_week_public_transit + day_per_week_walking + day_per_week_bike + children_household + common_transportation + ethnicity, family = gaussian(link = "identity"), data = ibiccs_cc) 
summary(med.fit)
```

```
## 
## Call:
## glm(formula = DiningandDrinkingScore ~ WalkScore + language + 
##     ville + gender + health + physically_active + q42 + marital_status + 
##     country_born + motor_vehicle_access + occupation_status + 
##     day_per_week_motor_vehicle + day_per_week_public_transit + 
##     day_per_week_walking + day_per_week_bike + children_household + 
##     common_transportation + ethnicity, family = gaussian(link = "identity"), 
##     data = ibiccs_cc)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -43.51   -2.21   -0.29    1.95   49.71  
## 
## Coefficients:
##                                            Estimate Std. Error t value
## (Intercept)                                -0.59257    0.63507   -0.93
## WalkScore                                   0.99214    0.00316  314.07
## languageFren/Span                          -0.19814    0.31880   -0.62
## villeChicago                                2.38508    0.21462   11.11
## villeDétroit                                4.47795    0.27899   16.05
## villeMontréal                               0.79342    0.38007    2.09
## villeNew-York                               0.18127    0.22552    0.80
## villePhiladelphie                           1.49031    0.27158    5.49
## villeToronto                                2.22087    0.30998    7.16
## villeVancouver                              2.33410    0.32507    7.18
## genderMale                                 -0.03986    0.10927   -0.36
## healthGood                                 -0.10140    0.12223   -0.83
## healthPoor                                  0.26929    0.20399    1.32
## physically_activeYes                        0.02262    0.15478    0.15
## q42                                        -0.02545    0.00499   -5.10
## marital_statusSingle                       -0.20888    0.12473   -1.67
## country_bornOther                           0.51788    0.20370    2.54
## country_bornUnited States                   0.34034    0.26412    1.29
## motor_vehicle_accessYes                    -0.13627    0.15358   -0.89
## occupation_statusStudent                   -0.04051    0.21582   -0.19
## occupation_statusUnemployed                 0.05246    0.16093    0.33
## day_per_week_motor_vehicle                 -0.02989    0.03058   -0.98
## day_per_week_public_transit                -0.02287    0.03475   -0.66
## day_per_week_walking                       -0.00830    0.02652   -0.31
## day_per_week_bike                          -0.00723    0.04094   -0.18
## children_household                         -0.27496    0.07705   -3.57
## common_transportationCar                   -0.00220    0.29988   -0.01
## common_transportationOther                 -0.16518    0.66137   -0.25
## common_transportationPublic Transportation  0.35596    0.29421    1.21
## common_transportationWalking                0.01024    0.29052    0.04
## ethnicityAsian                              2.68180    0.29114    9.21
## ethnicityCauscasian                         2.41489    0.24355    9.92
## ethnicityHispanic                           1.91639    0.37196    5.15
## ethnicityNative American                    3.46360    1.00190    3.46
## ethnicityOther                              2.69634    0.39057    6.90
## ethnicityRefuse                             1.62803    0.49383    3.30
##                                            Pr(>|t|)    
## (Intercept)                                 0.35080    
## WalkScore                                   < 2e-16 ***
## languageFren/Span                           0.53427    
## villeChicago                                < 2e-16 ***
## villeDétroit                                < 2e-16 ***
## villeMontréal                               0.03686 *  
## villeNew-York                               0.42153    
## villePhiladelphie                           4.2e-08 ***
## villeToronto                                8.2e-13 ***
## villeVancouver                              7.4e-13 ***
## genderMale                                  0.71528    
## healthGood                                  0.40676    
## healthPoor                                  0.18681    
## physically_activeYes                        0.88380    
## q42                                         3.5e-07 ***
## marital_statusSingle                        0.09402 .  
## country_bornOther                           0.01102 *  
## country_bornUnited States                   0.19757    
## motor_vehicle_accessYes                     0.37495    
## occupation_statusStudent                    0.85111    
## occupation_statusUnemployed                 0.74445    
## day_per_week_motor_vehicle                  0.32829    
## day_per_week_public_transit                 0.51044    
## day_per_week_walking                        0.75420    
## day_per_week_bike                           0.85990    
## children_household                          0.00036 ***
## common_transportationCar                    0.99414    
## common_transportationOther                  0.80278    
## common_transportationPublic Transportation  0.22635    
## common_transportationWalking                0.97187    
## ethnicityAsian                              < 2e-16 ***
## ethnicityCauscasian                         < 2e-16 ***
## ethnicityHispanic                           2.6e-07 ***
## ethnicityNative American                    0.00055 ***
## ethnicityOther                              5.3e-12 ***
## ethnicityRefuse                             0.00098 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for gaussian family taken to be 33.92)
## 
##     Null deviance: 7490659  on 12352  degrees of freedom
## Residual deviance:  417852  on 12317  degrees of freedom
##   (8569 observations deleted due to missingness)
## AIC: 78628
## 
## Number of Fisher Scoring iterations: 2
```

```r
out.fit <- glm(bmi ~ WalkScore * DiningandDrinkingScore + language + ville + gender + health + physically_active + q42 + marital_status + country_born + motor_vehicle_access + occupation_status + bmi_category + TransitScore + BikeScore + day_per_week_motor_vehicle + day_per_week_public_transit + day_per_week_walking + day_per_week_bike + children_household + common_transportation + ethnicity, family = gaussian(link = "identity"), data = ibiccs_cc)
summary(out.fit)
```

```
## 
## Call:
## glm(formula = bmi ~ WalkScore * DiningandDrinkingScore + language + 
##     ville + gender + health + physically_active + q42 + marital_status + 
##     country_born + motor_vehicle_access + occupation_status + 
##     bmi_category + TransitScore + BikeScore + day_per_week_motor_vehicle + 
##     day_per_week_public_transit + day_per_week_walking + day_per_week_bike + 
##     children_household + common_transportation + ethnicity, family = gaussian(link = "identity"), 
##     data = ibiccs_cc)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -4.525  -1.341  -0.077   1.317   7.202  
## 
## Coefficients:
##                                              Estimate Std. Error t value
## (Intercept)                                22.0874986  0.2319876   95.21
## WalkScore                                   0.0073491  0.0036378    2.02
## DiningandDrinkingScore                     -0.0039494  0.0030092   -1.31
## languageFren/Span                          -0.1385817  0.0993044   -1.40
## villeChicago                                0.0303475  0.0680490    0.45
## villeDétroit                                0.0390257  0.0891948    0.44
## villeMontréal                              -0.0203916  0.1321054   -0.15
## villeNew-York                              -0.1155078  0.0718352   -1.61
## villePhiladelphie                          -0.0491675  0.0847061   -0.58
## villeToronto                               -0.0298762  0.1026006   -0.29
## villeVancouver                             -0.1840529  0.1056505   -1.74
## genderMale                                  0.2763704  0.0346604    7.97
## healthGood                                  0.2860408  0.0387491    7.38
## healthPoor                                  0.5213155  0.0649068    8.03
## physically_activeYes                       -0.0413152  0.0481945   -0.86
## q42                                         0.0102195  0.0015727    6.50
## marital_statusSingle                        0.0143514  0.0388478    0.37
## country_bornOther                          -0.1144856  0.0634827   -1.80
## country_bornUnited States                  -0.0284272  0.0822057   -0.35
## motor_vehicle_accessYes                    -0.0301156  0.0478939   -0.63
## occupation_statusStudent                    0.0080754  0.0672603    0.12
## occupation_statusUnemployed                -0.0747761  0.0501173   -1.49
## bmi_categoryobese                          11.0897100  0.0500149  221.73
## bmi_categoryoverweight                      4.6573468  0.0390409  119.29
## bmi_categoryunderweight                    -3.9688867  0.1253113  -31.67
## TransitScore                                0.0001943  0.0009129    0.21
## BikeScore                                  -0.0006358  0.0005807   -1.09
## day_per_week_motor_vehicle                  0.0033667  0.0095358    0.35
## day_per_week_public_transit                -0.0062442  0.0108216   -0.58
## day_per_week_walking                       -0.0131599  0.0082651   -1.59
## day_per_week_bike                          -0.0029939  0.0127464   -0.23
## children_household                          0.0753652  0.0240329    3.14
## common_transportationCar                    0.1875747  0.0933905    2.01
## common_transportationOther                  0.4317444  0.2058233    2.10
## common_transportationPublic Transportation  0.2130893  0.0915696    2.33
## common_transportationWalking                0.0656506  0.0905210    0.73
## ethnicityAsian                             -0.7243711  0.0918342   -7.89
## ethnicityCauscasian                        -0.3837383  0.0768413   -4.99
## ethnicityHispanic                          -0.2537331  0.1161155   -2.19
## ethnicityNative American                   -0.5222965  0.3122557   -1.67
## ethnicityOther                             -0.3535378  0.1221774   -2.89
## ethnicityRefuse                            -0.6652094  0.1540522   -4.32
## WalkScore:DiningandDrinkingScore           -0.0000370  0.0000272   -1.36
##                                            Pr(>|t|)    
## (Intercept)                                 < 2e-16 ***
## WalkScore                                    0.0434 *  
## DiningandDrinkingScore                       0.1894    
## languageFren/Span                            0.1629    
## villeChicago                                 0.6556    
## villeDétroit                                 0.6617    
## villeMontréal                                0.8773    
## villeNew-York                                0.1079    
## villePhiladelphie                            0.5616    
## villeToronto                                 0.7709    
## villeVancouver                               0.0815 .  
## genderMale                                  1.7e-15 ***
## healthGood                                  1.7e-13 ***
## healthPoor                                  1.0e-15 ***
## physically_activeYes                         0.3913    
## q42                                         8.5e-11 ***
## marital_statusSingle                         0.7118    
## country_bornOther                            0.0713 .  
## country_bornUnited States                    0.7295    
## motor_vehicle_accessYes                      0.5295    
## occupation_statusStudent                     0.9044    
## occupation_statusUnemployed                  0.1357    
## bmi_categoryobese                           < 2e-16 ***
## bmi_categoryoverweight                      < 2e-16 ***
## bmi_categoryunderweight                     < 2e-16 ***
## TransitScore                                 0.8314    
## BikeScore                                    0.2736    
## day_per_week_motor_vehicle                   0.7241    
## day_per_week_public_transit                  0.5639    
## day_per_week_walking                         0.1114    
## day_per_week_bike                            0.8143    
## children_household                           0.0017 ** 
## common_transportationCar                     0.0446 *  
## common_transportationOther                   0.0360 *  
## common_transportationPublic Transportation   0.0200 *  
## common_transportationWalking                 0.4683    
## ethnicityAsian                              3.3e-15 ***
## ethnicityCauscasian                         6.0e-07 ***
## ethnicityHispanic                            0.0289 *  
## ethnicityNative American                     0.0944 .  
## ethnicityOther                               0.0038 ** 
## ethnicityRefuse                             1.6e-05 ***
## WalkScore:DiningandDrinkingScore             0.1736    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for gaussian family taken to be 3.285)
## 
##     Null deviance: 263336  on 12352  degrees of freedom
## Residual deviance:  40436  on 12310  degrees of freedom
##   (8569 observations deleted due to missingness)
## AIC: 49793
## 
## Number of Fisher Scoring iterations: 2
```

```r
med.out <- mediate(med.fit, out.fit, treat = "WalkScore", mediator = "DiningandDrinkingScore", sims = 100) 
summary(med.out)
```

```
## 
## Causal Mediation Analysis 
## 
## Quasi-Bayesian Confidence Intervals
## 
##                           Estimate 95% CI Lower 95% CI Upper p-value  
## ACME (control)            -0.00366     -0.00922         0.00    0.32  
## ACME (treated)            -0.00370     -0.00922         0.00    0.30  
## ADE (control)              0.00736      0.00117         0.01    0.02 *
## ADE (treated)              0.00732      0.00115         0.01    0.02 *
## Total Effect               0.00366     -0.00362         0.01    0.26  
## Prop. Mediated (control)  -0.65933    -17.73563         9.51    0.58  
## Prop. Mediated (treated)  -0.66970    -17.79063         9.51    0.56  
## ACME (average)            -0.00368     -0.00922         0.00    0.30  
## ADE (average)              0.00734      0.00116         0.01    0.02 *
## Prop. Mediated (average)  -0.66452    -17.76313         9.51    0.56  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Sample Size Used: 12353 
## 
## 
## Simulations: 100
```
Interpretation:
The estimated mediation, direct and total effects are not signficantly different from zero.
Total: 1-unit change in WalkScore results in a .003 increase in BMI when DiningandDrinkingScore is included.
ADE: 1-unit change in WalkScore results in a .007 increase in BMI when DiningandDrinkingScore is fixed.
ACME: 1-unit change in DiningandDrinkingScore results in .004 decrease in BMI when WalkScore is fixed.

### List of next steps
- Add in the city level model with glmer and interpretation
- Income stratified model
    - Rerun the model for categories of income
    - Create a new dataframe with only one level of income
    

```
# Area-Level Analysis
med.fit <- lm(smorale ~ free + #area-covariates, data = school)

out.fit <- lmer(late ~ free + smorale + #area-covariates + #covariates + (1 | SCH_ID), data = student)
  
med.out <- mediate(med.fit, out.fit, treat = "free", mediator = "smorale", 
  + control.value = 3, treat.value = 4, sims = 100) 
summary(med.out)
```
